{"version":3,"mappings":"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B,wpBCHA,CACY,IAAAD,qBAAY,SAAS,EACrBC,uBAAc,KAAK,8BAIvBD,EAAS,wBAGFC,EAAW,WAN1B,oeCHA,CACY,IAAAD,qBAAY,SAAS,EACrBC,uBAAc,KAAK,8BAIvBD,EAAS,wBAGFC,EAAW,WAN1B,26CCHA,CACY,IAAAD,qBAAY,SAAS,EACrBC,uBAAc,KAAK,8BAIvBD,EAAS,wBAGFC,EAAW,WAN1B,i7ECHA,6HA+BO5C,EAAOC,GAAW,MAAM,EAEnB,IAAAC,iBAAO,EAAK,QAcjBowB,EAA0B,EAE9B,GAAI,UACJ,MAAO,UACP,SAAQ,CACP,iBACA,qBACA,kBACA,sBACA,gBACA,oBACA,qBACA,kBACA,mBACA,UACA,YACA,aACA,YACA,gBACA,cACA,eACA,mBACA,oBACA,eACA,gBACA,iBACA,kBACA,QACA,YACA,gBACA,oBAID,GAAI,YACJ,MAAO,YACP,SAAQ,CACP,sBACA,mCACA,oBACA,+BACA,6BACA,8BACA,wBACA,uBACA,iCACA,2BACA,sBACA,oBACA,8BACA,UACA,iBACA,kCACA,aACA,eACA,8BACA,YACA,OACA,OACA,wBACA,iBACA,iBACA,oBACA,2BACA,UACA,sBACA,eACA,gBACA,2BACA,yBACA,SACA,sBACA,oBACA,gBACA,eACA,SACA,iCACA,+BACA,wBACA,mBACA,qBACA,kBACA,qBACA,mBACA,cACA,aACA,OACA,0BACA,yBACA,aACA,gBACA,kBACA,kBACA,iBACA,qBACA,mBACA,6BACA,mCACA,0BACA,+BACA,mBACA,oBACA,0BACA,6BACA,0BACA,oBACA,yBACA,mBACA,oBACA,kBACA,SACA,gBACA,gBACA,cACA,MACA,2BACA,uBACA,mBACA,kBACA,qBACA,mBACA,2BACA,uBACA,gBACA,gBACA,cACA,MACA,kBACA,0BACA,iBACA,uBACA,eACA,cACA,WACA,gBACA,eACA,sBACA,oBACA,sBACA,oBACA,uBACA,sBACA,sCACA,kCACA,oBACA,mBACA,iBACA,uBACA,gBACA,qBACA,YACA,gBACA,eACA,kBACA,iBACA,WACA,YACA,kBACA,wBAID,GAAI,cACJ,MAAO,cACP,SAAQ,CACP,gBACA,iBACA,oBACA,qBACA,4BACA,0BACA,cAID,GAAI,QACJ,MAAO,iBACP,SAAQ,CACP,gBACA,iBACA,cACA,eACA,sBACA,oBACA,cAKD,GAAI,kBACJ,MAAO,kBACP,SAAQ,CACP,sBACA,mBACA,qBACA,kBACA,kBACA,iBACA,eACA,WACA,SACA,kBACA,cACA,oBACA,mBACA,UACA,mBACA,qBAID,GAAI,QACJ,MAAO,QACP,SAAQ,CACP,eACA,gBACA,iBACA,cACA,eACA,iBACA,cACA,cACA,eACA,gBACA,aACA,cACA,gBACA,aACA,yBACA,uBACA,kBACA,iBACA,8CACA,yCACA,WACA,mBACA,iBACA,gBACA,eACA,YACA,WACA,iBACA,gBACA,gBACA,cACA,wBACA,cACA,qBACA,kBACA,eACA,mBACA,wBACA,eACA,aACA,sBACA,aACA,oBACA,iBACA,cACA,kBACA,qBACA,wBACA,sBACA,eACA,cACA,wBACA,iBACA,oBACA,eACA,oBACA,uBACA,gBACA,cACA,gBACA,iBACA,oBACA,cACA,eACA,aACA,eACA,gBACA,mBACA,aACA,YAID,GAAI,gBACJ,MAAO,gBACP,SAAQ,CACP,oBACA,gBACA,kBACA,eACA,iBACA,gBACA,gBACA,eACA,gBACA,eACA,cACA,eACA,wBACA,uBACA,uBACA,sBACA,gBACA,SACA,mBACA,eACA,iBACA,cACA,eACA,cACA,eACA,cACA,mBACA,kBACA,kBACA,iBACA,oBAID,GAAI,UACJ,MAAO,UACP,SAAQ,CACP,sBACA,mBACA,qBACA,kBACA,WACA,UACA,kBACA,iBACA,YACA,WACA,QACA,eACA,cACA,2BACA,yBACA,oBACA,mBACA,mBACA,kBACA,gBACA,iBACA,kBACA,gBACA,kBACA,iBACA,eACA,iBACA,oBACA,mBACA,iBACA,kBACA,gBACA,iBACA,eACA,YACA,mBACA,eACA,cACA,WACA,WACA,kBACA,cACA,cACA,gBAID,GAAI,QACJ,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","names":["instanceOfAny","object","constructors","c","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","getCursorAdvanceMethods","cursorRequestMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","promisifyRequest","request","promise","resolve","reject","unlisten","success","error","wrap","value","cacheDonePromiseForTransaction","tx","done","complete","idbProxyTraps","target","prop","receiver","replaceTraps","callback","wrapFunction","func","storeNames","args","unwrap","transformCachableValue","newValue","openDB","name","version","blocked","upgrade","blocking","terminated","openPromise","event","db","deleteDB","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","method","storeName","oldTraps","saveAs","fileSaver","i18n","getContext","show","onUpdate","$.prop","$$props","loading","chatList","page","query","orderBy","direction","allChatsLoaded","chatListLoading","searchDebounceTimeout","showUnarchiveAllConfirmDialog","filter","$.mutable_source","searchHandler","$.set","getArchivedChatList","$.get","loadMoreChats","newChatList","exportChatsHandler","chats","getAllArchivedChats","blob","$i18n","unarchiveHandler","chatId","archiveChatById","toast","init","unarchiveAllHandler","unarchiveAllChats","$$value","$$render","consequent","alternate","$.event","button","button_1","className","strokeWidth","dispatch","createEventDispatcher","shareHandler","moveChatHandler","cloneChatHandler","archiveChatHandler","renameHandler","deleteHandler","onClose","pinned","chat","showFullMessages","pinHandler","toggleChatPinnedStatusById","checkPinned","getChatPinnedStatusById","getChatAsText","history","createMessagesList","a","message","i","arr","downloadTxt","getChatById","chatText","downloadPdf","jsPDF","html2canvas","_a","$settings","tick","containerElement","isDarkMode","virtualWidth","clonedElement","r","canvas","pdf","pageWidthMM","pageHeightMM","pxPerMM","pxPerPDFMM","pagePixelHeight","offsetY","sliceHeight","pageCanvas","imgData","imgHeightMM","doc","left","top","right","bottom","pageWidth","pageHeight","usableWidth","fontSize","lineHeight","paragraphs","y","paragraph","lines","line","downloadJSONExport","$user","$.untrack","e","flyAndScale","_c","_b","consequent_3","$folders","b","folder","x","popupElement","onMount","onDestroy","err","$.bind_this","div","$.template_effect","$.set_style","div_1","id","title","selected","shiftKey","onDragEnd","mouseOver","draggable","loadChat","showShareChatModal","confirmEdit","chatTitle","editChatTitle","updateChatById","$chatId","_chatTitle","currentChatPage","getChatList","$currentChatPage","pinnedChats","getPinnedChatList","res","cloneChatById","goto","deleteChatHandler","deleteChatById","tags","getAllTags","folderId","updateChatFolderIdById","itemElement","generating","doubleClicked","dragged","dragImage","onDragStart","onDrag","onDragEndHandler","onClickOutside","showDeleteConfirm","chatTitleInputKeydownHandler","input","generateTitleHandler","messages","model","generatedTitle","generateTitle","$.bind_value","input_1","$selectedFolder","selectedFolder","$mobile","showSidebar","consequent_1","button_2","button_3","button_4","consequent_4","alternate_1","consequent_2","alternate_2","div_4","$.set_attribute","div_8","open","collapsible","buttonClassName","chevron","onAddLabel","onAdd","dragAndDrop","folderElement","loaded","draggedOver","onDragOver","onDrop","item","file","reader","fileContent","dataTransfer","data","onDragLeave","state","consequent_5","folderRegistry","folders","deleteFolderContents","parentDragged","onDelete","onItemMove","showFolderModal","edit","clickTimer","type","updateFolderParentIdById","importChats","setFolderItems","deleteFolderById","updateHandler","meta","currentName","updateFolderById","getFolderById","isExpandedUpdateHandler","updateFolderIsExpandedById","isExpandedUpdateTimeout","isExpandedUpdateDebounceHandler","getChatListByFolderId","exportHandler","getChatsByFolderId","input_2","alternate_3","div_9","$showSidebar","children","$.derived_safe_equal","childFolder","$$anchor","$.each","node_17","consequent_8","div_6","folderList","loadFolderItems","key","node","onChange","select_value","select","$.select_option","webhook","expanded","onClick","changes","image","filesInputElement","inputFiles","handleImageUpload","dataUrl","fileType","tempImage","canvasSize","context","aspectRatio","scaledWidth","scaledHeight","offsetX","copyUrl","WEBUI_API_BASE_URL","$$args","img_1","WEBUI_BASE_URL","img","dayjs","$.bind_files","channel","webhooks","isLoading","isSaving","showDeleteConfirmDialog","selectedWebhookId","pendingChanges","loadWebhooks","getChannelWebhooks","createHandler","newWebhook","createChannelWebhook","saveHandler","webhookId","updateChannelWebhook","deleteChannelWebhook","div_7","$.mutate","form","onSubmit","channelTypes","isPrivate","accessControl","groupIds","userIds","onTypeChange","submitHandler","_d","_e","showWebhooksModal","deleteChannelById","$page","resetHandler","channelType","channelTypeIdx","$.set_selected","option","$.bind_select_value","consequent_7","consequent_6","alternate_4","consequent_9","alternate_5","consequent_10","consequent_11","consequent_12","consequent_13","consequent_14","alternate_6","consequent_15","$.preventDefault","showEditChannelModal","is_private","access_control","group_ids","user_ids","updateChannelById","channelMembers","u","index","$.set_class","dmUser","channels","chs","ch","updateChannelMemberActiveStatusById","$channels","placeholder","showClearButton","onFocus","onKeydown","selectedIdx","selectedOption","lastWord","options","focused","hovering","filteredOptions","filteredItems","initItems","$tags","tag","tagName","tagId","folderName","pinnedValue","sharedValue","archivedValue","initTags","clearSearchInput","itemIdx","$.stopPropagation","words","div_11","optionIdx","$.transition","fade","calendar","localizedFormat","actions","PencilSquare","selectedChat","selectedModels","loadChatPreview","selectedChatIdx","_f","_h","_g","messagesContainerElement","getChatListBySearchText","onKeyDown","searchInput","$config","PageEdit","node_1","action","idx","$.component","node_2","$$component","node_5","onUnpin","selectedChatId","pinnedModels","initPinnedModelsSortable","pinnedModelsList","Sortable","modelId","newIndex","oldIndex","settings","updateUserSettings","unsubscribeSettings","defaultPinnedModels","$models","isMac","mounted","keys","isVisible","shortcuts","formatKey","lowerKey","scrollTop","navElement","showCreateChannel","showCreateFolderModal","showPinnedModels","showChannels","showFolders","initFolders","getFolders","_folders","createFolder","rootFolders","tempId","uuidv4","createNewFolder","initChannels","getChannels","initChatList","scrollPaginationEnabled","_tags","_pinnedChats","_chats","$chats","importChatHandler","items","inputFilesHandler","files","content","chatItems","tagEventHandler","touchstart","touchend","checkDirection","screenWidth","swipeDistance","onTouchStart","onTouchEnd","onKeyUp","onBlur","MIN_WIDTH","MAX_WIDTH","isResizing","startWidth","startClientX","resizeStartHandler","$sidebarWidth","resizeEndHandler","resizeSidebarHandler","endClientX","dx","newSidebarWidth","sidebarWidth","unsubscribers","width","w","mobile","dropZone","unsubscriber","newChatHandler","temporaryChatEnabled","itemClickHandler","isWindows","$.window","$showArchivedChats","createNewChannel","$socket","$isApp","$showSearch","a_1","showSearch","a_2","a_3","_j","_i","_m","_l","_k","$0","showArchivedChats","node_31","channelIdx","$pinnedChats","div_46","$scrollPaginationEnabled","$.set_text","text_8","consequent_17","div_18","consequent_18","$WEBUI_NAME","div_23","button_5","div_24","slide","consequent_19","currentPassword","newPassword","newPasswordConfirm","updatePasswordHandler","updateUserPassword","saveSettings","profileImageUrl","bio","_gender","gender","dateOfBirth","webhookUrl","showAPIKeys","JWTTokenCopied","APIKey","APIKeyCopied","generateInitialsImage","updateUserProfile","sessionUser","getSessionUser","user","createAPIKeyHandler","createAPIKey","getAPIKey","input_3","copyToClipboard","ollamaVersion","updateAvailable","checkForVersionUpdates","getVersionUpdates","WEBUI_VERSION","compareVersion","getOllamaVersion","WEBUI_BUILD_HASH","text_6","showChangelog","themes","selectedTheme","languages","lang","notificationEnabled","system","showAdvanced","toggleNotification","params","getLanguages","applyTheme","_theme","themeToApply","metaThemeColor","systemTheme","themeChangeHandler","theme","select_1","language","changeLanguage","onSave","floatingActionButtons","buttonIdx","size","backgroundImageUrl","titleAutoGenerate","autoFollowUps","autoTags","responseAutoCopy","widescreenMode","scrollOnBranchChange","userLocation","defaultModelId","showUsername","notificationSound","notificationSoundAlways","highContrastMode","detectArtifacts","displayMultiModelResponsesInTabs","richTextInput","showFormattingToolbar","insertPromptAsRichText","promptAutocomplete","largeTextAsFile","insertSuggestionPrompt","keepFollowUpPrompts","insertFollowUpPrompt","regenerateMenu","landingPageMode","chatBubble","chatDirection","ctrlEnterToSend","copyFormatted","temporaryChatByDefault","chatFadeStreamingText","collapseCodeBlocks","expandDetails","showChatTitleInTab","showFloatingActionButtons","imageCompression","imageCompressionSize","imageCompressionInChannels","stylizedPdfExport","showUpdateToast","showEmojiInCall","voiceInterruption","hapticFeedback","webSearch","iframeSandboxAllowSameOrigin","iframeSandboxAllowForms","showManageFloatingActionButtonsModal","showManageImageCompressionModal","textScale","toggleLandingPageMode","toggleUserLocation","position","getUserPosition","updateUserInfo","toggleTitleAutoGenerate","toggleResponseAutoCopy","toggleChangeChatDirection","togglectrlEnterToSend","updateInterfaceHandler","toggleWebSearch","setTextScaleHandler","scale","setTextScale","_n","_o","_p","_q","_r","_s","_t","_u","_v","_w","_x","_y","_z","_A","_B","_C","_D","_E","_F","_G","_H","_I","_J","_K","_L","_M","_N","_O","_P","_Q","_R","_S","_T","_U","_W","_V","_X","_Y","_Z","__","buttons","button_6","button_9","originalImageUrl","button_7","button_8","speechAutoSend","responseAutoPlayback","nonLocalVoices","STTEngine","STTLanguage","TTSEngine","TTSEngineConfig","TTSModel","TTSModelProgress","voices","voice","playbackRate","getVoices","loadKokoro","getVoicesLoop","_getVoices","toggleResponseAutoPlayback","toggleSpeechAutoSend","onTTSEngineChange","model_id","KokoroTTS","select_2","datalist","$$index","$$array","v","_voice","option_10","select_3","datalist_1","$$index_2","$$array_1","importFiles","showArchiveConfirm","showArchivedChatsModal","chatImportInputElement","importChatsHandler","exportChats","getAllChats","archiveAllChatsHandler","archiveAllChats","deleteAllChatsHandler","deleteAllChats","handleArchivedChatsChange","getImportOrigin","convertOpenAIChats","getMemories","token","addNewMemory","updateMemoryById","deleteMemoryById","json","deleteMemoriesByUserId","textarea","memory","setContent","memories","showAddMemoryModal","showEditMemoryModal","selectedMemory","showClearConfirmDialog","onClearConfirmed","tbody","showManageModal","enableMemory","pipeline","url","config","showConfigModal","connection","showConnectionModal","addConnectionHandler","diff","urlIdx","keyIdx","newConfig","newIdx","servers","server","toolServersData","getToolServersData","toolServers","_","allSettings","availableSettings","filteredSettings","search","getAvailableSettings","tab","setFilteredSettings","keyword","selectedTab","searchDebounceHandler","updated","models","getModels","_getModels","scrollHandler","settingsTabsContainer","addScrollListener","removeScrollListener","configData","node_3","tabId","alternate_7","consequent_21","consequent_20","alternate_9","alternate_10","alternate_11","alternate_12","consequent_16","alternate_13","alternate_14","alternate_15","alternate_16","changelog","getChangelog","closeModal","Confetti","section","entry","DOMPurify","div_12","adminDetails","getAdminDetails","$.html","marked","DB","localDBChats","clearChatInputStorage","chatInputKeys","checkLocalDBChats","setUserSettings","cb","userSettings","getUserSettings","setModels","setToolServers","setBanners","bannersData","getBanners","banners","setTools","toolsData","getTools","tools","isShortcutMatch","shortcut","normalized","k","needCtrl","needShift","needAlt","mainKeys","keyPressed","Shortcut","showSettings","$showSettings","showShortcuts","$showShortcuts","$temporaryChatEnabled","dismissedUpdateToast","$showChangelog"],"ignoreList":[0,1],"sources":["../../../../../../node_modules/idb/build/wrap-idb-value.js","../../../../../../node_modules/idb/build/index.js","../../../../../../src/lib/components/layout/ArchivedChatsModal.svelte","../../../../../../src/lib/components/icons/Bookmark.svelte","../../../../../../src/lib/components/icons/BookmarkSlash.svelte","../../../../../../src/lib/components/layout/Sidebar/ChatMenu.svelte","../../../../../../src/lib/components/common/DragGhost.svelte","../../../../../../src/lib/components/icons/Document.svelte","../../../../../../src/lib/components/layout/Sidebar/ChatItem.svelte","../../../../../../src/lib/components/common/Folder.svelte","../../../../../../src/lib/components/layout/Sidebar/RecursiveFolder.svelte","../../../../../../src/lib/components/layout/Sidebar/Folders.svelte","../../../../../../src/lib/components/workspace/common/Visibility.svelte","../../../../../../src/lib/components/channel/WebhookItem.svelte","../../../../../../src/lib/components/channel/WebhooksModal.svelte","../../../../../../src/lib/components/layout/Sidebar/ChannelModal.svelte","../../../../../../src/lib/components/layout/Sidebar/ChannelItem.svelte","../../../../../../src/lib/components/layout/Sidebar/SearchInput.svelte","../../../../../../src/lib/components/layout/SearchModal.svelte","../../../../../../src/lib/components/layout/Sidebar/PinnedModelItem.svelte","../../../../../../src/lib/components/layout/Sidebar/PinnedModelList.svelte","../../../../../../src/lib/components/icons/Note.svelte","../../../../../../src/lib/components/common/HotkeyHint.svelte","../../../../../../src/lib/components/layout/Sidebar.svelte","../../../../../../src/lib/components/chat/Settings/Account/UpdatePassword.svelte","../../../../../../src/lib/components/chat/Settings/Account.svelte","../../../../../../src/lib/components/chat/Settings/About.svelte","../../../../../../src/lib/components/chat/Settings/General.svelte","../../../../../../src/lib/components/chat/Settings/Interface/ManageFloatingActionButtonsModal.svelte","../../../../../../src/lib/components/chat/Settings/Interface/ManageImageCompressionModal.svelte","../../../../../../src/lib/components/chat/Settings/Interface.svelte","../../../../../../src/lib/components/chat/Settings/Audio.svelte","../../../../../../src/lib/components/chat/Settings/DataControls.svelte","../../../../../../src/lib/apis/memories/index.ts","../../../../../../src/lib/components/chat/Settings/Personalization/AddMemoryModal.svelte","../../../../../../src/lib/components/chat/Settings/Personalization/EditMemoryModal.svelte","../../../../../../src/lib/components/chat/Settings/Personalization/ManageModal.svelte","../../../../../../src/lib/components/chat/Settings/Personalization.svelte","../../../../../../src/lib/components/chat/Settings/Connections/Connection.svelte","../../../../../../src/lib/components/chat/Settings/Connections.svelte","../../../../../../src/lib/components/chat/Settings/Tools.svelte","../../../../../../src/lib/components/icons/DatabaseSettings.svelte","../../../../../../src/lib/components/icons/SettingsAlt.svelte","../../../../../../src/lib/components/icons/UserCircle.svelte","../../../../../../src/lib/components/icons/SoundHigh.svelte","../../../../../../src/lib/components/icons/InfoCircle.svelte","../../../../../../src/lib/components/icons/Face.svelte","../../../../../../src/lib/components/icons/AppNotification.svelte","../../../../../../src/lib/components/icons/UserBadgeCheck.svelte","../../../../../../src/lib/components/chat/SettingsModal.svelte","../../../../../../src/lib/components/ChangelogModal.svelte","../../../../../../src/lib/components/layout/Overlay/AccountPending.svelte","../../../../../../src/lib/components/layout/UpdateInfoToast.svelte","../../../../../../src/routes/(app)/+layout.svelte"],"sourcesContent":["const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","<script lang=\"ts\">\n\t// @ts-ignore\n\timport fileSaver from 'file-saver';\n\timport type { Writable } from 'svelte/store';\n\tconst { saveAs } = fileSaver;\n\n\timport { toast } from 'svelte-sonner';\n\timport { getContext } from 'svelte';\n\timport {\n\t\tarchiveChatById,\n\t\tgetAllArchivedChats,\n\t\tgetArchivedChatList,\n\t\tunarchiveAllChats\n\t} from '$lib/apis/chats';\n\n\timport ChatsModal from './ChatsModal.svelte';\n\timport UnarchiveAllConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport Spinner from '../common/Spinner.svelte';\n\n\tconst i18n: Writable<any> = getContext('i18n');\n\n\texport let show = false;\n\texport let onUpdate = () => {};\n\n\tlet loading = false;\n\tlet chatList: any[] | null = null;\n\tlet page = 1;\n\n\tlet query = '';\n\tlet orderBy = 'updated_at';\n\tlet direction = 'desc';\n\n\tlet allChatsLoaded = false;\n\tlet chatListLoading = false;\n\tlet searchDebounceTimeout: any;\n\n\tlet showUnarchiveAllConfirmDialog = false;\n\n\tlet filter: any = {};\n\t$: filter = {\n\t\t...(query ? { query } : {}),\n\t\t...(orderBy ? { order_by: orderBy } : {}),\n\t\t...(direction ? { direction } : {})\n\t};\n\n\t$: if (filter !== null) {\n\t\tsearchHandler();\n\t}\n\n\tconst searchHandler = async () => {\n\t\tif (!show) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (searchDebounceTimeout) {\n\t\t\tclearTimeout(searchDebounceTimeout);\n\t\t}\n\n\t\tpage = 1;\n\t\tchatList = null;\n\n\t\tif (query === '') {\n\t\t\tchatList = await getArchivedChatList(localStorage.token, page, filter);\n\t\t} else {\n\t\t\tsearchDebounceTimeout = setTimeout(async () => {\n\t\t\t\tchatList = await getArchivedChatList(localStorage.token, page, filter);\n\t\t\t}, 500);\n\t\t}\n\n\t\tif ((chatList ?? []).length === 0) {\n\t\t\tallChatsLoaded = true;\n\t\t} else {\n\t\t\tallChatsLoaded = false;\n\t\t}\n\t};\n\n\tconst loadMoreChats = async () => {\n\t\tchatListLoading = true;\n\t\tpage += 1;\n\n\t\tlet newChatList = [];\n\n\t\tif (query) {\n\t\t\tnewChatList = await getArchivedChatList(localStorage.token, page, filter);\n\t\t} else {\n\t\t\tnewChatList = await getArchivedChatList(localStorage.token, page, filter);\n\t\t}\n\n\t\t// once the bottom of the list has been reached (no results) there is no need to continue querying\n\t\tallChatsLoaded = newChatList.length === 0;\n\n\t\tif (newChatList.length > 0) {\n\t\t\tchatList = [...(chatList || []), ...newChatList];\n\t\t}\n\n\t\tchatListLoading = false;\n\t};\n\n\tconst exportChatsHandler = async () => {\n\t\tconst chats = await getAllArchivedChats(localStorage.token);\n\t\tlet blob = new Blob([JSON.stringify(chats)], {\n\t\t\ttype: 'application/json'\n\t\t});\n\t\tsaveAs(blob, `${$i18n.t('archived-chat-export')}-${Date.now()}.json`);\n\t};\n\n\tconst unarchiveHandler = async (chatId: string) => {\n\t\tconst res = await archiveChatById(localStorage.token, chatId).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t});\n\n\t\tonUpdate();\n\t\tinit();\n\t};\n\n\tconst unarchiveAllHandler = async () => {\n\t\tloading = true;\n\t\ttry {\n\t\t\tawait unarchiveAllChats(localStorage.token);\n\t\t\ttoast.success($i18n.t('All chats have been unarchived.'));\n\t\t\tonUpdate();\n\t\t\tawait init();\n\t\t} catch (error) {\n\t\t\ttoast.error(`${error}`);\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t};\n\n\tconst init = async () => {\n\t\tchatList = await getArchivedChatList(localStorage.token);\n\t};\n\n\t$: if (show) {\n\t\tinit();\n\t}\n</script>\n\n<UnarchiveAllConfirmDialog\n\tbind:show={showUnarchiveAllConfirmDialog}\n\tmessage={$i18n.t('Are you sure you want to unarchive all archived chats?')}\n\tconfirmLabel={$i18n.t('Unarchive All')}\n\ton:confirm={() => {\n\t\tunarchiveAllHandler();\n\t}}\n/>\n\n<ChatsModal\n\tbind:show\n\tbind:query\n\tbind:orderBy\n\tbind:direction\n\ttitle={$i18n.t('Archived Chats')}\n\temptyPlaceholder={$i18n.t('You have no archived conversations.')}\n\t{chatList}\n\t{allChatsLoaded}\n\t{chatListLoading}\n\tonUpdate={() => {\n\t\tinit();\n\t}}\n\tloadHandler={loadMoreChats}\n\t{unarchiveHandler}\n>\n\t<div slot=\"footer\">\n\t\t<div class=\"flex flex-wrap text-sm font-medium gap-1.5 mt-2 m-1 justify-end w-full\">\n\t\t\t<button\n\t\t\t\tclass=\" px-3.5 py-1.5 font-medium hover:bg-black/5 dark:hover:bg-white/5 outline outline-1 outline-gray-100 dark:outline-gray-800 rounded-3xl\"\n\t\t\t\tdisabled={loading}\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowUnarchiveAllConfirmDialog = true;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{#if loading}\n\t\t\t\t\t<Spinner className=\"size-4\" />\n\t\t\t\t{:else}\n\t\t\t\t\t{$i18n.t('Unarchive All Archived Chats')}\n\t\t\t\t{/if}\n\t\t\t</button>\n\n\t\t\t<button\n\t\t\t\tclass=\"px-3.5 py-1.5 font-medium hover:bg-black/5 dark:hover:bg-white/5 outline outline-1 outline-gray-100 dark:outline-gray-800 rounded-3xl\"\n\t\t\t\tdisabled={loading}\n\t\t\t\ton:click={() => {\n\t\t\t\t\texportChatsHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{$i18n.t('Export All Archived Chats')}\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</ChatsModal>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"m3 3 1.664 1.664M21 21l-1.5-1.5m-5.485-1.242L12 17.25 4.5 21V8.742m.164-4.078a2.15 2.15 0 0 1 1.743-1.342 48.507 48.507 0 0 1 11.186 0c1.1.128 1.907 1.077 1.907 2.185V19.5M4.664 4.664 19.5 19.5\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { getContext, createEventDispatcher, tick } from 'svelte';\n\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\tconst dispatch = createEventDispatcher();\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport Pencil from '$lib/components/icons/Pencil.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Tags from '$lib/components/chat/Tags.svelte';\n\timport Share from '$lib/components/icons/Share.svelte';\n\timport ArchiveBox from '$lib/components/icons/ArchiveBox.svelte';\n\timport DocumentDuplicate from '$lib/components/icons/DocumentDuplicate.svelte';\n\timport Bookmark from '$lib/components/icons/Bookmark.svelte';\n\timport BookmarkSlash from '$lib/components/icons/BookmarkSlash.svelte';\n\timport {\n\t\tgetChatById,\n\t\tgetChatPinnedStatusById,\n\t\ttoggleChatPinnedStatusById\n\t} from '$lib/apis/chats';\n\timport { chats, folders, settings, theme, user } from '$lib/stores';\n\timport { createMessagesList } from '$lib/utils';\n\timport { downloadChatAsPDF } from '$lib/apis/utils';\n\timport Download from '$lib/components/icons/Download.svelte';\n\timport Folder from '$lib/components/icons/Folder.svelte';\n\timport Messages from '$lib/components/chat/Messages.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let shareHandler: Function;\n\texport let moveChatHandler: Function;\n\n\texport let cloneChatHandler: Function;\n\texport let archiveChatHandler: Function;\n\texport let renameHandler: Function;\n\texport let deleteHandler: Function;\n\texport let onClose: Function;\n\n\texport let chatId = '';\n\n\tlet show = false;\n\tlet pinned = false;\n\n\tlet chat = null;\n\tlet showFullMessages = false;\n\n\tconst pinHandler = async () => {\n\t\tawait toggleChatPinnedStatusById(localStorage.token, chatId);\n\t\tdispatch('change');\n\t};\n\n\tconst checkPinned = async () => {\n\t\tpinned = await getChatPinnedStatusById(localStorage.token, chatId);\n\t};\n\n\tconst getChatAsText = async (chat) => {\n\t\tconst history = chat.chat.history;\n\t\tconst messages = createMessagesList(history, history.currentId);\n\t\tconst chatText = messages.reduce((a, message, i, arr) => {\n\t\t\treturn `${a}### ${message.role.toUpperCase()}\\n${message.content}\\n\\n`;\n\t\t}, '');\n\n\t\treturn chatText.trim();\n\t};\n\n\tconst downloadTxt = async () => {\n\t\tconst chat = await getChatById(localStorage.token, chatId);\n\t\tif (!chat) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatText = await getChatAsText(chat);\n\t\tlet blob = new Blob([chatText], {\n\t\t\ttype: 'text/plain'\n\t\t});\n\n\t\tsaveAs(blob, `chat-${chat.chat.title}.txt`);\n\t};\n\n\tconst downloadPdf = async () => {\n\t\tchat = await getChatById(localStorage.token, chatId);\n\t\tif (!chat) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [{ default: jsPDF }, { default: html2canvas }] = await Promise.all([\n\t\t\timport('jspdf'),\n\t\t\timport('html2canvas-pro')\n\t\t]);\n\n\t\tif ($settings?.stylizedPdfExport ?? true) {\n\t\t\tshowFullMessages = true;\n\t\t\tawait tick();\n\n\t\t\tconst containerElement = document.getElementById('full-messages-container');\n\t\t\tif (containerElement) {\n\t\t\t\ttry {\n\t\t\t\t\tconst isDarkMode = document.documentElement.classList.contains('dark');\n\t\t\t\t\tconst virtualWidth = 800; // px, fixed width for cloned element\n\n\t\t\t\t\t// Clone and style\n\t\t\t\t\tconst clonedElement = containerElement.cloneNode(true);\n\t\t\t\t\tclonedElement.classList.add('text-black');\n\t\t\t\t\tclonedElement.classList.add('dark:text-white');\n\t\t\t\t\tclonedElement.style.width = `${virtualWidth}px`;\n\t\t\t\t\tclonedElement.style.position = 'absolute';\n\t\t\t\t\tclonedElement.style.left = '-9999px';\n\t\t\t\t\tclonedElement.style.height = 'auto';\n\t\t\t\t\tdocument.body.appendChild(clonedElement);\n\n\t\t\t\t\t// Wait for DOM update/layout\n\t\t\t\t\tawait new Promise((r) => setTimeout(r, 100));\n\n\t\t\t\t\t// Render entire content once\n\t\t\t\t\tconst canvas = await html2canvas(clonedElement, {\n\t\t\t\t\t\tbackgroundColor: isDarkMode ? '#000' : '#fff',\n\t\t\t\t\t\tuseCORS: true,\n\t\t\t\t\t\tscale: 2, // increase resolution\n\t\t\t\t\t\twidth: virtualWidth\n\t\t\t\t\t});\n\n\t\t\t\t\tdocument.body.removeChild(clonedElement);\n\n\t\t\t\t\tconst pdf = new jsPDF('p', 'mm', 'a4');\n\t\t\t\t\tconst pageWidthMM = 210;\n\t\t\t\t\tconst pageHeightMM = 297;\n\n\t\t\t\t\t// Convert page height in mm to px on canvas scale for cropping\n\t\t\t\t\t// Get canvas DPI scale:\n\t\t\t\t\tconst pxPerMM = canvas.width / virtualWidth; // width in px / width in px?\n\t\t\t\t\t// Since 1 page width is 210 mm, but canvas width is 800 px at scale 2\n\t\t\t\t\t// Assume 1 mm = px / (pageWidthMM scaled)\n\t\t\t\t\t// Actually better: Calculate scale factor from px/mm:\n\t\t\t\t\t// virtualWidth px corresponds directly to 210mm in PDF, so pxPerMM:\n\t\t\t\t\tconst pxPerPDFMM = canvas.width / pageWidthMM; // canvas px per PDF mm\n\n\t\t\t\t\t// Height in px for one page slice:\n\t\t\t\t\tconst pagePixelHeight = Math.floor(pxPerPDFMM * pageHeightMM);\n\n\t\t\t\t\tlet offsetY = 0;\n\t\t\t\t\tlet page = 0;\n\n\t\t\t\t\twhile (offsetY < canvas.height) {\n\t\t\t\t\t\t// Height of slice\n\t\t\t\t\t\tconst sliceHeight = Math.min(pagePixelHeight, canvas.height - offsetY);\n\n\t\t\t\t\t\t// Create temp canvas for slice\n\t\t\t\t\t\tconst pageCanvas = document.createElement('canvas');\n\t\t\t\t\t\tpageCanvas.width = canvas.width;\n\t\t\t\t\t\tpageCanvas.height = sliceHeight;\n\n\t\t\t\t\t\tconst ctx = pageCanvas.getContext('2d');\n\n\t\t\t\t\t\t// Draw the slice of original canvas onto pageCanvas\n\t\t\t\t\t\tctx.drawImage(\n\t\t\t\t\t\t\tcanvas,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\toffsetY,\n\t\t\t\t\t\t\tcanvas.width,\n\t\t\t\t\t\t\tsliceHeight,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tcanvas.width,\n\t\t\t\t\t\t\tsliceHeight\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst imgData = pageCanvas.toDataURL('image/jpeg', 0.7);\n\n\t\t\t\t\t\t// Calculate image height in PDF units keeping aspect ratio\n\t\t\t\t\t\tconst imgHeightMM = (sliceHeight * pageWidthMM) / canvas.width;\n\n\t\t\t\t\t\tif (page > 0) pdf.addPage();\n\n\t\t\t\t\t\tif (isDarkMode) {\n\t\t\t\t\t\t\tpdf.setFillColor(0, 0, 0);\n\t\t\t\t\t\t\tpdf.rect(0, 0, pageWidthMM, pageHeightMM, 'F'); // black bg\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpdf.addImage(imgData, 'JPEG', 0, 0, pageWidthMM, imgHeightMM);\n\n\t\t\t\t\t\toffsetY += sliceHeight;\n\t\t\t\t\t\tpage++;\n\t\t\t\t\t}\n\n\t\t\t\t\tpdf.save(`chat-${chat.chat.title}.pdf`);\n\n\t\t\t\t\tshowFullMessages = false;\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('Error generating PDF', error);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.log('Downloading PDF');\n\n\t\t\tconst chatText = await getChatAsText(chat);\n\n\t\t\tconst doc = new jsPDF();\n\n\t\t\t// Margins\n\t\t\tconst left = 15;\n\t\t\tconst top = 20;\n\t\t\tconst right = 15;\n\t\t\tconst bottom = 20;\n\n\t\t\tconst pageWidth = doc.internal.pageSize.getWidth();\n\t\t\tconst pageHeight = doc.internal.pageSize.getHeight();\n\t\t\tconst usableWidth = pageWidth - left - right;\n\t\t\tconst usableHeight = pageHeight - top - bottom;\n\n\t\t\t// Font size and line height\n\t\t\tconst fontSize = 8;\n\t\t\tdoc.setFontSize(fontSize);\n\t\t\tconst lineHeight = fontSize * 1; // adjust if needed\n\n\t\t\t// Split the markdown into lines (handles \\n)\n\t\t\tconst paragraphs = chatText.split('\\n');\n\n\t\t\tlet y = top;\n\n\t\t\tfor (let paragraph of paragraphs) {\n\t\t\t\t// Wrap each paragraph to fit the width\n\t\t\t\tconst lines = doc.splitTextToSize(paragraph, usableWidth);\n\n\t\t\t\tfor (let line of lines) {\n\t\t\t\t\t// If the line would overflow the bottom, add a new page\n\t\t\t\t\tif (y + lineHeight > pageHeight - bottom) {\n\t\t\t\t\t\tdoc.addPage();\n\t\t\t\t\t\ty = top;\n\t\t\t\t\t}\n\t\t\t\t\tdoc.text(line, left, y);\n\t\t\t\t\ty += lineHeight * 0.5;\n\t\t\t\t}\n\t\t\t\t// Add empty line at paragraph breaks\n\t\t\t\ty += lineHeight * 0.1;\n\t\t\t}\n\n\t\t\tdoc.save(`chat-${chat.chat.title}.pdf`);\n\t\t}\n\t};\n\n\tconst downloadJSONExport = async () => {\n\t\tconst chat = await getChatById(localStorage.token, chatId);\n\n\t\tif (chat) {\n\t\t\tlet blob = new Blob([JSON.stringify([chat])], {\n\t\t\t\ttype: 'application/json'\n\t\t\t});\n\t\t\tsaveAs(blob, `chat-export-${Date.now()}.json`);\n\t\t}\n\t};\n\n\t$: if (show) {\n\t\tcheckPinned();\n\t}\n</script>\n\n{#if chat && showFullMessages}\n\t<div class=\"hidden w-full h-full flex-col\">\n\t\t<div id=\"full-messages-container\">\n\t\t\t<Messages\n\t\t\t\tclassName=\"h-full flex pt-4 pb-8 w-full\"\n\t\t\t\tchatId={`chat-preview-${chat?.id ?? ''}`}\n\t\t\t\tuser={$user}\n\t\t\t\treadOnly={true}\n\t\t\t\thistory={chat.chat.history}\n\t\t\t\tmessages={chat.chat.messages}\n\t\t\t\tautoScroll={true}\n\t\t\t\tsendMessage={() => {}}\n\t\t\t\tcontinueResponse={() => {}}\n\t\t\t\tregenerateResponse={() => {}}\n\t\t\t\tmessagesCount={null}\n\t\t\t\teditCodeBlock={false}\n\t\t\t/>\n\t\t</div>\n\t</div>\n{/if}\n\n<Dropdown\n\tbind:show\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n>\n\t<Tooltip content={$i18n.t('More')}>\n\t\t<slot />\n\t</Tooltip>\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[200px] rounded-2xl px-1 py-1  border border-gray-100  dark:border-gray-800 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg transition\"\n\t\t\tsideOffset={-2}\n\t\t\tside=\"bottom\"\n\t\t\talign=\"start\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t{#if $user?.role === 'admin' || ($user.permissions?.chat?.share ?? true)}\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshareHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Share strokeWidth=\"1.5\" />\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Share')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t{/if}\n\n\t\t\t<DropdownMenu.Sub>\n\t\t\t\t<DropdownMenu.SubTrigger\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t>\n\t\t\t\t\t<Download strokeWidth=\"1.5\" />\n\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Download')}</div>\n\t\t\t\t</DropdownMenu.SubTrigger>\n\t\t\t\t<DropdownMenu.SubContent\n\t\t\t\t\tclass=\"w-full rounded-2xl p-1 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg border border-gray-100  dark:border-gray-800\"\n\t\t\t\t\ttransition={flyAndScale}\n\t\t\t\t\tsideOffset={8}\n\t\t\t\t>\n\t\t\t\t\t{#if $user?.role === 'admin' || ($user.permissions?.chat?.export ?? true)}\n\t\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tdownloadJSONExport();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Export chat (.json)')}</div>\n\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdownloadTxt();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Plain text (.txt)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl select-none w-full\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdownloadPdf();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('PDF document (.pdf)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t</DropdownMenu.SubContent>\n\t\t\t</DropdownMenu.Sub>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\trenameHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Pencil strokeWidth=\"1.5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Rename')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<hr class=\"border-gray-50/30 dark:border-gray-800/30 my-1\" />\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tpinHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{#if pinned}\n\t\t\t\t\t<BookmarkSlash strokeWidth=\"1.5\" />\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Unpin')}</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<Bookmark strokeWidth=\"1.5\" />\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Pin')}</div>\n\t\t\t\t{/if}\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tcloneChatHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<DocumentDuplicate strokeWidth=\"1.5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Clone')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t{#if chatId && $folders.length > 0}\n\t\t\t\t<DropdownMenu.Sub>\n\t\t\t\t\t<DropdownMenu.SubTrigger\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl select-none w-full\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Folder />\n\n\t\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Move')}</div>\n\t\t\t\t\t</DropdownMenu.SubTrigger>\n\t\t\t\t\t<DropdownMenu.SubContent\n\t\t\t\t\t\tclass=\"w-full rounded-2xl p-1 z-50 bg-white dark:bg-gray-850 dark:text-white border border-gray-100  dark:border-gray-800 shadow-lg max-h-52 overflow-y-auto scrollbar-hidden\"\n\t\t\t\t\t\ttransition={flyAndScale}\n\t\t\t\t\t\tsideOffset={8}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#each $folders.sort((a, b) => b.updated_at - a.updated_at) as folder}\n\t\t\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tmoveChatHandler(chatId, folder.id);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Folder />\n\n\t\t\t\t\t\t\t\t<div class=\"flex items-center\">{folder?.name ?? 'Folder'}</div>\n\t\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</DropdownMenu.SubContent>\n\t\t\t\t</DropdownMenu.Sub>\n\t\t\t{/if}\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tarchiveChatHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<ArchiveBox strokeWidth=\"1.5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Archive')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tdeleteHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<GarbageBin strokeWidth=\"1.5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Delete')}</div>\n\t\t\t</DropdownMenu.Item>\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport { onDestroy, onMount } from 'svelte';\n\n\texport let x;\n\texport let y;\n\n\tlet popupElement = null;\n\n\tonMount(() => {\n\t\tdocument.body.appendChild(popupElement);\n\t\tdocument.body.style.overflow = 'hidden';\n\t});\n\n\tonDestroy(() => {\n\t\tif (popupElement && popupElement.parentNode) {\n\t\t\ttry {\n\t\t\t\tpopupElement.parentNode.removeChild(popupElement);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.warn('Failed to remove popupElement:', err);\n\t\t\t}\n\t\t}\n\n\t\tdocument.body.style.overflow = 'unset';\n\t});\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<!-- svelte-ignore a11y-no-static-element-interactions -->\n\n<div\n\tbind:this={popupElement}\n\tclass=\"fixed top-0 left-0 w-screen h-[100dvh] z-50 touch-none pointer-events-none\"\n>\n\t<div class=\" absolute text-white z-99999\" style=\"top: {y + 10}px; left: {x + 10}px;\">\n\t\t<slot></slot>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\texport let className = 'size-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { goto, invalidate, invalidateAll } from '$app/navigation';\n\timport { onMount, getContext, createEventDispatcher, tick, onDestroy } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\tconst dispatch = createEventDispatcher();\n\n\timport {\n\t\tarchiveChatById,\n\t\tcloneChatById,\n\t\tdeleteChatById,\n\t\tgetAllTags,\n\t\tgetChatById,\n\t\tgetChatList,\n\t\tgetChatListByTagName,\n\t\tgetPinnedChatList,\n\t\tupdateChatById,\n\t\tupdateChatFolderIdById\n\t} from '$lib/apis/chats';\n\timport {\n\t\tchatId,\n\t\tchatTitle as _chatTitle,\n\t\tchats,\n\t\tmobile,\n\t\tpinnedChats,\n\t\tshowSidebar,\n\t\tcurrentChatPage,\n\t\ttags,\n\t\tselectedFolder\n\t} from '$lib/stores';\n\n\timport ChatMenu from './ChatMenu.svelte';\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport ShareChatModal from '$lib/components/chat/ShareChatModal.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport ArchiveBox from '$lib/components/icons/ArchiveBox.svelte';\n\timport DragGhost from '$lib/components/common/DragGhost.svelte';\n\timport Check from '$lib/components/icons/Check.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport Document from '$lib/components/icons/Document.svelte';\n\timport Sparkles from '$lib/components/icons/Sparkles.svelte';\n\timport { generateTitle } from '$lib/apis';\n\n\texport let className = '';\n\n\texport let id;\n\texport let title;\n\n\texport let selected = false;\n\texport let shiftKey = false;\n\n\texport let onDragEnd = () => {};\n\n\tlet chat = null;\n\n\tlet mouseOver = false;\n\tlet draggable = false;\n\t$: if (mouseOver) {\n\t\tloadChat();\n\t}\n\n\tconst loadChat = async () => {\n\t\tif (!chat) {\n\t\t\tdraggable = false;\n\t\t\tchat = await getChatById(localStorage.token, id);\n\t\t\tdraggable = true;\n\t\t}\n\t};\n\n\tlet showShareChatModal = false;\n\tlet confirmEdit = false;\n\n\tlet chatTitle = title;\n\n\tconst editChatTitle = async (id, title) => {\n\t\tif (title === '') {\n\t\t\ttoast.error($i18n.t('Title cannot be an empty string.'));\n\t\t} else {\n\t\t\tawait updateChatById(localStorage.token, id, {\n\t\t\t\ttitle: title\n\t\t\t});\n\n\t\t\tif (id === $chatId) {\n\t\t\t\t_chatTitle.set(title);\n\t\t\t}\n\n\t\t\tcurrentChatPage.set(1);\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\tawait pinnedChats.set(await getPinnedChatList(localStorage.token));\n\n\t\t\tdispatch('change');\n\t\t}\n\t};\n\n\tconst cloneChatHandler = async (id) => {\n\t\tconst res = await cloneChatById(\n\t\t\tlocalStorage.token,\n\t\t\tid,\n\t\t\t$i18n.t('Clone of {{TITLE}}', {\n\t\t\t\tTITLE: title\n\t\t\t})\n\t\t).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tgoto(`/c/${res.id}`);\n\n\t\t\tcurrentChatPage.set(1);\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\tawait pinnedChats.set(await getPinnedChatList(localStorage.token));\n\t\t}\n\t};\n\n\tconst deleteChatHandler = async (id) => {\n\t\tconst res = await deleteChatById(localStorage.token, id).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\ttags.set(await getAllTags(localStorage.token));\n\t\t\tif ($chatId === id) {\n\t\t\t\tawait goto('/');\n\n\t\t\t\tawait chatId.set('');\n\t\t\t\tawait tick();\n\t\t\t}\n\n\t\t\tdispatch('change');\n\t\t}\n\t};\n\n\tconst archiveChatHandler = async (id) => {\n\t\tawait archiveChatById(localStorage.token, id);\n\t\tdispatch('change');\n\t};\n\n\tconst moveChatHandler = async (chatId, folderId) => {\n\t\tif (chatId && folderId) {\n\t\t\tconst res = await updateChatFolderIdById(localStorage.token, chatId, folderId).catch(\n\t\t\t\t(error) => {\n\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (res) {\n\t\t\t\tcurrentChatPage.set(1);\n\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\t\tawait pinnedChats.set(await getPinnedChatList(localStorage.token));\n\n\t\t\t\tdispatch('change');\n\n\t\t\t\ttoast.success($i18n.t('Chat moved successfully'));\n\t\t\t}\n\t\t} else {\n\t\t\ttoast.error($i18n.t('Failed to move chat'));\n\t\t}\n\t};\n\n\tlet itemElement;\n\n\tlet generating = false;\n\n\tlet ignoreBlur = false;\n\tlet doubleClicked = false;\n\n\tlet dragged = false;\n\tlet x = 0;\n\tlet y = 0;\n\n\tconst dragImage = new Image();\n\tdragImage.src =\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n\n\tconst onDragStart = (event) => {\n\t\tevent.stopPropagation();\n\n\t\tevent.dataTransfer.setDragImage(dragImage, 0, 0);\n\n\t\t// Set the data to be transferred\n\t\tevent.dataTransfer.setData(\n\t\t\t'text/plain',\n\t\t\tJSON.stringify({\n\t\t\t\ttype: 'chat',\n\t\t\t\tid: id,\n\t\t\t\titem: chat\n\t\t\t})\n\t\t);\n\n\t\tdragged = true;\n\t\titemElement.style.opacity = '0.5'; // Optional: Visual cue to show it's being dragged\n\t};\n\n\tconst onDrag = (event) => {\n\t\tevent.stopPropagation();\n\n\t\tx = event.clientX;\n\t\ty = event.clientY;\n\t};\n\n\tconst onDragEndHandler = (event) => {\n\t\tevent.stopPropagation();\n\n\t\titemElement.style.opacity = '1'; // Reset visual cue after drag\n\t\tdragged = false;\n\n\t\tonDragEnd(event);\n\t};\n\n\tconst onClickOutside = (event) => {\n\t\tif (!itemElement.contains(event.target)) {\n\t\t\tif (confirmEdit) {\n\t\t\t\tif (chatTitle !== title) {\n\t\t\t\t\teditChatTitle(id, chatTitle);\n\t\t\t\t}\n\n\t\t\t\tconfirmEdit = false;\n\t\t\t\tchatTitle = '';\n\t\t\t}\n\t\t}\n\t};\n\n\tonMount(() => {\n\t\tif (itemElement) {\n\t\t\tdocument.addEventListener('click', onClickOutside, true);\n\n\t\t\t// Event listener for when dragging starts\n\t\t\titemElement.addEventListener('dragstart', onDragStart);\n\t\t\t// Event listener for when dragging occurs (optional)\n\t\t\titemElement.addEventListener('drag', onDrag);\n\t\t\t// Event listener for when dragging ends\n\t\t\titemElement.addEventListener('dragend', onDragEndHandler);\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (itemElement) {\n\t\t\tdocument.removeEventListener('click', onClickOutside, true);\n\n\t\t\titemElement.removeEventListener('dragstart', onDragStart);\n\t\t\titemElement.removeEventListener('drag', onDrag);\n\t\t\titemElement.removeEventListener('dragend', onDragEndHandler);\n\t\t}\n\t});\n\n\tlet showDeleteConfirm = false;\n\n\tconst chatTitleInputKeydownHandler = (e) => {\n\t\tif (e.key === 'Enter') {\n\t\t\te.preventDefault();\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst input = document.getElementById(`chat-title-input-${id}`);\n\t\t\t\tif (input) input.blur();\n\t\t\t}, 0);\n\t\t} else if (e.key === 'Escape') {\n\t\t\te.preventDefault();\n\t\t\tconfirmEdit = false;\n\t\t\tchatTitle = '';\n\t\t}\n\t};\n\n\tconst renameHandler = async () => {\n\t\tchatTitle = title;\n\t\tconfirmEdit = true;\n\n\t\tawait tick();\n\n\t\tsetTimeout(() => {\n\t\t\tconst input = document.getElementById(`chat-title-input-${id}`);\n\t\t\tif (input) {\n\t\t\t\tinput.focus();\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}, 0);\n\t};\n\n\tconst generateTitleHandler = async () => {\n\t\tgenerating = true;\n\t\tif (!chat) {\n\t\t\tchat = await getChatById(localStorage.token, id);\n\t\t}\n\n\t\tconst messages = (chat.chat?.messages ?? []).map((message) => {\n\t\t\treturn {\n\t\t\t\trole: message.role,\n\t\t\t\tcontent: message.content\n\t\t\t};\n\t\t});\n\n\t\tconst model = chat.chat.models.at(0) ?? chat.models.at(0) ?? '';\n\n\t\tchatTitle = '';\n\n\t\tconst generatedTitle = await generateTitle(localStorage.token, model, messages).catch(\n\t\t\t(error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t);\n\n\t\tif (generatedTitle) {\n\t\t\tif (generatedTitle !== title) {\n\t\t\t\teditChatTitle(id, generatedTitle);\n\t\t\t}\n\n\t\t\tconfirmEdit = false;\n\t\t} else {\n\t\t\tchatTitle = title;\n\t\t}\n\n\t\tgenerating = false;\n\t};\n</script>\n\n<ShareChatModal bind:show={showShareChatModal} chatId={id} />\n\n<DeleteConfirmDialog\n\tbind:show={showDeleteConfirm}\n\ttitle={$i18n.t('Delete chat?')}\n\ton:confirm={() => {\n\t\tdeleteChatHandler(id);\n\t}}\n>\n\t<div class=\" text-sm text-gray-500 flex-1 line-clamp-3\">\n\t\t{$i18n.t('This will delete')} <span class=\"  font-semibold\">{title}</span>.\n\t</div>\n</DeleteConfirmDialog>\n\n{#if dragged && x && y}\n\t<DragGhost {x} {y}>\n\t\t<div class=\" bg-black/80 backdrop-blur-2xl px-2 py-1 rounded-lg w-fit max-w-40\">\n\t\t\t<div class=\"flex items-center gap-1\">\n\t\t\t\t<Document className=\" size-[18px]\" strokeWidth=\"2\" />\n\t\t\t\t<div class=\" text-xs text-white line-clamp-1\">\n\t\t\t\t\t{title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</DragGhost>\n{/if}\n\n<div\n\tid=\"sidebar-chat-group\"\n\tbind:this={itemElement}\n\tclass=\" w-full {className} relative group\"\n\tdraggable={draggable && !confirmEdit}\n>\n\t{#if confirmEdit}\n\t\t<div\n\t\t\tid=\"sidebar-chat-item\"\n\t\t\tclass=\" w-full flex justify-between rounded-xl px-[11px] py-[6px] {id === $chatId ||\n\t\t\tconfirmEdit\n\t\t\t\t? 'bg-gray-100 dark:bg-gray-900 selected'\n\t\t\t\t: selected\n\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-950 selected'\n\t\t\t\t\t: 'group-hover:bg-gray-100 dark:group-hover:bg-gray-950'}  whitespace-nowrap text-ellipsis relative {generating\n\t\t\t\t? 'cursor-not-allowed'\n\t\t\t\t: ''}\"\n\t\t>\n\t\t\t<input\n\t\t\t\tid=\"chat-title-input-{id}\"\n\t\t\t\tbind:value={chatTitle}\n\t\t\t\tclass=\" bg-transparent w-full outline-hidden mr-10\"\n\t\t\t\tplaceholder={generating ? $i18n.t('Generating...') : ''}\n\t\t\t\tdisabled={generating}\n\t\t\t\ton:keydown={chatTitleInputKeydownHandler}\n\t\t\t\ton:blur={async (e) => {\n\t\t\t\t\tif (doubleClicked) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tconst input = document.getElementById(`chat-title-input-${id}`);\n\t\t\t\t\t\t\tif (input) input.focus();\n\t\t\t\t\t\t}, 0);\n\n\t\t\t\t\t\tdoubleClicked = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t{:else}\n\t\t<a\n\t\t\tid=\"sidebar-chat-item\"\n\t\t\tclass=\" w-full flex justify-between rounded-xl px-[11px] py-[6px] {id === $chatId ||\n\t\t\tconfirmEdit\n\t\t\t\t? 'bg-gray-100 dark:bg-gray-900 selected'\n\t\t\t\t: selected\n\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-950 selected'\n\t\t\t\t\t: ' group-hover:bg-gray-100 dark:group-hover:bg-gray-950'}  whitespace-nowrap text-ellipsis\"\n\t\t\thref=\"/c/{id}\"\n\t\t\ton:click={() => {\n\t\t\t\tdispatch('select');\n\n\t\t\t\tif ($selectedFolder) {\n\t\t\t\t\tselectedFolder.set(null);\n\t\t\t\t}\n\n\t\t\t\tif ($mobile) {\n\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t}\n\t\t\t}}\n\t\t\ton:dblclick={async (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\n\t\t\t\tdoubleClicked = true;\n\t\t\t\trenameHandler();\n\t\t\t}}\n\t\t\ton:mouseenter={(e) => {\n\t\t\t\tmouseOver = true;\n\t\t\t}}\n\t\t\ton:mouseleave={(e) => {\n\t\t\t\tmouseOver = false;\n\t\t\t}}\n\t\t\ton:focus={(e) => {}}\n\t\t\tdraggable=\"false\"\n\t\t>\n\t\t\t<div class=\" flex self-center flex-1 w-full\">\n\t\t\t\t<div dir=\"auto\" class=\" text-left self-center overflow-hidden w-full h-[20px] truncate\">\n\t\t\t\t\t{title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</a>\n\t{/if}\n\n\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t<div\n\t\tid=\"sidebar-chat-item-menu\"\n\t\tclass=\"\n        {id === $chatId || confirmEdit\n\t\t\t? 'from-gray-100 dark:from-gray-900 selected'\n\t\t\t: selected\n\t\t\t\t? 'from-gray-100 dark:from-gray-950 selected'\n\t\t\t\t: 'invisible group-hover:visible from-gray-100 dark:from-gray-950'}\n            absolute {className === 'pr-2'\n\t\t\t? 'right-[8px]'\n\t\t\t: 'right-1'} top-[4px] py-1 pr-0.5 mr-1.5 pl-5 bg-linear-to-l from-80%\n\n              to-transparent\"\n\t\ton:mouseenter={(e) => {\n\t\t\tmouseOver = true;\n\t\t}}\n\t\ton:mouseleave={(e) => {\n\t\t\tmouseOver = false;\n\t\t}}\n\t>\n\t\t{#if confirmEdit}\n\t\t\t<div\n\t\t\t\tclass=\"flex self-center items-center space-x-1.5 z-10 translate-y-[0.5px] -translate-x-[0.5px]\"\n\t\t\t>\n\t\t\t\t<Tooltip content={$i18n.t('Generate')}>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition disabled:cursor-not-allowed\"\n\t\t\t\t\t\tid=\"generate-title-button\"\n\t\t\t\t\t\tdisabled={generating}\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tgenerateTitleHandler();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Sparkles strokeWidth=\"2\" />\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\t\t{:else if shiftKey && mouseOver}\n\t\t\t<div class=\" flex items-center self-center space-x-1.5\">\n\t\t\t\t<Tooltip content={$i18n.t('Archive')} className=\"flex items-center\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tarchiveChatHandler(id);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ArchiveBox className=\"size-4  translate-y-[0.5px]\" strokeWidth=\"2\" />\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\n\t\t\t\t<Tooltip content={$i18n.t('Delete')}>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdeleteChatHandler(id);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<GarbageBin strokeWidth=\"2\" />\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex self-center z-10 items-end\">\n\t\t\t\t<ChatMenu\n\t\t\t\t\tchatId={id}\n\t\t\t\t\tcloneChatHandler={() => {\n\t\t\t\t\t\tcloneChatHandler(id);\n\t\t\t\t\t}}\n\t\t\t\t\tshareHandler={() => {\n\t\t\t\t\t\tshowShareChatModal = true;\n\t\t\t\t\t}}\n\t\t\t\t\t{moveChatHandler}\n\t\t\t\t\tarchiveChatHandler={() => {\n\t\t\t\t\t\tarchiveChatHandler(id);\n\t\t\t\t\t}}\n\t\t\t\t\t{renameHandler}\n\t\t\t\t\tdeleteHandler={() => {\n\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t}}\n\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\tdispatch('unselect');\n\t\t\t\t\t}}\n\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\tdispatch('change');\n\t\t\t\t\t}}\n\t\t\t\t\ton:tag={(e) => {\n\t\t\t\t\t\tdispatch('tag', e.detail);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-label=\"Chat Menu\"\n\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition m-0\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdispatch('select');\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M2 8a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM6.5 8a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM12.5 6.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</ChatMenu>\n\n\t\t\t\t{#if id === $chatId}\n\t\t\t\t\t<!-- Shortcut support using \"delete-chat-button\" id -->\n\t\t\t\t\t<button\n\t\t\t\t\t\tid=\"delete-chat-button\"\n\t\t\t\t\t\tclass=\"hidden\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M2 8a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM6.5 8a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM12.5 6.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { getContext, createEventDispatcher, onMount, onDestroy } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\timport ChevronDown from '../icons/ChevronDown.svelte';\n\timport ChevronRight from '../icons/ChevronRight.svelte';\n\timport Collapsible from './Collapsible.svelte';\n\timport Tooltip from './Tooltip.svelte';\n\timport Plus from '../icons/Plus.svelte';\n\n\texport let open = true;\n\n\texport let id = '';\n\texport let name = '';\n\texport let collapsible = true;\n\n\texport let className = '';\n\texport let buttonClassName = 'text-gray-600 dark:text-gray-400';\n\n\texport let chevron = true;\n\texport let onAddLabel: string = '';\n\texport let onAdd: null | Function = null;\n\n\texport let dragAndDrop = true;\n\n\tlet folderElement;\n\tlet loaded = false;\n\n\tlet draggedOver = false;\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tdraggedOver = true;\n\t};\n\n\tconst onDrop = (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tif (folderElement.contains(e.target)) {\n\t\t\tconsole.log('Dropped on the Button');\n\n\t\t\tif (e.dataTransfer.items && e.dataTransfer.items.length > 0) {\n\t\t\t\t// Iterate over all items in the DataTransferItemList use functional programming\n\t\t\t\tfor (const item of Array.from(e.dataTransfer.items)) {\n\t\t\t\t\t// If dropped items aren't files, reject them\n\t\t\t\t\tif (item.kind === 'file') {\n\t\t\t\t\t\tconst file = item.getAsFile();\n\t\t\t\t\t\tif (file && file.type === 'application/json') {\n\t\t\t\t\t\t\tconsole.log('Dropped file is a JSON file!');\n\n\t\t\t\t\t\t\t// Read the JSON file with FileReader\n\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\treader.onload = async function (event) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tconst fileContent = JSON.parse(event.target.result);\n\t\t\t\t\t\t\t\t\tconsole.log('Parsed JSON Content: ', fileContent);\n\t\t\t\t\t\t\t\t\topen = true;\n\t\t\t\t\t\t\t\t\tdispatch('import', fileContent);\n\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\tconsole.error('Error parsing JSON file:', error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// Start reading the file\n\t\t\t\t\t\t\treader.readAsText(file);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error('Only JSON file types are supported.');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\topen = true;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst dataTransfer = e.dataTransfer.getData('text/plain');\n\t\t\t\t\t\t\tif (dataTransfer) {\n\t\t\t\t\t\t\t\tconst data = JSON.parse(dataTransfer);\n\t\t\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\t\t\tdispatch('drop', data);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.log('Dropped text data is empty or not text/plain.');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'Dropped data is not valid JSON text or is empty. Ignoring drop event for this type of data.'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tdraggedOver = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tdraggedOver = false;\n\t};\n\n\tonMount(() => {\n\t\tconst state = localStorage.getItem(`${id}-folder-state`);\n\t\tif (state !== null) {\n\t\t\topen = state === 'true';\n\t\t}\n\n\t\tloaded = true;\n\n\t\tif (!dragAndDrop) {\n\t\t\treturn;\n\t\t}\n\t\tfolderElement.addEventListener('dragover', onDragOver);\n\t\tfolderElement.addEventListener('drop', onDrop);\n\t\tfolderElement.addEventListener('dragleave', onDragLeave);\n\t});\n\n\tonDestroy(() => {\n\t\tif (!dragAndDrop) {\n\t\t\treturn;\n\t\t}\n\t\tfolderElement.removeEventListener('dragover', onDragOver);\n\t\tfolderElement.removeEventListener('drop', onDrop);\n\t\tfolderElement.removeEventListener('dragleave', onDragLeave);\n\t});\n</script>\n\n<div bind:this={folderElement} class=\"relative {className}\">\n\t{#if loaded}\n\t\t{#if draggedOver}\n\t\t\t<div\n\t\t\t\tclass=\"absolute top-0 left-0 w-full h-full rounded-xs bg-gray-100/50 dark:bg-gray-700/20 bg-opacity-50 dark:bg-opacity-10 z-50 pointer-events-none touch-none\"\n\t\t\t></div>\n\t\t{/if}\n\n\t\t{#if collapsible}\n\t\t\t<Collapsible\n\t\t\t\tbind:open\n\t\t\t\tclassName=\"w-full \"\n\t\t\t\tbuttonClassName=\"w-full\"\n\t\t\t\tonChange={(state) => {\n\t\t\t\t\tdispatch('change', state);\n\t\t\t\t\tlocalStorage.setItem(`${id}-folder-state`, `${state}`);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t\t\t\t<div\n\t\t\t\t\tid=\"sidebar-folder-button\"\n\t\t\t\t\tclass=\" w-full group rounded-xl relative flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-900 transition {buttonClassName}\"\n\t\t\t\t>\n\t\t\t\t\t<button class=\"w-full py-1.5 pl-2 flex items-center gap-1.5 text-xs font-medium\">\n\t\t\t\t\t\t{#if chevron}\n\t\t\t\t\t\t\t<div class=\" p-[1px]\">\n\t\t\t\t\t\t\t\t{#if open}\n\t\t\t\t\t\t\t\t\t<ChevronDown className=\" size-3\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<ChevronRight className=\" size-3\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<div class=\"translate-y-[0.5px] {chevron ? '' : 'pl-0.5'}\">\n\t\t\t\t\t\t\t{name}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t{#if onAdd}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"absolute z-10 right-2 invisible group-hover:visible self-center flex items-center dark:text-gray-300\"\n\t\t\t\t\t\t\ton:pointerup={(e) => {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tonAdd();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Tooltip content={onAddLabel}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"p-0.5 dark:hover:bg-gray-850 rounded-lg touch-auto\"\n\t\t\t\t\t\t\t\t\ton:click={(e) => {}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<div slot=\"content\" class=\"w-full\">\n\t\t\t\t\t<slot></slot>\n\t\t\t\t</div>\n\t\t\t</Collapsible>\n\t\t{:else}\n\t\t\t<slot></slot>\n\t\t{/if}\n\t{/if}\n</div>\n","<script>\n\timport { getContext, createEventDispatcher, onMount, onDestroy, tick } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\timport DOMPurify from 'dompurify';\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\timport { goto } from '$app/navigation';\n\timport { toast } from 'svelte-sonner';\n\n\timport { chatId, mobile, selectedFolder, showSidebar } from '$lib/stores';\n\n\timport {\n\t\tdeleteFolderById,\n\t\tupdateFolderIsExpandedById,\n\t\tupdateFolderById,\n\t\tupdateFolderParentIdById,\n\t\tgetFolderById\n\t} from '$lib/apis/folders';\n\timport {\n\t\tgetChatById,\n\t\tgetChatsByFolderId,\n\t\tgetChatListByFolderId,\n\t\tupdateChatFolderIdById,\n\t\timportChats\n\t} from '$lib/apis/chats';\n\n\timport ChevronDown from '../../icons/ChevronDown.svelte';\n\timport ChevronRight from '../../icons/ChevronRight.svelte';\n\timport Collapsible from '../../common/Collapsible.svelte';\n\timport DragGhost from '$lib/components/common/DragGhost.svelte';\n\n\timport FolderOpen from '$lib/components/icons/FolderOpen.svelte';\n\timport EllipsisHorizontal from '$lib/components/icons/EllipsisHorizontal.svelte';\n\n\timport ChatItem from './ChatItem.svelte';\n\timport FolderMenu from './Folders/FolderMenu.svelte';\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport FolderModal from './Folders/FolderModal.svelte';\n\timport Emoji from '$lib/components/common/Emoji.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\n\texport let folderRegistry = {};\n\texport let open = false;\n\n\texport let folders;\n\texport let folderId;\n\texport let shiftKey = false;\n\n\texport let className = '';\n\n\texport let deleteFolderContents = true;\n\n\texport let parentDragged = false;\n\n\texport let onDelete = (e) => {};\n\texport let onItemMove = (e) => {};\n\n\tlet folderElement;\n\n\tlet showFolderModal = false;\n\tlet edit = false;\n\n\tlet draggedOver = false;\n\tlet dragged = false;\n\n\tlet clickTimer = null;\n\n\tlet name = '';\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tif (dragged || parentDragged) {\n\t\t\treturn;\n\t\t}\n\t\tdraggedOver = true;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tif (dragged || parentDragged) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (folderElement.contains(e.target)) {\n\t\t\tconsole.log('Dropped on the Button');\n\n\t\t\tif (e.dataTransfer.items && e.dataTransfer.items.length > 0) {\n\t\t\t\t// Iterate over all items in the DataTransferItemList use functional programming\n\t\t\t\tfor (const item of Array.from(e.dataTransfer.items)) {\n\t\t\t\t\t// If dropped items aren't files, reject them\n\t\t\t\t\tif (item.kind === 'file') {\n\t\t\t\t\t\tconst file = item.getAsFile();\n\t\t\t\t\t\tif (file && file.type === 'application/json') {\n\t\t\t\t\t\t\tconsole.log('Dropped file is a JSON file!');\n\n\t\t\t\t\t\t\t// Read the JSON file with FileReader\n\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\treader.onload = async function (event) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tconst fileContent = JSON.parse(event.target.result);\n\t\t\t\t\t\t\t\t\topen = true;\n\t\t\t\t\t\t\t\t\tdispatch('import', {\n\t\t\t\t\t\t\t\t\t\tfolderId: folderId,\n\t\t\t\t\t\t\t\t\t\titems: fileContent\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\tconsole.error('Error parsing JSON file:', error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// Start reading the file\n\t\t\t\t\t\t\treader.readAsText(file);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error('Only JSON file types are supported.');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconsole.log(file);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Handle the drag-and-drop data for folders or chats (same as before)\n\t\t\t\t\t\tconst dataTransfer = e.dataTransfer.getData('text/plain');\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst data = JSON.parse(dataTransfer);\n\t\t\t\t\t\t\tconsole.log(data);\n\n\t\t\t\t\t\t\tconst { type, id, item } = data;\n\n\t\t\t\t\t\t\tif (type === 'folder') {\n\t\t\t\t\t\t\t\topen = true;\n\t\t\t\t\t\t\t\tif (id === folderId) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Move the folder\n\t\t\t\t\t\t\t\tconst res = await updateFolderParentIdById(localStorage.token, id, folderId).catch(\n\t\t\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\t\tdispatch('update');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (type === 'chat') {\n\t\t\t\t\t\t\t\topen = true;\n\n\t\t\t\t\t\t\t\tlet chat = await getChatById(localStorage.token, id).catch((error) => {\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (!chat && item) {\n\t\t\t\t\t\t\t\t\tchat = await importChats(localStorage.token, [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tchat: item.chat,\n\t\t\t\t\t\t\t\t\t\t\tmeta: item?.meta ?? {},\n\t\t\t\t\t\t\t\t\t\t\tpinned: false,\n\t\t\t\t\t\t\t\t\t\t\tfolder_id: null,\n\t\t\t\t\t\t\t\t\t\t\tcreated_at: item?.created_at ?? null,\n\t\t\t\t\t\t\t\t\t\t\tupdated_at: item?.updated_at ?? null\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]).catch((error) => {\n\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Move the chat\n\t\t\t\t\t\t\t\tconst res = await updateChatFolderIdById(\n\t\t\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\t\t\tchat.id,\n\t\t\t\t\t\t\t\t\tfolderId\n\t\t\t\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tonItemMove({\n\t\t\t\t\t\t\t\t\toriginFolderId: chat.folder_id,\n\t\t\t\t\t\t\t\t\ttargetFolderId: folderId,\n\t\t\t\t\t\t\t\t\te\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\t\tdispatch('update');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('Error parsing dataTransfer:', error);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetFolderItems();\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = (e) => {\n\t\te.preventDefault();\n\t\tif (dragged || parentDragged) {\n\t\t\treturn;\n\t\t}\n\n\t\tdraggedOver = false;\n\t};\n\n\tconst dragImage = new Image();\n\tdragImage.src =\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n\n\tlet x;\n\tlet y;\n\n\tconst onDragStart = (event) => {\n\t\tevent.stopPropagation();\n\t\tevent.dataTransfer.setDragImage(dragImage, 0, 0);\n\n\t\t// Set the data to be transferred\n\t\tevent.dataTransfer.setData(\n\t\t\t'text/plain',\n\t\t\tJSON.stringify({\n\t\t\t\ttype: 'folder',\n\t\t\t\tid: folderId\n\t\t\t})\n\t\t);\n\n\t\tdragged = true;\n\t\tfolderElement.style.opacity = '0.5'; // Optional: Visual cue to show it's being dragged\n\t};\n\n\tconst onDrag = (event) => {\n\t\tevent.stopPropagation();\n\n\t\tx = event.clientX;\n\t\ty = event.clientY;\n\t};\n\n\tconst onDragEnd = (event) => {\n\t\tevent.stopPropagation();\n\n\t\tfolderElement.style.opacity = '1'; // Reset visual cue after drag\n\t\tdragged = false;\n\t};\n\n\tonMount(async () => {\n\t\topen = folders[folderId].is_expanded;\n\t\tfolderRegistry[folderId] = {\n\t\t\tsetFolderItems: () => {\n\t\t\t\tsetFolderItems();\n\t\t\t}\n\t\t};\n\t\tif (folderElement) {\n\t\t\tfolderElement.addEventListener('dragover', onDragOver);\n\t\t\tfolderElement.addEventListener('drop', onDrop);\n\t\t\tfolderElement.addEventListener('dragleave', onDragLeave);\n\n\t\t\t// Event listener for when dragging starts\n\t\t\tfolderElement.addEventListener('dragstart', onDragStart);\n\t\t\t// Event listener for when dragging occurs (optional)\n\t\t\tfolderElement.addEventListener('drag', onDrag);\n\t\t\t// Event listener for when dragging ends\n\t\t\tfolderElement.addEventListener('dragend', onDragEnd);\n\t\t}\n\n\t\tif (folders[folderId]?.new) {\n\t\t\tdelete folders[folderId].new;\n\t\t\tawait tick();\n\t\t\trenameHandler();\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (folderElement) {\n\t\t\tfolderElement.addEventListener('dragover', onDragOver);\n\t\t\tfolderElement.removeEventListener('drop', onDrop);\n\t\t\tfolderElement.removeEventListener('dragleave', onDragLeave);\n\n\t\t\tfolderElement.removeEventListener('dragstart', onDragStart);\n\t\t\tfolderElement.removeEventListener('drag', onDrag);\n\t\t\tfolderElement.removeEventListener('dragend', onDragEnd);\n\t\t}\n\t});\n\n\tlet showDeleteConfirm = false;\n\n\tconst deleteHandler = async () => {\n\t\tconst res = await deleteFolderById(localStorage.token, folderId, deleteFolderContents).catch(\n\t\t\t(error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t);\n\n\t\tif (res) {\n\t\t\ttoast.success($i18n.t('Folder deleted successfully'));\n\t\t\tonDelete(folderId);\n\t\t}\n\t};\n\n\tconst updateHandler = async ({ name, meta, data }) => {\n\t\tif (name === '') {\n\t\t\ttoast.error($i18n.t('Folder name cannot be empty.'));\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentName = folders[folderId].name;\n\n\t\tname = name.trim();\n\t\tfolders[folderId].name = name;\n\n\t\tconst res = await updateFolderById(localStorage.token, folderId, {\n\t\t\tname,\n\t\t\t...(meta ? { meta } : {}),\n\t\t\t...(data ? { data } : {})\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\n\t\t\tfolders[folderId].name = currentName;\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tfolders[folderId].name = name;\n\t\t\tif (data) {\n\t\t\t\tfolders[folderId].data = data;\n\t\t\t}\n\n\t\t\t// toast.success($i18n.t('Folder name updated successfully'));\n\t\t\ttoast.success($i18n.t('Folder updated successfully'));\n\n\t\t\tif ($selectedFolder?.id === folderId) {\n\t\t\t\tconst folder = await getFolderById(localStorage.token, folderId).catch((error) => {\n\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\treturn null;\n\t\t\t\t});\n\n\t\t\t\tif (folder) {\n\t\t\t\t\tawait selectedFolder.set(folder);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdispatch('update');\n\t\t}\n\t};\n\n\tconst isExpandedUpdateHandler = async () => {\n\t\tconst res = await updateFolderIsExpandedById(localStorage.token, folderId, open).catch(\n\t\t\t(error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t);\n\t};\n\n\tlet isExpandedUpdateTimeout;\n\n\tconst isExpandedUpdateDebounceHandler = () => {\n\t\tclearTimeout(isExpandedUpdateTimeout);\n\t\tisExpandedUpdateTimeout = setTimeout(() => {\n\t\t\tisExpandedUpdateHandler();\n\t\t}, 500);\n\t};\n\n\tlet chats = null;\n\texport const setFolderItems = async () => {\n\t\tawait tick();\n\t\tif (open) {\n\t\t\tchats = await getChatListByFolderId(localStorage.token, folderId).catch((error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn [];\n\t\t\t});\n\t\t} else {\n\t\t\tchats = null;\n\t\t}\n\t};\n\n\t$: if (open) {\n\t\tsetFolderItems();\n\t}\n\n\tconst renameHandler = async () => {\n\t\tconsole.log('Edit');\n\t\tawait tick();\n\t\tname = folders[folderId].name;\n\t\tedit = true;\n\n\t\tawait tick();\n\t\tawait tick();\n\n\t\tconst input = document.getElementById(`folder-${folderId}-input`);\n\t\tif (input) {\n\t\t\tinput.focus();\n\t\t\tinput.select();\n\t\t}\n\t};\n\n\tconst exportHandler = async () => {\n\t\tconst chats = await getChatsByFolderId(localStorage.token, folderId).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\t\tif (!chats) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst blob = new Blob([JSON.stringify(chats)], {\n\t\t\ttype: 'application/json'\n\t\t});\n\n\t\tsaveAs(blob, `folder-${folders[folderId].name}-export-${Date.now()}.json`);\n\t};\n</script>\n\n<DeleteConfirmDialog\n\tbind:show={showDeleteConfirm}\n\ttitle={$i18n.t('Delete folder?')}\n\ton:confirm={() => {\n\t\tdeleteHandler();\n\t}}\n>\n\t<div class=\" text-sm text-gray-700 dark:text-gray-300 flex-1 line-clamp-3 mb-2\">\n\t\t<!-- {$i18n.t('This will delete <strong>{{NAME}}</strong> and <strong>all its contents</strong>.', {\n\t\t\t\tNAME: folders[folderId].name\n\t\t\t})} -->\n\n\t\t{$i18n.t(`Are you sure you want to delete \"{{NAME}}\"?`, {\n\t\t\tNAME: folders[folderId].name\n\t\t})}\n\t</div>\n\n\t<div class=\"flex items-center gap-1.5\">\n\t\t<input type=\"checkbox\" bind:checked={deleteFolderContents} />\n\n\t\t<div class=\"text-xs text-gray-500\">\n\t\t\t{$i18n.t('Delete all contents inside this folder')}\n\t\t</div>\n\t</div>\n</DeleteConfirmDialog>\n\n<FolderModal bind:show={showFolderModal} edit={true} {folderId} onSubmit={updateHandler} />\n\n{#if dragged && x && y}\n\t<DragGhost {x} {y}>\n\t\t<div class=\" bg-black/80 backdrop-blur-2xl px-2 py-1 rounded-lg w-fit max-w-40\">\n\t\t\t<div class=\"flex items-center gap-1\">\n\t\t\t\t<FolderOpen className=\"size-3.5\" strokeWidth=\"2\" />\n\t\t\t\t<div class=\" text-xs text-white line-clamp-1\">\n\t\t\t\t\t{folders[folderId].name}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</DragGhost>\n{/if}\n\n<div bind:this={folderElement} class=\"relative {className}\" draggable=\"true\">\n\t{#if draggedOver}\n\t\t<div\n\t\t\tclass=\"absolute top-0 left-0 w-full h-full rounded-xs bg-gray-100/50 dark:bg-gray-700/20 bg-opacity-50 dark:bg-opacity-10 z-50 pointer-events-none touch-none\"\n\t\t></div>\n\t{/if}\n\n\t<Collapsible\n\t\tbind:open\n\t\tclassName=\"w-full\"\n\t\tbuttonClassName=\"w-full\"\n\t\tonChange={(state) => {\n\t\t\tdispatch('open', state);\n\t\t}}\n\t>\n\t\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t\t<div class=\"w-full group\">\n\t\t\t<div\n\t\t\t\tid=\"folder-{folderId}-button\"\n\t\t\t\tclass=\"relative w-full py-1 px-1.5 rounded-xl flex items-center gap-1.5 hover:bg-gray-100 dark:hover:bg-gray-900 transition {$selectedFolder?.id ===\n\t\t\t\tfolderId\n\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-900 selected'\n\t\t\t\t\t: ''}\"\n\t\t\t\ton:dblclick={(e) => {\n\t\t\t\t\tif (clickTimer) {\n\t\t\t\t\t\tclearTimeout(clickTimer); // cancel the single-click action\n\t\t\t\t\t\tclickTimer = null;\n\t\t\t\t\t}\n\t\t\t\t\trenameHandler();\n\t\t\t\t}}\n\t\t\t\ton:click={async (e) => {\n\t\t\t\t\t(e) => e.stopPropagation();\n\t\t\t\t\tif (clickTimer) {\n\t\t\t\t\t\tclearTimeout(clickTimer);\n\t\t\t\t\t\tclickTimer = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tclickTimer = setTimeout(async () => {\n\t\t\t\t\t\tconst folder = await getFolderById(localStorage.token, folderId).catch((error) => {\n\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (folder) {\n\t\t\t\t\t\t\tawait selectedFolder.set(folder);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tawait goto('/');\n\n\t\t\t\t\t\tif ($mobile) {\n\t\t\t\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclickTimer = null;\n\t\t\t\t\t}, 100); // 100ms delay (typical double-click threshold)\n\t\t\t\t}}\n\t\t\t\ton:pointerup={(e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"text-gray-500 dark:text-gray-500 transition-all p-1 hover:bg-gray-200 dark:hover:bg-gray-850 rounded-lg\"\n\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\topen = !open;\n\t\t\t\t\t\tisExpandedUpdateDebounceHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{#if folders[folderId]?.meta?.icon}\n\t\t\t\t\t\t<div class=\"flex group-hover:hidden transition-all\">\n\t\t\t\t\t\t\t<Emoji className=\"size-3.5\" shortCode={folders[folderId].meta.icon} />\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"hidden group-hover:flex transition-all p-[1px]\">\n\t\t\t\t\t\t\t{#if open}\n\t\t\t\t\t\t\t\t<ChevronDown className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<ChevronRight className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div class=\"p-[1px]\">\n\t\t\t\t\t\t\t{#if open}\n\t\t\t\t\t\t\t\t<ChevronDown className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<ChevronRight className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</button>\n\n\t\t\t\t<div class=\"translate-y-[0.5px] flex-1 justify-start text-start line-clamp-1\">\n\t\t\t\t\t{#if edit}\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"folder-{folderId}-input\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tbind:value={name}\n\t\t\t\t\t\t\ton:blur={() => {\n\t\t\t\t\t\t\t\tconsole.log('Blur');\n\t\t\t\t\t\t\t\tupdateHandler({ name });\n\t\t\t\t\t\t\t\tedit = false;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\t\t// Prevent accidental collapse toggling when clicking inside input\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:mousedown={(e) => {\n\t\t\t\t\t\t\t\t// Prevent accidental collapse toggling when clicking inside input\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:keydown={(e) => {\n\t\t\t\t\t\t\t\tif (e.key === 'Enter') {\n\t\t\t\t\t\t\t\t\tupdateHandler({ name });\n\t\t\t\t\t\t\t\t\tedit = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclass=\"w-full h-full bg-transparent outline-hidden\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{folders[folderId].name}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<button\n\t\t\t\t\tclass=\"absolute z-10 right-2 invisible group-hover:visible self-center flex items-center dark:text-gray-300\"\n\t\t\t\t>\n\t\t\t\t\t<FolderMenu\n\t\t\t\t\t\tonEdit={() => {\n\t\t\t\t\t\t\tshowFolderModal = true;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonDelete={() => {\n\t\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonExport={() => {\n\t\t\t\t\t\t\texportHandler();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"p-1 dark:hover:bg-gray-850 rounded-lg touch-auto\">\n\t\t\t\t\t\t\t<EllipsisHorizontal className=\"size-4\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</FolderMenu>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div slot=\"content\" class=\"w-full\">\n\t\t\t{#if (folders[folderId]?.childrenIds ?? []).length > 0 || (chats ?? []).length > 0}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ml-3 pl-1 mt-[1px] flex flex-col overflow-y-auto scrollbar-hidden border-s border-gray-100 dark:border-gray-900\"\n\t\t\t\t>\n\t\t\t\t\t{#if folders[folderId]?.childrenIds}\n\t\t\t\t\t\t{@const children = folders[folderId]?.childrenIds\n\t\t\t\t\t\t\t.map((id) => folders[id])\n\t\t\t\t\t\t\t.sort((a, b) =>\n\t\t\t\t\t\t\t\ta.name.localeCompare(b.name, undefined, {\n\t\t\t\t\t\t\t\t\tnumeric: true,\n\t\t\t\t\t\t\t\t\tsensitivity: 'base'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{#each children as childFolder (`${folderId}-${childFolder.id}`)}\n\t\t\t\t\t\t\t<svelte:self\n\t\t\t\t\t\t\t\tbind:folderRegistry\n\t\t\t\t\t\t\t\t{folders}\n\t\t\t\t\t\t\t\tfolderId={childFolder.id}\n\t\t\t\t\t\t\t\t{shiftKey}\n\t\t\t\t\t\t\t\tparentDragged={dragged}\n\t\t\t\t\t\t\t\t{onItemMove}\n\t\t\t\t\t\t\t\t{onDelete}\n\t\t\t\t\t\t\t\ton:import={(e) => {\n\t\t\t\t\t\t\t\t\tdispatch('import', e.detail);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:update={(e) => {\n\t\t\t\t\t\t\t\t\tdispatch('update', e.detail);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\t\t\tdispatch('change', e.detail);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#each chats ?? [] as chat (chat.id)}\n\t\t\t\t\t\t<ChatItem\n\t\t\t\t\t\t\tid={chat.id}\n\t\t\t\t\t\t\ttitle={chat.title}\n\t\t\t\t\t\t\t{shiftKey}\n\t\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\t\tdispatch('change', e.detail);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t{#if chats === null}\n\t\t\t\t<div class=\"flex justify-center items-center p-2\">\n\t\t\t\t\t<Spinner className=\"size-4 text-gray-500\" />\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</Collapsible>\n</div>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from 'svelte';\n\tconst dispatch = createEventDispatcher();\n\n\timport RecursiveFolder from './RecursiveFolder.svelte';\n\timport { chatId, selectedFolder } from '$lib/stores';\n\n\texport let folderRegistry = {};\n\n\texport let folders = {};\n\texport let shiftKey = false;\n\n\texport let onDelete = (folderId) => {};\n\n\tlet folderList = [];\n\t// Get the list of folders that have no parent, sorted by name alphabetically\n\t$: folderList = Object.keys(folders)\n\t\t.filter((key) => folders[key].parent_id === null)\n\t\t.sort((a, b) =>\n\t\t\tfolders[a].name.localeCompare(folders[b].name, undefined, {\n\t\t\t\tnumeric: true,\n\t\t\t\tsensitivity: 'base'\n\t\t\t})\n\t\t);\n\n\tconst onItemMove = (e) => {\n\t\tif (e.originFolderId) {\n\t\t\tfolderRegistry[e.originFolderId]?.setFolderItems();\n\t\t}\n\t};\n\n\tconst loadFolderItems = () => {\n\t\tfor (const folderId of Object.keys(folders)) {\n\t\t\tfolderRegistry[folderId]?.setFolderItems();\n\t\t}\n\t};\n\n\t$: if (folders || ($selectedFolder && $chatId)) {\n\t\tloadFolderItems();\n\t}\n</script>\n\n{#each folderList as folderId (folderId)}\n\t<RecursiveFolder\n\t\tclassName=\"\"\n\t\tbind:folderRegistry\n\t\t{folders}\n\t\t{folderId}\n\t\t{shiftKey}\n\t\t{onDelete}\n\t\t{onItemMove}\n\t\ton:import={(e) => {\n\t\t\tdispatch('import', e.detail);\n\t\t}}\n\t\ton:update={(e) => {\n\t\t\tdispatch('update', e.detail);\n\t\t}}\n\t\ton:change={(e) => {\n\t\t\tdispatch('change', e.detail);\n\t\t}}\n\t/>\n{/each}\n","<script lang=\"ts\">\n\timport { getContext, onMount } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let onChange: Function = () => {};\n\texport let state = 'private';\n</script>\n\n<div class=\" rounded-lg flex flex-col gap-2\">\n\t<div class=\"\">\n\t\t<div class=\" text-xs font-medium mb-2.5 text-gray-500\">{$i18n.t('Visibility')}</div>\n\n\t\t<div class=\"flex gap-2.5 items-center mb-1\">\n\t\t\t<div>\n\t\t\t\t<div class=\" p-2 bg-black/5 dark:bg-white/5 rounded-full\">\n\t\t\t\t\t{#if state === 'private'}\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\td=\"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\td=\"M6.115 5.19l.319 1.913A6 6 0 008.11 10.36L9.75 12l-.387.775c-.217.433-.132.956.21 1.298l1.348 1.348c.21.21.329.497.329.795v1.089c0 .426.24.815.622 1.006l.153.076c.433.217.956.132 1.298-.21l.723-.723a8.7 8.7 0 002.288-4.042 1.087 1.087 0 00-.358-1.099l-1.33-1.108c-.251-.21-.582-.299-.905-.245l-1.17.195a1.125 1.125 0 01-.98-.314l-.295-.295a1.125 1.125 0 010-1.591l.13-.132a1.125 1.125 0 011.3-.21l.603.302a.809.809 0 001.086-1.086L14.25 7.5l1.256-.837a4.5 4.5 0 001.528-1.732l.146-.292M6.115 5.19A9 9 0 1017.18 4.64M6.115 5.19A8.965 8.965 0 0112 3c1.929 0 3.716.607 5.18 1.64\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<select\n\t\t\t\t\tid=\"models\"\n\t\t\t\t\tclass=\"outline-hidden bg-transparent text-sm font-medium block w-fit pr-10 max-w-full placeholder-gray-400\"\n\t\t\t\t\tvalue={state === 'private' ? 'private' : 'public'}\n\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\tif (e.target.value === 'public') {\n\t\t\t\t\t\t\tstate = 'public';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstate = 'private';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange(state);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<option class=\" text-gray-700\" value=\"public\" selected>{$i18n.t('Public')}</option>\n\t\t\t\t\t<option class=\" text-gray-700\" value=\"private\" selected>{$i18n.t('Private')}</option>\n\t\t\t\t</select>\n\n\t\t\t\t<div class=\" text-xs text-gray-400 font-medium\">\n\t\t\t\t\t{#if state === 'private'}\n\t\t\t\t\t\t{$i18n.t('Only invited users can access')}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{$i18n.t('Visible to all users')}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { getContext } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { WEBUI_API_BASE_URL, WEBUI_BASE_URL } from '$lib/constants';\n\n\timport ChevronDown from '$lib/components/icons/ChevronDown.svelte';\n\timport Clipboard from '$lib/components/icons/Clipboard.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\n\timport { toast } from 'svelte-sonner';\n\timport dayjs from 'dayjs';\n\n\texport let webhook;\n\texport let expanded = false;\n\n\texport let onClick = () => {};\n\texport let onDelete = () => {};\n\texport let onUpdate = (changes: { name: string; profile_image_url: string }) => {};\n\n\tlet name = webhook.name;\n\tlet image = webhook.profile_image_url || '';\n\n\t// Notify parent when changes occur\n\t$: if (name !== webhook.name || image !== (webhook.profile_image_url || '')) {\n\t\tonUpdate({ name: name.trim() || webhook.name, profile_image_url: image });\n\t}\n\n\tlet filesInputElement;\n\tlet inputFiles;\n\n\tconst handleImageUpload = () => {\n\t\tif (!inputFiles?.length) return;\n\n\t\tconst reader = new FileReader();\n\t\treader.onload = (event) => {\n\t\t\tconst dataUrl = `${event.target?.result}`;\n\t\t\tconst fileType = inputFiles[0]?.type;\n\n\t\t\tif (['image/gif', 'image/webp'].includes(fileType)) {\n\t\t\t\timage = dataUrl;\n\t\t\t} else {\n\t\t\t\tconst tempImage = new Image();\n\t\t\t\ttempImage.src = dataUrl;\n\t\t\t\ttempImage.onload = () => {\n\t\t\t\t\tconst canvas = document.createElement('canvas');\n\t\t\t\t\tconst canvasSize = 100;\n\t\t\t\t\tcanvas.width = canvasSize;\n\t\t\t\t\tcanvas.height = canvasSize;\n\n\t\t\t\t\tconst context = canvas.getContext('2d');\n\t\t\t\t\tconst aspectRatio = tempImage.width / tempImage.height;\n\t\t\t\t\tconst scaledWidth = aspectRatio > 1 ? canvasSize * aspectRatio : canvasSize;\n\t\t\t\t\tconst scaledHeight = aspectRatio > 1 ? canvasSize : canvasSize / aspectRatio;\n\t\t\t\t\tconst offsetX = (canvasSize - scaledWidth) / 2;\n\t\t\t\t\tconst offsetY = (canvasSize - scaledHeight) / 2;\n\n\t\t\t\t\tcontext.drawImage(tempImage, offsetX, offsetY, scaledWidth, scaledHeight);\n\t\t\t\t\timage = canvas.toDataURL('image/webp', 0.8);\n\t\t\t\t};\n\t\t\t}\n\t\t\tinputFiles = null;\n\t\t};\n\t\treader.readAsDataURL(inputFiles[0]);\n\t};\n\n\tconst copyUrl = () => {\n\t\tnavigator.clipboard.writeText(\n\t\t\t`${WEBUI_API_BASE_URL}/channels/webhooks/${webhook.id}/${webhook.token}`\n\t\t);\n\t\ttoast.success($i18n.t('Copied'));\n\t};\n</script>\n\n<input\n\tbind:this={filesInputElement}\n\tbind:files={inputFiles}\n\ttype=\"file\"\n\thidden\n\taccept=\"image/*\"\n\ton:change={handleImageUpload}\n/>\n\n<div class=\"text-xs -mx-1\">\n\t<!-- Row -->\n\t<button\n\t\ttype=\"button\"\n\t\tclass=\"w-full flex items-center gap-3 px-3.5 py-3 hover:bg-gray-50 dark:hover:bg-gray-900 rounded-xl transition\"\n\t\ton:click={onClick}\n\t>\n\t\t<img\n\t\t\tsrc={image || `${WEBUI_BASE_URL}/static/favicon.png`}\n\t\t\tclass=\"rounded-full size-8 object-cover flex-shrink-0\"\n\t\t\talt=\"\"\n\t\t/>\n\t\t<div class=\"flex-1 text-left min-w-0\">\n\t\t\t<div class=\"font-medium text-gray-900 dark:text-white truncate\">\n\t\t\t\t{name}\n\t\t\t</div>\n\t\t\t<div class=\"text-gray-500 text-xs\">\n\t\t\t\t{$i18n.t('Created on {{date}}', {\n\t\t\t\t\tdate: dayjs(webhook.created_at / 1000000).format('MMM D, YYYY')\n\t\t\t\t})}\n\t\t\t\t{#if webhook.user?.name}\n\t\t\t\t\t{$i18n.t('by {{name}}', { name: webhook.user.name })}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t\t<ChevronDown\n\t\t\tclassName=\"size-3.5 text-gray-400 transition-transform duration-200 {expanded\n\t\t\t\t? 'rotate-180'\n\t\t\t\t: ''}\"\n\t\t/>\n\t</button>\n\n\t<!-- Expanded -->\n\t{#if expanded}\n\t\t<div class=\"mt-1 mb-3 px-3.5 py-3 border border-gray-100 dark:border-gray-850 rounded-2xl\">\n\t\t\t<div class=\"flex items-center gap-3\">\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"shrink-0 rounded-xl overflow-hidden hover:opacity-80 transition\"\n\t\t\t\t\ton:click={() => filesInputElement.click()}\n\t\t\t\t>\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc={image || `${WEBUI_BASE_URL}/static/favicon.png`}\n\t\t\t\t\t\tclass=\"size-8 object-cover\"\n\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t<div class=\" text-gray-500 text-xs\">{$i18n.t('Name')}</div>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclass=\"w-full text-sm bg-transparent outline-none placeholder:text-gray-300 dark:placeholder:text-gray-700\"\n\t\t\t\t\t\tbind:value={name}\n\t\t\t\t\t\tplaceholder={$i18n.t('Webhook Name')}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex items-center gap-1\">\n\t\t\t\t\t<Tooltip content={$i18n.t('Copy URL')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition\"\n\t\t\t\t\t\t\ton:click={copyUrl}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Clipboard className=\"size-4 text-gray-500\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t\t<Tooltip content={$i18n.t('Delete')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition\"\n\t\t\t\t\t\t\ton:click={onDelete}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<GarbageBin className=\"size-4 text-gray-500\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext } from 'svelte';\n\n\timport {\n\t\tgetChannelWebhooks,\n\t\tcreateChannelWebhook,\n\t\tupdateChannelWebhook,\n\t\tdeleteChannelWebhook\n\t} from '$lib/apis/channels';\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport ConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport WebhookItem from './WebhookItem.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\texport let channel = null;\n\n\tlet webhooks = [];\n\tlet isLoading = false;\n\tlet isSaving = false;\n\n\tlet showDeleteConfirmDialog = false;\n\tlet selectedWebhookId = null;\n\n\t// Track pending changes from child components\n\tlet pendingChanges: { [webhookId: string]: { name: string; profile_image_url: string } } = {};\n\n\tconst loadWebhooks = async () => {\n\t\tisLoading = true;\n\t\ttry {\n\t\t\twebhooks = await getChannelWebhooks(localStorage.token, channel.id);\n\t\t} catch {\n\t\t\twebhooks = [];\n\t\t}\n\t\tisLoading = false;\n\t};\n\n\tconst createHandler = async () => {\n\t\tisSaving = true;\n\t\ttry {\n\t\t\tconst newWebhook = await createChannelWebhook(localStorage.token, channel.id, {\n\t\t\t\tname: 'New Webhook'\n\t\t\t});\n\t\t\tif (newWebhook) {\n\t\t\t\twebhooks = [...webhooks, newWebhook];\n\t\t\t\tselectedWebhookId = newWebhook.id;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\ttoast.error(`${error}`);\n\t\t}\n\t\tisSaving = false;\n\t};\n\n\tconst saveHandler = async () => {\n\t\tisSaving = true;\n\t\ttry {\n\t\t\tfor (const [webhookId, changes] of Object.entries(pendingChanges)) {\n\t\t\t\tawait updateChannelWebhook(localStorage.token, channel.id, webhookId, changes);\n\t\t\t}\n\t\t\tpendingChanges = {};\n\t\t\tawait loadWebhooks();\n\t\t\ttoast.success($i18n.t('Saved'));\n\t\t} catch (error) {\n\t\t\ttoast.error(`${error}`);\n\t\t}\n\t\tisSaving = false;\n\t};\n\n\tconst deleteHandler = async () => {\n\t\tif (!selectedWebhookId) return;\n\n\t\ttry {\n\t\t\tawait deleteChannelWebhook(localStorage.token, channel.id, selectedWebhookId);\n\t\t\twebhooks = webhooks.filter((webhook) => webhook.id !== selectedWebhookId);\n\t\t\ttoast.success($i18n.t('Deleted'));\n\t\t} catch (error) {\n\t\t\ttoast.error(`${error}`);\n\t\t}\n\n\t\tselectedWebhookId = null;\n\t\tshowDeleteConfirmDialog = false;\n\t};\n\n\t$: if (show && channel) {\n\t\tloadWebhooks();\n\t\tselectedWebhookId = null;\n\t\tpendingChanges = {};\n\t}\n</script>\n\n<ConfirmDialog bind:show={showDeleteConfirmDialog} on:confirm={deleteHandler} />\n\n{#if channel}\n\t<Modal size=\"sm\" bind:show>\n\t\t<div>\n\t\t\t<div class=\"flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5\">\n\t\t\t\t<div class=\"flex w-full justify-between items-center mr-3\">\n\t\t\t\t\t<div class=\"self-center text-base flex gap-1.5 items-center\">\n\t\t\t\t\t\t<div>{$i18n.t('Webhooks')}</div>\n\t\t\t\t\t\t<span class=\"text-sm text-gray-500\">{webhooks.length}</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tclass=\"px-3 py-1.5 gap-1 rounded-xl bg-gray-100/50 dark:bg-gray-850/50 text-black dark:text-white transition font-medium text-xs flex items-center justify-center\"\n\t\t\t\t\t\ton:click={createHandler}\n\t\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Plus className=\"size-3.5\" />\n\t\t\t\t\t\t<span>{$i18n.t('New Webhook')}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<button class=\"self-center\" on:click={() => (show = false)}>\n\t\t\t\t\t<XMark className=\"size-5\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex flex-col w-full px-4 pb-4 dark:text-gray-200\">\n\t\t\t\t<form\n\t\t\t\t\tclass=\"flex flex-col w-full\"\n\t\t\t\t\ton:submit={(e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tsaveHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{#if isLoading}\n\t\t\t\t\t\t<div class=\"flex justify-center py-10\">\n\t\t\t\t\t\t\t<Spinner className=\"size-5\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else if webhooks.length > 0}\n\t\t\t\t\t\t<div class=\"w-full py-2\">\n\t\t\t\t\t\t\t{#each webhooks as webhook (webhook.id)}\n\t\t\t\t\t\t\t\t<WebhookItem\n\t\t\t\t\t\t\t\t\t{webhook}\n\t\t\t\t\t\t\t\t\texpanded={selectedWebhookId === webhook.id}\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tselectedWebhookId = selectedWebhookId === webhook.id ? null : webhook.id;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tonDelete={() => {\n\t\t\t\t\t\t\t\t\t\tshowDeleteConfirmDialog = true;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tonUpdate={(changes) => {\n\t\t\t\t\t\t\t\t\t\tpendingChanges[webhook.id] = changes;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div class=\"text-gray-500 text-xs text-center py-8 px-10\">\n\t\t\t\t\t\t\t{$i18n.t('No webhooks yet')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div class=\"flex justify-end text-sm font-medium gap-1.5\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center {isSaving\n\t\t\t\t\t\t\t\t? 'cursor-not-allowed'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{$i18n.t('Save')}\n\t\t\t\t\t\t\t{#if isSaving}\n\t\t\t\t\t\t\t\t<div class=\"ml-2 self-center\">\n\t\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</Modal>\n{/if}\n","<script lang=\"ts\">\n\timport { getContext, createEventDispatcher, onMount } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { toast } from 'svelte-sonner';\n\timport { page } from '$app/stores';\n\timport { goto } from '$app/navigation';\n\n\timport { createNewChannel, deleteChannelById } from '$lib/apis/channels';\n\timport { user } from '$lib/stores';\n\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport AccessControl from '$lib/components/workspace/common/AccessControl.svelte';\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport MemberSelector from '$lib/components/workspace/common/MemberSelector.svelte';\n\timport Visibility from '$lib/components/workspace/common/Visibility.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport WebhooksModal from '$lib/components/channel/WebhooksModal.svelte';\n\n\texport let show = false;\n\texport let onSubmit: Function = () => {};\n\texport let onUpdate: Function = () => {};\n\n\texport let channel = null;\n\texport let edit = false;\n\n\tlet channelTypes = ['group', 'dm'];\n\tlet type = '';\n\tlet name = '';\n\n\tlet isPrivate = null;\n\tlet accessControl = {};\n\n\tlet groupIds = [];\n\tlet userIds = [];\n\n\tlet loading = false;\n\n\t$: if (name) {\n\t\tname = name.replace(/\\s/g, '-').toLocaleLowerCase();\n\t}\n\n\t$: onTypeChange(type);\n\n\tconst onTypeChange = (type) => {\n\t\tif (type === 'group') {\n\t\t\tif (isPrivate === null) {\n\t\t\t\tisPrivate = true;\n\t\t\t}\n\t\t} else {\n\t\t\tisPrivate = null;\n\t\t}\n\t};\n\n\tconst submitHandler = async () => {\n\t\tloading = true;\n\t\tif (name.length > 128) {\n\t\t\ttoast.error($i18n.t('Channel name must be less than 128 characters'));\n\t\t\tloading = false;\n\t\t\treturn;\n\t\t}\n\n\t\tawait onSubmit({\n\t\t\ttype: type,\n\t\t\tname: name.replace(/\\s/g, '-'),\n\t\t\tis_private: type === 'group' ? isPrivate : null,\n\t\t\taccess_control: type === '' ? accessControl : {},\n\t\t\tgroup_ids: groupIds,\n\t\t\tuser_ids: userIds\n\t\t});\n\t\tshow = false;\n\t\tloading = false;\n\t};\n\n\tconst init = () => {\n\t\tif ($user?.role === 'admin') {\n\t\t\tchannelTypes = ['', 'group', 'dm'];\n\t\t} else {\n\t\t\tchannelTypes = ['group', 'dm'];\n\t\t}\n\n\t\ttype = channel?.type ?? channelTypes[0];\n\n\t\tif (channel) {\n\t\t\tname = channel?.name ?? '';\n\t\t\tisPrivate = channel?.is_private ?? null;\n\t\t\taccessControl = channel.access_control;\n\t\t\tuserIds = channel?.user_ids ?? [];\n\t\t}\n\t};\n\n\t$: if (show) {\n\t\tinit();\n\t} else {\n\t\tresetHandler();\n\t}\n\n\tlet showDeleteConfirmDialog = false;\n\tlet showWebhooksModal = false;\n\n\tconst deleteHandler = async () => {\n\t\tshowDeleteConfirmDialog = false;\n\n\t\tconst res = await deleteChannelById(localStorage.token, channel.id).catch((error) => {\n\t\t\ttoast.error(error.message);\n\t\t});\n\n\t\tif (res) {\n\t\t\ttoast.success($i18n.t('Channel deleted successfully'));\n\t\t\tonUpdate();\n\n\t\t\tif ($page.url.pathname === `/channels/${channel.id}`) {\n\t\t\t\tgoto('/');\n\t\t\t}\n\t\t}\n\n\t\tshow = false;\n\t};\n\n\tconst resetHandler = () => {\n\t\ttype = '';\n\t\tname = '';\n\t\taccessControl = {};\n\t\tuserIds = [];\n\t\tloading = false;\n\t};\n</script>\n\n<Modal size=\"md\" bind:show>\n\t<div>\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-1\">\n\t\t\t<div class=\" text-lg font-medium self-center\">\n\t\t\t\t{#if edit}\n\t\t\t\t\t{$i18n.t('Edit Channel')}\n\t\t\t\t{:else}\n\t\t\t\t\t{$i18n.t('Create Channel')}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className={'size-5'} />\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full px-5 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t<form\n\t\t\t\t\tclass=\"flex flex-col w-full\"\n\t\t\t\t\ton:submit|preventDefault={() => {\n\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{#if !edit}\n\t\t\t\t\t\t<div class=\"flex flex-col w-full mt-2 mb-1\">\n\t\t\t\t\t\t\t<div class=\" mb-1 text-xs text-gray-500\">{$i18n.t('Channel Type')}</div>\n\n\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\tcontent={type === 'dm'\n\t\t\t\t\t\t\t\t\t\t? $i18n.t('A private conversation between you and selected users')\n\t\t\t\t\t\t\t\t\t\t: type === 'group'\n\t\t\t\t\t\t\t\t\t\t\t? $i18n.t('A collaboration channel where people join as members')\n\t\t\t\t\t\t\t\t\t\t\t: $i18n.t(\n\t\t\t\t\t\t\t\t\t\t\t\t\t'A discussion channel where access is controlled by groups and permissions'\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tplacement=\"top-start\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\t\tclass=\"w-full text-sm bg-transparent placeholder:text-gray-300 dark:placeholder:text-gray-700 outline-hidden\"\n\t\t\t\t\t\t\t\t\t\tbind:value={type}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{#each channelTypes as channelType, channelTypeIdx (channelType)}\n\t\t\t\t\t\t\t\t\t\t\t<option value={channelType} selected={channelTypeIdx === 0}>\n\t\t\t\t\t\t\t\t\t\t\t\t{#if channelType === 'group'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Group Channel')}\n\t\t\t\t\t\t\t\t\t\t\t\t{:else if channelType === 'dm'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Direct Message')}\n\t\t\t\t\t\t\t\t\t\t\t\t{:else if channelType === ''}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Channel')}\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div class=\" text-gray-300 dark:text-gray-700 text-xs\">\n\t\t\t\t\t\t{#if type === ''}\n\t\t\t\t\t\t\t{$i18n.t('Discussion channel where access is based on groups and permissions')}\n\t\t\t\t\t\t{:else if type === 'group'}\n\t\t\t\t\t\t\t{$i18n.t('Collaboration channel where people join as members')}\n\t\t\t\t\t\t{:else if type === 'dm'}\n\t\t\t\t\t\t\t{$i18n.t('Private conversation between selected users')}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex flex-col w-full mt-2\">\n\t\t\t\t\t\t<div class=\" mb-1 text-xs text-gray-500\">\n\t\t\t\t\t\t\t{$i18n.t('Channel Name')}\n\t\t\t\t\t\t\t<span class=\"text-xs text-gray-200 dark:text-gray-800 ml-0.5\"\n\t\t\t\t\t\t\t\t>{type === 'dm' ? `${$i18n.t('Optional')}` : ''}</span\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"w-full text-sm bg-transparent placeholder:text-gray-300 dark:placeholder:text-gray-700 outline-hidden\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tbind:value={name}\n\t\t\t\t\t\t\t\tplaceholder={`${$i18n.t('new-channel')}`}\n\t\t\t\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\t\t\t\trequired={type !== 'dm'}\n\t\t\t\t\t\t\t\tmax=\"100\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if type !== 'dm'}\n\t\t\t\t\t\t<div class=\"-mx-2 mb-1 mt-2.5 px-2\">\n\t\t\t\t\t\t\t{#if type === ''}\n\t\t\t\t\t\t\t\t<AccessControl bind:accessControl accessRoles={['read', 'write']} />\n\t\t\t\t\t\t\t{:else if type === 'group'}\n\t\t\t\t\t\t\t\t<Visibility\n\t\t\t\t\t\t\t\t\tstate={isPrivate ? 'private' : 'public'}\n\t\t\t\t\t\t\t\t\tonChange={(value) => {\n\t\t\t\t\t\t\t\t\t\tif (value === 'private') {\n\t\t\t\t\t\t\t\t\t\t\tisPrivate = true;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tisPrivate = false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tconsole.log(value, isPrivate);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if ['dm'].includes(type)}\n\t\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t<MemberSelector bind:userIds includeGroups={false} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if edit}\n\t\t\t\t\t\t<div class=\"flex w-full mt-2 items-center justify-between\">\n\t\t\t\t\t\t\t<div class=\"text-xs text-gray-500\">{$i18n.t('Webhooks')}</div>\n\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"text-xs bg-transparent placeholder:text-gray-300 dark:placeholder:text-gray-700 outline-hidden text-left\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowWebhooksModal = true;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{$i18n.t('Manage')}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div class=\"flex justify-end pt-3 text-sm font-medium gap-1.5\">\n\t\t\t\t\t\t{#if edit}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium dark:bg-black dark:hover:bg-black/90 dark:text-white bg-white text-black hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowDeleteConfirmDialog = true;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{$i18n.t('Delete')}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-950 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center {loading\n\t\t\t\t\t\t\t\t? ' cursor-not-allowed'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if edit}\n\t\t\t\t\t\t\t\t{$i18n.t('Update')}\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t{$i18n.t('Create')}\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t\t\t<div class=\"ml-2 self-center\">\n\t\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n\n<DeleteConfirmDialog\n\tbind:show={showDeleteConfirmDialog}\n\tmessage={$i18n.t('Are you sure you want to delete this channel?')}\n\tconfirmLabel={$i18n.t('Delete')}\n\ton:confirm={() => {\n\t\tdeleteHandler();\n\t}}\n/>\n\n<WebhooksModal bind:show={showWebhooksModal} {channel} />\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { onMount, getContext, tick, onDestroy } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { page } from '$app/stores';\n\timport { channels, mobile, showSidebar, user } from '$lib/stores';\n\timport { getUserActiveStatusById } from '$lib/apis/users';\n\timport { updateChannelById, updateChannelMemberActiveStatusById } from '$lib/apis/channels';\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\n\n\timport Cog6 from '$lib/components/icons/Cog6.svelte';\n\timport ChannelModal from './ChannelModal.svelte';\n\timport Lock from '$lib/components/icons/Lock.svelte';\n\timport Hashtag from '$lib/components/icons/Hashtag.svelte';\n\timport Users from '$lib/components/icons/Users.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport Emoji from '$lib/components/common/Emoji.svelte';\n\n\texport let onUpdate: Function = () => {};\n\n\texport let className = '';\n\texport let channel;\n\n\tlet showEditChannelModal = false;\n\n\tlet itemElement;\n</script>\n\n<ChannelModal\n\tbind:show={showEditChannelModal}\n\t{channel}\n\tedit={true}\n\t{onUpdate}\n\tonSubmit={async ({ name, is_private, access_control, group_ids, user_ids }) => {\n\t\tconst res = await updateChannelById(localStorage.token, channel.id, {\n\t\t\tname,\n\t\t\tis_private,\n\t\t\taccess_control,\n\t\t\tgroup_ids,\n\t\t\tuser_ids\n\t\t}).catch((error) => {\n\t\t\ttoast.error(error.message);\n\t\t});\n\n\t\tif (res) {\n\t\t\ttoast.success($i18n.t('Channel updated successfully'));\n\t\t}\n\n\t\tonUpdate();\n\t}}\n/>\n\n<div\n\tid=\"sidebar-channel-item\"\n\tbind:this={itemElement}\n\tclass=\" w-full {className} rounded-xl flex relative group hover:bg-gray-100 dark:hover:bg-gray-900 {$page\n\t\t.url.pathname === `/channels/${channel.id}`\n\t\t? 'bg-gray-100 dark:bg-gray-900 selected'\n\t\t: ''} {channel?.type === 'dm' ? 'px-1 py-[3px]' : 'p-1'}  {channel?.unread_count > 0\n\t\t? 'font-medium dark:text-white text-black'\n\t\t: ' dark:text-gray-400 text-gray-600'} cursor-pointer select-none\"\n>\n\t<a\n\t\tclass=\" w-full flex justify-between\"\n\t\thref=\"/channels/{channel.id}\"\n\t\ton:click={() => {\n\t\t\tconsole.log(channel);\n\n\t\t\tif ($channels) {\n\t\t\t\tchannels.set(\n\t\t\t\t\t$channels.map((ch) => {\n\t\t\t\t\t\tif (ch.id === channel.id) {\n\t\t\t\t\t\t\tch.unread_count = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn ch;\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif ($mobile) {\n\t\t\t\tshowSidebar.set(false);\n\t\t\t}\n\t\t}}\n\t\tdraggable=\"false\"\n\t>\n\t\t<div class=\"flex items-center gap-1\">\n\t\t\t<div>\n\t\t\t\t{#if channel?.type === 'dm'}\n\t\t\t\t\t{#if channel?.users}\n\t\t\t\t\t\t{@const channelMembers = channel.users.filter((u) => u.id !== $user?.id)}\n\t\t\t\t\t\t<div class=\"flex ml-[1px] mr-0.5 relative\">\n\t\t\t\t\t\t\t{#each channelMembers.slice(0, 2) as u, index}\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${u.id}/profile/image`}\n\t\t\t\t\t\t\t\t\talt={u.name}\n\t\t\t\t\t\t\t\t\tclass=\" size-5.5 rounded-full border-2 border-white dark:border-gray-900 {index ===\n\t\t\t\t\t\t\t\t\t1\n\t\t\t\t\t\t\t\t\t\t? '-ml-2.5'\n\t\t\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/each}\n\n\t\t\t\t\t\t\t{#if channelMembers.length === 1}\n\t\t\t\t\t\t\t\t<div class=\"absolute bottom-0 right-0\">\n\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2\">\n\t\t\t\t\t\t\t\t\t\t{#if channelMembers[0]?.is_active}\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\tclass=\"relative inline-flex size-2 rounded-full {channelMembers[0]?.is_active\n\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-green-500'\n\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-gray-300 dark:bg-gray-700'} border-[1.5px] border-white dark:border-gray-900\"\n\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<Users className=\"size-4 ml-1 mr-0.5\" strokeWidth=\"2\" />\n\t\t\t\t\t{/if}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\" size-4 justify-center flex items-center ml-1\">\n\t\t\t\t\t\t{#if channel?.type === 'group' ? !channel?.is_private : channel?.access_control === null}\n\t\t\t\t\t\t\t<Hashtag className=\"size-3.5\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<Lock className=\"size-[15px]\" strokeWidth=\"2\" />\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tclass=\" text-left self-center overflow-hidden w-full line-clamp-1 flex-1 pr-1 flex items-center gap-2.5\"\n\t\t\t>\n\t\t\t\t{#if channel?.name}\n\t\t\t\t\t<span class=\"line-clamp-1\">\n\t\t\t\t\t\t{channel.name}\n\t\t\t\t\t</span>\n\t\t\t\t{:else}\n\t\t\t\t\t<span class=\"shrink-0 line-clamp-1\">\n\t\t\t\t\t\t{channel?.users\n\t\t\t\t\t\t\t?.filter((u) => u.id !== $user?.id)\n\t\t\t\t\t\t\t.map((u) => u.name)\n\t\t\t\t\t\t\t.join(', ')}\n\t\t\t\t\t</span>\n\n\t\t\t\t\t{#if channel?.users?.length === 2}\n\t\t\t\t\t\t{@const dmUser = channel.users.find((u) => u.id !== $user?.id)}\n\n\t\t\t\t\t\t{#if dmUser?.status_emoji || dmUser?.status_message}\n\t\t\t\t\t\t\t<span class=\"flex gap-1.5 line-clamp-1\">\n\t\t\t\t\t\t\t\t{#if dmUser?.status_emoji}\n\t\t\t\t\t\t\t\t\t<div class=\" self-center shrink-0\">\n\t\t\t\t\t\t\t\t\t\t<Emoji className=\"size-3.5\" shortCode={dmUser?.status_emoji} />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t<div class=\"line-clamp-1 italic\">\n\t\t\t\t\t\t\t\t\t{dmUser?.status_message}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{/if}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"flex items-center\">\n\t\t\t{#if channel?.unread_count > 0}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"text-xs py-[1px] px-2 rounded-xl bg-gray-100 text-black dark:bg-gray-800 dark:text-white font-medium whitespace-nowrap\"\n\t\t\t\t>\n\t\t\t\t\t{new Intl.NumberFormat($i18n.locale, {\n\t\t\t\t\t\tnotation: 'compact',\n\t\t\t\t\t\tcompactDisplay: 'short'\n\t\t\t\t\t}).format(channel.unread_count)}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</a>\n\n\t{#if ['dm'].includes(channel?.type)}\n\t\t<div\n\t\t\tclass=\"ml-0.5 mr-1 invisible group-hover:visible self-center flex items-center dark:text-gray-300\"\n\t\t>\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclass=\"p-0.5 dark:hover:bg-gray-850 rounded-lg touch-auto\"\n\t\t\t\ton:click={async (e) => {\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\tchannels.update((chs) =>\n\t\t\t\t\t\tchs.filter((ch) => {\n\t\t\t\t\t\t\treturn ch.id !== channel.id;\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t\tawait updateChannelMemberActiveStatusById(localStorage.token, channel.id, false).catch(\n\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className=\"size-3.5\" />\n\t\t\t</button>\n\t\t</div>\n\t{:else if $user?.role === 'admin' || channel.user_id === $user?.id}\n\t\t<div\n\t\t\tclass=\"ml-0.5 mr-1 invisible group-hover:visible self-center flex items-center dark:text-gray-300\"\n\t\t>\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclass=\"p-0.5 dark:hover:bg-gray-850 rounded-lg touch-auto\"\n\t\t\t\ton:click={(e) => {\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tshowEditChannelModal = true;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Cog6 className=\"size-3.5\" />\n\t\t\t</button>\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { getAllTags } from '$lib/apis/chats';\n\timport { folders, tags } from '$lib/stores';\n\timport { getContext, createEventDispatcher, onMount, onDestroy, tick } from 'svelte';\n\timport { fade } from 'svelte/transition';\n\timport Search from '$lib/components/icons/Search.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\n\tconst dispatch = createEventDispatcher();\n\tconst i18n = getContext('i18n');\n\n\texport let placeholder = '';\n\texport let value = '';\n\texport let showClearButton = false;\n\n\texport let onFocus = () => {};\n\texport let onKeydown = (e) => {};\n\n\tlet selectedIdx = 0;\n\tlet selectedOption = null;\n\n\tlet lastWord = '';\n\t$: lastWord = value ? value.split(' ').at(-1) : value;\n\n\tlet options = [\n\t\t{\n\t\t\tname: 'tag:',\n\t\t\tdescription: $i18n.t('search for tags')\n\t\t},\n\t\t{\n\t\t\tname: 'folder:',\n\t\t\tdescription: $i18n.t('search for folders')\n\t\t},\n\t\t{\n\t\t\tname: 'pinned:',\n\t\t\tdescription: $i18n.t('search for pinned chats')\n\t\t},\n\t\t{\n\t\t\tname: 'shared:',\n\t\t\tdescription: $i18n.t('search for shared chats')\n\t\t},\n\t\t{\n\t\t\tname: 'archived:',\n\t\t\tdescription: $i18n.t('search for archived chats')\n\t\t}\n\t];\n\tlet focused = false;\n\tlet loading = false;\n\n\tlet hovering = false;\n\n\tlet filteredOptions = options;\n\t$: filteredOptions = options.filter((option) => {\n\t\treturn option.name.startsWith(lastWord);\n\t});\n\n\tlet filteredItems = [];\n\n\t$: if (lastWord && lastWord !== null) {\n\t\tinitItems();\n\t}\n\n\tconst initItems = async () => {\n\t\tconsole.log('initItems', lastWord);\n\t\tloading = true;\n\t\tawait tick();\n\n\t\tif (lastWord.startsWith('tag:')) {\n\t\t\tfilteredItems = [\n\t\t\t\t...$tags,\n\t\t\t\t{\n\t\t\t\t\tid: 'none',\n\t\t\t\t\tname: $i18n.t('Untagged')\n\t\t\t\t}\n\t\t\t]\n\t\t\t\t.filter((tag) => {\n\t\t\t\t\tconst tagName = lastWord.slice(4);\n\t\t\t\t\tif (tagName) {\n\t\t\t\t\t\tconst tagId = tagName.replaceAll(' ', '_').toLowerCase();\n\n\t\t\t\t\t\tif (tag.id !== tagId) {\n\t\t\t\t\t\t\treturn tag.id.startsWith(tagId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.map((tag) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: tag.id,\n\t\t\t\t\t\tname: tag.name,\n\t\t\t\t\t\ttype: 'tag'\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t} else if (lastWord.startsWith('folder:')) {\n\t\t\tfilteredItems = [...$folders]\n\t\t\t\t.filter((folder) => {\n\t\t\t\t\tconst folderName = lastWord.slice(7);\n\t\t\t\t\tif (folderName) {\n\t\t\t\t\t\tconst id = folder.name.replaceAll(' ', '_').toLowerCase();\n\t\t\t\t\t\tconst folderId = folderName.replaceAll(' ', '_').toLowerCase();\n\n\t\t\t\t\t\tif (id !== folderId) {\n\t\t\t\t\t\t\treturn id.startsWith(folderId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.map((folder) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: folder.name.replaceAll(' ', '_').toLowerCase(),\n\t\t\t\t\t\tname: folder.name,\n\t\t\t\t\t\ttype: 'folder'\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t} else if (lastWord.startsWith('pinned:')) {\n\t\t\tfilteredItems = [\n\t\t\t\t{\n\t\t\t\t\tid: 'true',\n\t\t\t\t\tname: 'true',\n\t\t\t\t\ttype: 'pinned'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'false',\n\t\t\t\t\tname: 'false',\n\t\t\t\t\ttype: 'pinned'\n\t\t\t\t}\n\t\t\t].filter((item) => {\n\t\t\t\tconst pinnedValue = lastWord.slice(7);\n\t\t\t\tif (pinnedValue) {\n\t\t\t\t\treturn item.id.startsWith(pinnedValue) && item.id !== pinnedValue;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (lastWord.startsWith('shared:')) {\n\t\t\tfilteredItems = [\n\t\t\t\t{\n\t\t\t\t\tid: 'true',\n\t\t\t\t\tname: 'true',\n\t\t\t\t\ttype: 'shared'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'false',\n\t\t\t\t\tname: 'false',\n\t\t\t\t\ttype: 'shared'\n\t\t\t\t}\n\t\t\t].filter((item) => {\n\t\t\t\tconst sharedValue = lastWord.slice(7);\n\t\t\t\tif (sharedValue) {\n\t\t\t\t\treturn item.id.startsWith(sharedValue) && item.id !== sharedValue;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (lastWord.startsWith('archived:')) {\n\t\t\tfilteredItems = [\n\t\t\t\t{\n\t\t\t\t\tid: 'true',\n\t\t\t\t\tname: 'true',\n\t\t\t\t\ttype: 'archived'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'false',\n\t\t\t\t\tname: 'false',\n\t\t\t\t\ttype: 'archived'\n\t\t\t\t}\n\t\t\t].filter((item) => {\n\t\t\t\tconst archivedValue = lastWord.slice(9);\n\t\t\t\tif (archivedValue) {\n\t\t\t\t\treturn item.id.startsWith(archivedValue) && item.id !== archivedValue;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tfilteredItems = [];\n\t\t}\n\n\t\tloading = false;\n\t};\n\n\tconst initTags = async () => {\n\t\tloading = true;\n\n\t\tawait tags.set(await getAllTags(localStorage.token));\n\t\tloading = false;\n\t};\n\n\tconst clearSearchInput = () => {\n\t\tvalue = '';\n\t\tdispatch('input');\n\t};\n</script>\n\n<div class=\"px-1 mb-1 flex justify-center space-x-2 relative z-10\" id=\"search-container\">\n\t<div class=\"flex w-full rounded-xl\" id=\"chat-search\">\n\t\t<div class=\"self-center py-2 rounded-l-xl bg-transparent dark:text-gray-300\">\n\t\t\t<Search />\n\t\t</div>\n\n\t\t<input\n\t\t\tid=\"search-input\"\n\t\t\tclass=\"w-full rounded-r-xl py-1.5 pl-2.5 text-sm bg-transparent dark:text-gray-300 outline-hidden\"\n\t\t\tplaceholder={placeholder ? placeholder : $i18n.t('Search')}\n\t\t\tautocomplete=\"off\"\n\t\t\tmaxlength=\"500\"\n\t\t\tbind:value\n\t\t\ton:input={() => {\n\t\t\t\tdispatch('input');\n\t\t\t}}\n\t\t\ton:click={() => {\n\t\t\t\tif (!focused) {\n\t\t\t\t\tonFocus();\n\t\t\t\t\thovering = false;\n\n\t\t\t\t\tfocused = true;\n\t\t\t\t\tinitTags();\n\t\t\t\t}\n\t\t\t}}\n\t\t\ton:blur={() => {\n\t\t\t\tif (!hovering) {\n\t\t\t\t\tfocused = false;\n\t\t\t\t}\n\t\t\t}}\n\t\t\ton:keydown={(e) => {\n\t\t\t\tif (e.key === 'Enter') {\n\t\t\t\t\tif (filteredItems.length > 0) {\n\t\t\t\t\t\tconst itemElement = document.getElementById(`search-item-${selectedIdx}`);\n\t\t\t\t\t\titemElement.click();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (filteredOptions.length > 0) {\n\t\t\t\t\t\tconst optionElement = document.getElementById(`search-option-${selectedIdx}`);\n\t\t\t\t\t\toptionElement.click();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'ArrowUp') {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tselectedIdx = Math.max(0, selectedIdx - 1);\n\t\t\t\t} else if (e.key === 'ArrowDown') {\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif (filteredItems.length > 0) {\n\t\t\t\t\t\tif (selectedIdx === filteredItems.length - 1) {\n\t\t\t\t\t\t\tfocused = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tselectedIdx = Math.min(selectedIdx + 1, filteredItems.length - 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (selectedIdx === filteredOptions.length - 1) {\n\t\t\t\t\t\t\tfocused = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tselectedIdx = Math.min(selectedIdx + 1, filteredOptions.length - 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// if the user types something, reset to the top selection.\n\t\t\t\t\tif (!focused) {\n\t\t\t\t\t\tonFocus();\n\t\t\t\t\t\thovering = false;\n\n\t\t\t\t\t\tfocused = true;\n\t\t\t\t\t\tinitTags();\n\t\t\t\t\t}\n\n\t\t\t\t\tselectedIdx = 0;\n\t\t\t\t}\n\n\t\t\t\tconst item = document.querySelector(`[data-selected=\"true\"]`);\n\t\t\t\titem?.scrollIntoView({ block: 'center', inline: 'nearest', behavior: 'instant' });\n\n\t\t\t\tif (!document.getElementById('search-options-container')) {\n\t\t\t\t\tonKeydown(e);\n\t\t\t\t}\n\t\t\t}}\n\t\t/>\n\n\t\t{#if showClearButton && value}\n\t\t\t<div class=\"self-center pl-1.5 translate-y-[0.5px] rounded-l-xl bg-transparent\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"p-0.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\ton:click={clearSearchInput}\n\t\t\t\t>\n\t\t\t\t\t<XMark className=\"size-3\" strokeWidth=\"2\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t{#if focused && (filteredOptions.length > 0 || filteredItems.length > 0)}\n\t\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t\t<div\n\t\t\tclass=\"absolute top-0 mt-8 left-0 right-1 border border-gray-100 dark:border-gray-900 bg-gray-50 dark:bg-gray-950 rounded-2xl z-10 shadow-lg\"\n\t\t\tid=\"search-options-container\"\n\t\t\tin:fade={{ duration: 50 }}\n\t\t\ton:mouseenter={() => {\n\t\t\t\thovering = true;\n\t\t\t\tselectedIdx = null;\n\t\t\t}}\n\t\t\ton:mouseleave={() => {\n\t\t\t\thovering = false;\n\t\t\t\tselectedIdx = 0;\n\t\t\t}}\n\t\t>\n\t\t\t<div class=\"px-3 py-2.5 text-xs group\">\n\t\t\t\t{#if filteredItems.length > 0}\n\t\t\t\t\t<div class=\"px-1 font-medium dark:text-gray-300 text-gray-700 mb-1 capitalize\">\n\t\t\t\t\t\t{selectedOption}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"max-h-60 overflow-auto\">\n\t\t\t\t\t\t{#each filteredItems as item, itemIdx}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\" px-1.5 py-0.5 flex gap-1 hover:bg-gray-100 dark:hover:bg-gray-900 w-full rounded {selectedIdx ===\n\t\t\t\t\t\t\t\titemIdx\n\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-900'\n\t\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\t\tdata-selected={selectedIdx === itemIdx}\n\t\t\t\t\t\t\t\tid=\"search-item-{itemIdx}\"\n\t\t\t\t\t\t\t\ton:click|stopPropagation={async () => {\n\t\t\t\t\t\t\t\t\tconst words = value.split(' ');\n\n\t\t\t\t\t\t\t\t\twords.pop();\n\t\t\t\t\t\t\t\t\twords.push(`${item.type}:${item.id} `);\n\n\t\t\t\t\t\t\t\t\tvalue = words.join(' ');\n\n\t\t\t\t\t\t\t\t\tfilteredItems = [];\n\t\t\t\t\t\t\t\t\tdispatch('input');\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"dark:text-gray-300 text-gray-700 font-medium line-clamp-1 shrink-0\">\n\t\t\t\t\t\t\t\t\t{item.name}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\" text-gray-500 line-clamp-1\">\n\t\t\t\t\t\t\t\t\t{item.id}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t{:else if filteredOptions.length > 0}\n\t\t\t\t\t<div class=\"px-1 font-medium dark:text-gray-300 text-gray-700 mb-1\">\n\t\t\t\t\t\t{$i18n.t('Search options')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\" max-h-60 overflow-auto\">\n\t\t\t\t\t\t{#each filteredOptions as option, optionIdx}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\" px-1.5 py-0.5 flex gap-1 hover:bg-gray-100 dark:hover:bg-gray-900 w-full rounded {selectedIdx ===\n\t\t\t\t\t\t\t\toptionIdx\n\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-900'\n\t\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\t\tid=\"search-option-{optionIdx}\"\n\t\t\t\t\t\t\t\ton:click|stopPropagation={async () => {\n\t\t\t\t\t\t\t\t\tconst words = value.split(' ');\n\n\t\t\t\t\t\t\t\t\twords.pop();\n\t\t\t\t\t\t\t\t\twords.push(`${option.name}`);\n\n\t\t\t\t\t\t\t\t\tselectedOption = option.name.replace(':', '');\n\n\t\t\t\t\t\t\t\t\tvalue = words.join(' ');\n\n\t\t\t\t\t\t\t\t\tdispatch('input');\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"dark:text-gray-300 text-gray-700 font-medium\">{option.name}</div>\n\n\t\t\t\t\t\t\t\t<div class=\" text-gray-500 line-clamp-1\">\n\t\t\t\t\t\t\t\t\t{option.description}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext, onDestroy, onMount, tick } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport SearchInput from './Sidebar/SearchInput.svelte';\n\timport { getChatById, getChatList, getChatListBySearchText } from '$lib/apis/chats';\n\timport Spinner from '../common/Spinner.svelte';\n\n\timport dayjs from '$lib/dayjs';\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\n\timport calendar from 'dayjs/plugin/calendar';\n\timport Loader from '../common/Loader.svelte';\n\timport { createMessagesList } from '$lib/utils';\n\timport { config, user } from '$lib/stores';\n\timport Messages from '../chat/Messages.svelte';\n\timport { goto } from '$app/navigation';\n\timport PencilSquare from '../icons/PencilSquare.svelte';\n\timport PageEdit from '../icons/PageEdit.svelte';\n\tdayjs.extend(calendar);\n\tdayjs.extend(localizedFormat);\n\n\texport let show = false;\n\texport let onClose = () => {};\n\n\tlet actions = [\n\t\t{\n\t\t\tlabel: $i18n.t('Start a new conversation'),\n\t\t\tonClick: async () => {\n\t\t\t\tawait goto(`/${query ? `?q=${query}` : ''}`);\n\t\t\t\tshow = false;\n\t\t\t\tonClose();\n\t\t\t},\n\t\t\ticon: PencilSquare\n\t\t}\n\t];\n\n\tlet query = '';\n\tlet page = 1;\n\n\tlet chatList = null;\n\n\tlet chatListLoading = false;\n\tlet allChatsLoaded = false;\n\n\tlet searchDebounceTimeout;\n\n\tlet selectedIdx = null;\n\tlet selectedChat = null;\n\n\tlet selectedModels = [''];\n\tlet history = null;\n\tlet messages = null;\n\n\t$: if (!chatListLoading && chatList) {\n\t\tloadChatPreview(selectedIdx);\n\t}\n\n\tconst loadChatPreview = async (selectedIdx) => {\n\t\tif (!chatList || chatList.length === 0 || selectedIdx === null) {\n\t\t\tselectedChat = null;\n\t\t\tmessages = null;\n\t\t\thistory = null;\n\t\t\tselectedModels = [''];\n\t\t\treturn;\n\t\t}\n\n\t\tconst selectedChatIdx = selectedIdx - actions.length;\n\t\tif (selectedChatIdx < 0 || selectedChatIdx >= chatList.length) {\n\t\t\tselectedChat = null;\n\t\t\tmessages = null;\n\t\t\thistory = null;\n\t\t\tselectedModels = [''];\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatId = chatList[selectedChatIdx].id;\n\n\t\tconst chat = await getChatById(localStorage.token, chatId).catch(async (error) => {\n\t\t\treturn null;\n\t\t});\n\n\t\tif (chat) {\n\t\t\tif (chat?.chat?.history) {\n\t\t\t\tselectedModels =\n\t\t\t\t\t(chat?.chat?.models ?? undefined) !== undefined\n\t\t\t\t\t\t? chat?.chat?.models\n\t\t\t\t\t\t: [chat?.chat?.models ?? ''];\n\n\t\t\t\thistory = chat?.chat?.history;\n\t\t\t\tmessages = createMessagesList(chat?.chat?.history, chat?.chat?.history?.currentId);\n\n\t\t\t\t// scroll to the bottom of the messages container\n\t\t\t\tawait tick();\n\t\t\t\tconst messagesContainerElement = document.getElementById('chat-preview');\n\t\t\t\tif (messagesContainerElement) {\n\t\t\t\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmessages = [];\n\t\t\t}\n\t\t} else {\n\t\t\ttoast.error($i18n.t('Failed to load chat preview'));\n\t\t\tselectedChat = null;\n\t\t\tmessages = null;\n\t\t\thistory = null;\n\t\t\tselectedModels = [''];\n\t\t\treturn;\n\t\t}\n\t};\n\n\tconst searchHandler = async () => {\n\t\tif (!show) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (searchDebounceTimeout) {\n\t\t\tclearTimeout(searchDebounceTimeout);\n\t\t}\n\n\t\tpage = 1;\n\t\tchatList = null;\n\t\tif (query === '') {\n\t\t\tchatList = await getChatList(localStorage.token, page);\n\t\t} else {\n\t\t\tsearchDebounceTimeout = setTimeout(async () => {\n\t\t\t\tchatList = await getChatListBySearchText(localStorage.token, query, page);\n\n\t\t\t\tif ((chatList ?? []).length === 0) {\n\t\t\t\t\tallChatsLoaded = true;\n\t\t\t\t} else {\n\t\t\t\t\tallChatsLoaded = false;\n\t\t\t\t}\n\t\t\t}, 500);\n\t\t}\n\n\t\tselectedChat = null;\n\t\tmessages = null;\n\t\thistory = null;\n\t\tselectedModels = [''];\n\n\t\tif ((chatList ?? []).length === 0) {\n\t\t\tallChatsLoaded = true;\n\t\t} else {\n\t\t\tallChatsLoaded = false;\n\t\t}\n\t};\n\n\tconst loadMoreChats = async () => {\n\t\tchatListLoading = true;\n\t\tpage += 1;\n\n\t\tlet newChatList = [];\n\n\t\tif (query) {\n\t\t\tnewChatList = await getChatListBySearchText(localStorage.token, query, page);\n\t\t} else {\n\t\t\tnewChatList = await getChatList(localStorage.token, page);\n\t\t}\n\n\t\t// once the bottom of the list has been reached (no results) there is no need to continue querying\n\t\tallChatsLoaded = newChatList.length === 0;\n\n\t\tif (newChatList.length > 0) {\n\t\t\tchatList = [...chatList, ...newChatList];\n\t\t}\n\n\t\tchatListLoading = false;\n\t};\n\n\t$: if (show) {\n\t\tsearchHandler();\n\t}\n\n\tconst onKeyDown = (e) => {\n\t\tconst searchOptions = document.getElementById('search-options-container');\n\t\tif (searchOptions || !show) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.code === 'Escape') {\n\t\t\tshow = false;\n\t\t\tonClose();\n\t\t} else if (e.code === 'Enter') {\n\t\t\tconst item = document.querySelector(`[data-arrow-selected=\"true\"]`);\n\t\t\tif (item) {\n\t\t\t\titem?.click();\n\t\t\t\tshow = false;\n\t\t\t}\n\n\t\t\treturn;\n\t\t} else if (e.code === 'ArrowDown') {\n\t\t\tconst searchInput = document.getElementById('search-input');\n\n\t\t\tif (searchInput) {\n\t\t\t\t// check if focused on the search input\n\t\t\t\tif (document.activeElement === searchInput) {\n\t\t\t\t\tsearchInput.blur();\n\t\t\t\t\tselectedIdx = 0;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tselectedIdx = Math.min(selectedIdx + 1, (chatList ?? []).length - 1 + actions.length);\n\t\t} else if (e.code === 'ArrowUp') {\n\t\t\tif (selectedIdx === 0) {\n\t\t\t\tconst searchInput = document.getElementById('search-input');\n\n\t\t\t\tif (searchInput) {\n\t\t\t\t\t// check if focused on the search input\n\t\t\t\t\tif (document.activeElement !== searchInput) {\n\t\t\t\t\t\tsearchInput.focus();\n\t\t\t\t\t\tselectedIdx = 0;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tselectedIdx = Math.max(selectedIdx - 1, 0);\n\t\t}\n\n\t\tconst item = document.querySelector(`[data-arrow-selected=\"true\"]`);\n\t\titem?.scrollIntoView({ block: 'center', inline: 'nearest', behavior: 'instant' });\n\t};\n\n\tonMount(() => {\n\t\tactions = [\n\t\t\t...actions,\n\t\t\t...(($config?.features?.enable_notes ?? false) &&\n\t\t\t($user?.role === 'admin' || ($user?.permissions?.features?.notes ?? true))\n\t\t\t\t? [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: $i18n.t('Create a new note'),\n\t\t\t\t\t\t\tonClick: async () => {\n\t\t\t\t\t\t\t\tawait goto(`/notes?content=${query}`);\n\t\t\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ticon: PageEdit\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t: [])\n\t\t];\n\n\t\tdocument.addEventListener('keydown', onKeyDown);\n\t});\n\n\tonDestroy(() => {\n\t\tif (searchDebounceTimeout) {\n\t\t\tclearTimeout(searchDebounceTimeout);\n\t\t}\n\t\tdocument.removeEventListener('keydown', onKeyDown);\n\t});\n</script>\n\n<Modal size=\"xl\" bind:show>\n\t<div class=\"py-3 dark:text-gray-300 text-gray-700\">\n\t\t<div class=\"px-4 pb-1.5\">\n\t\t\t<SearchInput\n\t\t\t\tbind:value={query}\n\t\t\t\ton:input={searchHandler}\n\t\t\t\tplaceholder={$i18n.t('Search')}\n\t\t\t\tshowClearButton={true}\n\t\t\t\tonFocus={() => {\n\t\t\t\t\tselectedIdx = null;\n\t\t\t\t\tmessages = null;\n\t\t\t\t}}\n\t\t\t\tonKeydown={(e) => {\n\t\t\t\t\tconsole.log('e', e);\n\n\t\t\t\t\tif (e.code === 'Enter' && (chatList ?? []).length > 0) {\n\t\t\t\t\t\tconst item = document.querySelector(`[data-arrow-selected=\"true\"]`);\n\t\t\t\t\t\tif (item) {\n\t\t\t\t\t\t\titem?.click();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (e.code === 'ArrowDown') {\n\t\t\t\t\t\tselectedIdx = Math.min(selectedIdx + 1, (chatList ?? []).length - 1 + actions.length);\n\t\t\t\t\t} else if (e.code === 'ArrowUp') {\n\t\t\t\t\t\tselectedIdx = Math.max(selectedIdx - 1, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectedIdx = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst item = document.querySelector(`[data-arrow-selected=\"true\"]`);\n\t\t\t\t\titem?.scrollIntoView({ block: 'center', inline: 'nearest', behavior: 'instant' });\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\n\t\t<!-- <hr class=\"border-gray-50 dark:border-gray-850/30 my-1\" /> -->\n\n\t\t<div class=\"flex px-4 pb-1\">\n\t\t\t<div\n\t\t\t\tclass=\"flex flex-col overflow-y-auto h-96 md:h-[40rem] max-h-full scrollbar-hidden w-full flex-1 pr-2\"\n\t\t\t>\n\t\t\t\t<div class=\"w-full text-xs text-gray-500 dark:text-gray-500 font-medium pb-2 px-2\">\n\t\t\t\t\t{$i18n.t('Actions')}\n\t\t\t\t</div>\n\n\t\t\t\t{#each actions as action, idx (action.label)}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" w-full flex items-center rounded-xl text-sm py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-850 {selectedIdx ===\n\t\t\t\t\t\tidx\n\t\t\t\t\t\t\t? 'bg-gray-50 dark:bg-gray-850'\n\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\tdata-arrow-selected={selectedIdx === idx ? 'true' : undefined}\n\t\t\t\t\t\tdragabble=\"false\"\n\t\t\t\t\t\ton:mouseenter={() => {\n\t\t\t\t\t\t\tselectedIdx = idx;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\tawait action.onClick();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"pr-2\">\n\t\t\t\t\t\t\t<svelte:component this={action.icon} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\" flex-1 text-left\">\n\t\t\t\t\t\t\t<div class=\"text-ellipsis line-clamp-1 w-full\">\n\t\t\t\t\t\t\t\t{$i18n.t(action.label)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</button>\n\t\t\t\t{/each}\n\n\t\t\t\t{#if chatList}\n\t\t\t\t\t<hr class=\"border-gray-50 dark:border-gray-850/30 my-3\" />\n\n\t\t\t\t\t{#if chatList.length === 0}\n\t\t\t\t\t\t<div class=\"text-xs text-gray-500 dark:text-gray-400 text-center px-5 py-4\">\n\t\t\t\t\t\t\t{$i18n.t('No results found')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#each chatList as chat, idx (chat.id)}\n\t\t\t\t\t\t{#if idx === 0 || (idx > 0 && chat.time_range !== chatList[idx - 1].time_range)}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"w-full text-xs text-gray-500 dark:text-gray-500 font-medium {idx === 0\n\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t: 'pt-5'} pb-2 px-2\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{$i18n.t(chat.time_range)}\n\t\t\t\t\t\t\t\t<!-- localisation keys for time_range to be recognized from the i18next parser (so they don't get automatically removed):\n\t\t\t\t\t\t\t{$i18n.t('Today')}\n\t\t\t\t\t\t\t{$i18n.t('Yesterday')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 7 days')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 30 days')}\n\t\t\t\t\t\t\t{$i18n.t('January')}\n\t\t\t\t\t\t\t{$i18n.t('February')}\n\t\t\t\t\t\t\t{$i18n.t('March')}\n\t\t\t\t\t\t\t{$i18n.t('April')}\n\t\t\t\t\t\t\t{$i18n.t('May')}\n\t\t\t\t\t\t\t{$i18n.t('June')}\n\t\t\t\t\t\t\t{$i18n.t('July')}\n\t\t\t\t\t\t\t{$i18n.t('August')}\n\t\t\t\t\t\t\t{$i18n.t('September')}\n\t\t\t\t\t\t\t{$i18n.t('October')}\n\t\t\t\t\t\t\t{$i18n.t('November')}\n\t\t\t\t\t\t\t{$i18n.t('December')}\n\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclass=\" w-full flex justify-between items-center rounded-xl text-sm py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-850 {selectedIdx ===\n\t\t\t\t\t\t\tidx + actions.length\n\t\t\t\t\t\t\t\t? 'bg-gray-50 dark:bg-gray-850'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\thref=\"/c/{chat.id}\"\n\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\tdata-arrow-selected={selectedIdx === idx + actions.length ? 'true' : undefined}\n\t\t\t\t\t\t\ton:mouseenter={() => {\n\t\t\t\t\t\t\t\tselectedIdx = idx + actions.length;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\tawait goto(`/c/${chat.id}`);\n\t\t\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" flex-1\">\n\t\t\t\t\t\t\t\t<div class=\"text-ellipsis line-clamp-1 w-full\">\n\t\t\t\t\t\t\t\t\t{chat?.title}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\" pl-3 shrink-0 text-gray-500 dark:text-gray-400 text-xs\">\n\t\t\t\t\t\t\t\t{$i18n.t(\n\t\t\t\t\t\t\t\t\tdayjs(chat?.updated_at * 1000).calendar(null, {\n\t\t\t\t\t\t\t\t\t\tsameDay: '[Today]',\n\t\t\t\t\t\t\t\t\t\tnextDay: '[Tomorrow]',\n\t\t\t\t\t\t\t\t\t\tnextWeek: 'dddd',\n\t\t\t\t\t\t\t\t\t\tlastDay: '[Yesterday]',\n\t\t\t\t\t\t\t\t\t\tlastWeek: '[Last] dddd',\n\t\t\t\t\t\t\t\t\t\tsameElse: 'L' // use localized format, otherwise dayjs.calendar() defaults to DD/MM/YYYY\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t{/each}\n\n\t\t\t\t\t{#if !allChatsLoaded}\n\t\t\t\t\t\t<Loader\n\t\t\t\t\t\t\ton:visible={(e) => {\n\t\t\t\t\t\t\t\tif (!chatListLoading) {\n\t\t\t\t\t\t\t\t\tloadMoreChats();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"w-full flex justify-center py-4 text-xs animate-pulse items-center gap-2\">\n\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t\t<div class=\" \">{$i18n.t('Loading...')}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Loader>\n\t\t\t\t\t{/if}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"w-full h-full flex justify-center items-center\">\n\t\t\t\t\t\t<Spinner className=\"size-5\" />\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tid=\"chat-preview\"\n\t\t\t\tclass=\"hidden md:flex md:flex-1 w-full overflow-y-auto h-96 md:h-[40rem] scrollbar-hidden\"\n\t\t\t>\n\t\t\t\t{#if messages === null}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"w-full h-full flex justify-center items-center text-gray-500 dark:text-gray-400 text-sm\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{$i18n.t('Select a conversation to preview')}\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"w-full h-full flex flex-col\">\n\t\t\t\t\t\t<Messages\n\t\t\t\t\t\t\tclassName=\"h-full flex pt-4 pb-8 w-full\"\n\t\t\t\t\t\t\tchatId={`chat-preview-${selectedChat?.id ?? ''}`}\n\t\t\t\t\t\t\tuser={$user}\n\t\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\t\t{selectedModels}\n\t\t\t\t\t\t\tbind:history\n\t\t\t\t\t\t\tbind:messages\n\t\t\t\t\t\t\tautoScroll={true}\n\t\t\t\t\t\t\tsendMessage={() => {}}\n\t\t\t\t\t\t\tcontinueResponse={() => {}}\n\t\t\t\t\t\t\tregenerateResponse={() => {}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n","<script lang=\"ts\">\n\timport { getContext } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport { WEBUI_API_BASE_URL, WEBUI_BASE_URL } from '$lib/constants';\n\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport PinSlash from '$lib/components/icons/PinSlash.svelte';\n\n\texport let model = null;\n\texport let shiftKey = false;\n\texport let onClick = () => {};\n\texport let onUnpin = () => {};\n\n\tlet mouseOver = false;\n</script>\n\n{#if model}\n\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t<div\n\t\tclass=\" flex justify-center text-gray-800 dark:text-gray-200 cursor-grab relative group\"\n\t\tdata-id={model?.id}\n\t\ton:mouseenter={(e) => {\n\t\t\tmouseOver = true;\n\t\t}}\n\t\ton:mouseleave={(e) => {\n\t\t\tmouseOver = false;\n\t\t}}\n\t>\n\t\t<a\n\t\t\tclass=\"grow flex items-center space-x-2.5 rounded-xl px-2.5 py-[7px] group-hover:bg-gray-100 dark:group-hover:bg-gray-900 transition\"\n\t\t\thref=\"/?model={model?.id}\"\n\t\t\ton:click={onClick}\n\t\t\tdraggable=\"false\"\n\t\t>\n\t\t\t<div class=\"self-center shrink-0\">\n\t\t\t\t<img\n\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/models/model/profile/image?id=${model.id}&lang=${$i18n.language}`}\n\t\t\t\t\tclass=\" size-5 rounded-full -translate-x-[0.5px]\"\n\t\t\t\t\talt=\"logo\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex self-center translate-y-[0.5px]\">\n\t\t\t\t<div class=\" self-center text-sm font-primary line-clamp-1\">\n\t\t\t\t\t{model?.name ?? model.id}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</a>\n\n\t\t{#if mouseOver && shiftKey && onUnpin}\n\t\t\t<div class=\"absolute right-5 top-2.5\">\n\t\t\t\t<div class=\" flex items-center self-center space-x-1.5\">\n\t\t\t\t\t<Tooltip content={$i18n.t('Unpin')} className=\"flex items-center\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tonUnpin();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<PinSlash className=\"size-3.5\" strokeWidth=\"2\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n{/if}\n","<script>\n\timport Sortable from 'sortablejs';\n\n\timport { onDestroy, onMount, tick } from 'svelte';\n\n\timport { chatId, config, mobile, models, settings, showSidebar } from '$lib/stores';\n\timport { WEBUI_BASE_URL } from '$lib/constants';\n\timport { updateUserSettings } from '$lib/apis/users';\n\timport PinnedModelItem from './PinnedModelItem.svelte';\n\n\texport let selectedChatId = null;\n\texport let shiftKey = false;\n\n\tlet pinnedModels = [];\n\n\tconst initPinnedModelsSortable = () => {\n\t\tconst pinnedModelsList = document.getElementById('pinned-models-list');\n\t\tif (pinnedModelsList && !$mobile) {\n\t\t\tnew Sortable(pinnedModelsList, {\n\t\t\t\tanimation: 150,\n\t\t\t\tonUpdate: async (event) => {\n\t\t\t\t\tconst modelId = event.item.dataset.id;\n\t\t\t\t\tconst newIndex = event.newIndex;\n\n\t\t\t\t\tconst pinnedModels = $settings.pinnedModels;\n\t\t\t\t\tconst oldIndex = pinnedModels.indexOf(modelId);\n\n\t\t\t\t\tpinnedModels.splice(oldIndex, 1);\n\t\t\t\t\tpinnedModels.splice(newIndex, 0, modelId);\n\n\t\t\t\t\tsettings.set({ ...$settings, pinnedModels: pinnedModels });\n\t\t\t\t\tawait updateUserSettings(localStorage.token, { ui: $settings });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tlet unsubscribeSettings;\n\n\tonMount(async () => {\n\t\tpinnedModels = $settings?.pinnedModels ?? [];\n\n\t\tif (pinnedModels.length === 0 && $config?.default_pinned_models) {\n\t\t\tconst defaultPinnedModels = ($config?.default_pinned_models).split(',').filter((id) => id);\n\t\t\tpinnedModels = defaultPinnedModels.filter((id) => $models.find((model) => model.id === id));\n\n\t\t\tsettings.set({ ...$settings, pinnedModels });\n\t\t\tawait updateUserSettings(localStorage.token, { ui: $settings });\n\t\t}\n\n\t\tunsubscribeSettings = settings.subscribe((value) => {\n\t\t\tpinnedModels = value?.pinnedModels ?? [];\n\t\t});\n\n\t\tawait tick();\n\t\tinitPinnedModelsSortable();\n\t});\n\n\tonDestroy(() => {\n\t\tif (unsubscribeSettings) {\n\t\t\tunsubscribeSettings();\n\t\t}\n\t});\n</script>\n\n<div class=\"mt-0.5 pb-1.5\" id=\"pinned-models-list\">\n\t{#each pinnedModels as modelId (modelId)}\n\t\t{@const model = $models.find((model) => model.id === modelId)}\n\t\t{#if model}\n\t\t\t<PinnedModelItem\n\t\t\t\t{model}\n\t\t\t\t{shiftKey}\n\t\t\t\tonClick={() => {\n\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\tchatId.set('');\n\t\t\t\t\tif ($mobile) {\n\t\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\tonUnpin={($settings?.pinnedModels ?? []).includes(modelId)\n\t\t\t\t\t? () => {\n\t\t\t\t\t\t\tconst pinnedModels = $settings.pinnedModels.filter((id) => id !== modelId);\n\t\t\t\t\t\t\tsettings.set({ ...$settings, pinnedModels });\n\t\t\t\t\t\t\tupdateUserSettings(localStorage.token, { ui: $settings });\n\t\t\t\t\t\t}\n\t\t\t\t\t: null}\n\t\t\t/>\n\t\t{/if}\n\t{/each}\n</div>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n>\n\t<path\n\t\tstroke=\"currentColor\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"M10 3v4a1 1 0 0 1-1 1H5m4 8h6m-6-4h6m4-8v16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V7.914a1 1 0 0 1 .293-.707l3.914-3.914A1 1 0 0 1 9.914 3H18a1 1 0 0 1 1 1Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { onMount } from 'svelte';\n\timport { shortcuts } from '$lib/shortcuts';\n\timport { settings } from '$lib/stores';\n\n\texport let name: string;\n\texport let className = '';\n\n\tlet isMac = false;\n\tlet mounted = false;\n\tlet keys: string[] = [];\n\tlet isVisible = true;\n\n\tonMount(() => {\n\t\tisMac = /Mac/i.test(navigator.userAgent);\n\t\tkeys = shortcuts[name]?.keys ?? [];\n\t\tmounted = true;\n\t});\n\n\tfunction formatKey(key: string): string {\n\t\tconst lowerKey = key.toLowerCase();\n\n\t\tif (lowerKey === 'mod') return isMac ? '' : 'Ctrl';\n\t\tif (lowerKey === 'shift') return isMac ? '' : 'Shift';\n\t\tif (lowerKey.startsWith('key')) return key.slice(-1);\n\n\t\treturn key;\n\t}\n</script>\n\n{#if mounted && isVisible}\n\t<div\n\t\tclass=\"hidden md:flex items-center self-center text-xs text-gray-400 dark:text-gray-600 {className}\"\n\t>\n\t\t<span>{keys.map(formatKey).join(isMac ? '' : '+')}</span>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { v4 as uuidv4 } from 'uuid';\n\n\timport { goto } from '$app/navigation';\n\timport {\n\t\tuser,\n\t\tchats,\n\t\tsettings,\n\t\tshowSettings,\n\t\tchatId,\n\t\ttags,\n\t\tfolders as _folders,\n\t\tshowSidebar,\n\t\tshowSearch,\n\t\tmobile,\n\t\tshowArchivedChats,\n\t\tpinnedChats,\n\t\tscrollPaginationEnabled,\n\t\tcurrentChatPage,\n\t\ttemporaryChatEnabled,\n\t\tchannels,\n\t\tsocket,\n\t\tconfig,\n\t\tisApp,\n\t\tmodels,\n\t\tselectedFolder,\n\t\tWEBUI_NAME,\n\t\tsidebarWidth\n\t} from '$lib/stores';\n\timport { onMount, getContext, tick, onDestroy } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport {\n\t\tgetChatList,\n\t\tgetAllTags,\n\t\tgetPinnedChatList,\n\t\ttoggleChatPinnedStatusById,\n\t\tgetChatById,\n\t\tupdateChatFolderIdById,\n\t\timportChats\n\t} from '$lib/apis/chats';\n\timport { createNewFolder, getFolders, updateFolderParentIdById } from '$lib/apis/folders';\n\timport { WEBUI_API_BASE_URL, WEBUI_BASE_URL } from '$lib/constants';\n\n\timport ArchivedChatsModal from './ArchivedChatsModal.svelte';\n\timport UserMenu from './Sidebar/UserMenu.svelte';\n\timport ChatItem from './Sidebar/ChatItem.svelte';\n\timport Spinner from '../common/Spinner.svelte';\n\timport Loader from '../common/Loader.svelte';\n\timport Folder from '../common/Folder.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport Folders from './Sidebar/Folders.svelte';\n\timport { getChannels, createNewChannel } from '$lib/apis/channels';\n\timport ChannelModal from './Sidebar/ChannelModal.svelte';\n\timport ChannelItem from './Sidebar/ChannelItem.svelte';\n\timport PencilSquare from '../icons/PencilSquare.svelte';\n\timport Search from '../icons/Search.svelte';\n\timport SearchModal from './SearchModal.svelte';\n\timport FolderModal from './Sidebar/Folders/FolderModal.svelte';\n\timport Sidebar from '../icons/Sidebar.svelte';\n\timport PinnedModelList from './Sidebar/PinnedModelList.svelte';\n\timport Note from '../icons/Note.svelte';\n\timport { slide } from 'svelte/transition';\n\timport HotkeyHint from '../common/HotkeyHint.svelte';\n\n\tconst BREAKPOINT = 768;\n\n\tlet scrollTop = 0;\n\n\tlet navElement;\n\tlet shiftKey = false;\n\n\tlet selectedChatId = null;\n\tlet showCreateChannel = false;\n\n\t// Pagination variables\n\tlet chatListLoading = false;\n\tlet allChatsLoaded = false;\n\n\tlet showCreateFolderModal = false;\n\n\tlet pinnedModels = [];\n\n\tlet showPinnedModels = false;\n\tlet showChannels = false;\n\tlet showFolders = false;\n\n\tlet folders = {};\n\tlet folderRegistry = {};\n\n\tlet newFolderId = null;\n\n\t$: if ($selectedFolder) {\n\t\tinitFolders();\n\t}\n\n\tconst initFolders = async () => {\n\t\tif ($config?.features?.enable_folders === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst folderList = await getFolders(localStorage.token).catch((error) => {\n\t\t\treturn [];\n\t\t});\n\t\t_folders.set(folderList.sort((a, b) => b.updated_at - a.updated_at));\n\n\t\tfolders = {};\n\n\t\t// First pass: Initialize all folder entries\n\t\tfor (const folder of folderList) {\n\t\t\t// Ensure folder is added to folders with its data\n\t\t\tfolders[folder.id] = { ...(folders[folder.id] || {}), ...folder };\n\n\t\t\tif (newFolderId && folder.id === newFolderId) {\n\t\t\t\tfolders[folder.id].new = true;\n\t\t\t\tnewFolderId = null;\n\t\t\t}\n\t\t}\n\n\t\t// Second pass: Tie child folders to their parents\n\t\tfor (const folder of folderList) {\n\t\t\tif (folder.parent_id) {\n\t\t\t\t// Ensure the parent folder is initialized if it doesn't exist\n\t\t\t\tif (!folders[folder.parent_id]) {\n\t\t\t\t\tfolders[folder.parent_id] = {}; // Create a placeholder if not already present\n\t\t\t\t}\n\n\t\t\t\t// Initialize childrenIds array if it doesn't exist and add the current folder id\n\t\t\t\tfolders[folder.parent_id].childrenIds = folders[folder.parent_id].childrenIds\n\t\t\t\t\t? [...folders[folder.parent_id].childrenIds, folder.id]\n\t\t\t\t\t: [folder.id];\n\n\t\t\t\t// Sort the children by updated_at field\n\t\t\t\tfolders[folder.parent_id].childrenIds.sort((a, b) => {\n\t\t\t\t\treturn folders[b].updated_at - folders[a].updated_at;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tconst createFolder = async ({ name, data }) => {\n\t\tname = name?.trim();\n\t\tif (!name) {\n\t\t\ttoast.error($i18n.t('Folder name cannot be empty.'));\n\t\t\treturn;\n\t\t}\n\n\t\tconst rootFolders = Object.values(folders).filter((folder) => folder.parent_id === null);\n\t\tif (rootFolders.find((folder) => folder.name.toLowerCase() === name.toLowerCase())) {\n\t\t\t// If a folder with the same name already exists, append a number to the name\n\t\t\tlet i = 1;\n\t\t\twhile (\n\t\t\t\trootFolders.find((folder) => folder.name.toLowerCase() === `${name} ${i}`.toLowerCase())\n\t\t\t) {\n\t\t\t\ti++;\n\t\t\t}\n\n\t\t\tname = `${name} ${i}`;\n\t\t}\n\n\t\t// Add a dummy folder to the list to show the user that the folder is being created\n\t\tconst tempId = uuidv4();\n\t\tfolders = {\n\t\t\t...folders,\n\t\t\ttempId: {\n\t\t\t\tid: tempId,\n\t\t\t\tname: name,\n\t\t\t\tcreated_at: Date.now(),\n\t\t\t\tupdated_at: Date.now()\n\t\t\t}\n\t\t};\n\n\t\tconst res = await createNewFolder(localStorage.token, {\n\t\t\tname,\n\t\t\tdata\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\t// newFolderId = res.id;\n\t\t\tawait initFolders();\n\t\t\tshowFolders = true;\n\t\t}\n\t};\n\n\tconst initChannels = async () => {\n\t\t// default (none), group, dm type\n\t\tconst res = await getChannels(localStorage.token).catch((error) => {\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tawait channels.set(\n\t\t\t\tres.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t['', null, 'group', 'dm'].indexOf(a.type) - ['', null, 'group', 'dm'].indexOf(b.type)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n\n\tconst initChatList = async () => {\n\t\t// Reset pagination variables\n\t\tconsole.log('initChatList');\n\t\tcurrentChatPage.set(1);\n\t\tallChatsLoaded = false;\n\t\tscrollPaginationEnabled.set(false);\n\n\t\tinitFolders();\n\t\tawait Promise.all([\n\t\t\tawait (async () => {\n\t\t\t\tconsole.log('Init tags');\n\t\t\t\tconst _tags = await getAllTags(localStorage.token);\n\t\t\t\ttags.set(_tags);\n\t\t\t})(),\n\t\t\tawait (async () => {\n\t\t\t\tconsole.log('Init pinned chats');\n\t\t\t\tconst _pinnedChats = await getPinnedChatList(localStorage.token);\n\t\t\t\tpinnedChats.set(_pinnedChats);\n\t\t\t})(),\n\t\t\tawait (async () => {\n\t\t\t\tconsole.log('Init chat list');\n\t\t\t\tconst _chats = await getChatList(localStorage.token, $currentChatPage);\n\t\t\t\tawait chats.set(_chats);\n\t\t\t})()\n\t\t]);\n\n\t\t// Enable pagination\n\t\tscrollPaginationEnabled.set(true);\n\t};\n\n\tconst loadMoreChats = async () => {\n\t\tchatListLoading = true;\n\n\t\tcurrentChatPage.set($currentChatPage + 1);\n\n\t\tlet newChatList = [];\n\n\t\tnewChatList = await getChatList(localStorage.token, $currentChatPage);\n\n\t\t// once the bottom of the list has been reached (no results) there is no need to continue querying\n\t\tallChatsLoaded = newChatList.length === 0;\n\t\tawait chats.set([...($chats ? $chats : []), ...newChatList]);\n\n\t\tchatListLoading = false;\n\t};\n\n\tconst importChatHandler = async (items, pinned = false, folderId = null) => {\n\t\tconsole.log('importChatHandler', items, pinned, folderId);\n\t\tfor (const item of items) {\n\t\t\tconsole.log(item);\n\t\t\tif (item.chat) {\n\t\t\t\tawait importChats(localStorage.token, [\n\t\t\t\t\t{\n\t\t\t\t\t\tchat: item.chat,\n\t\t\t\t\t\tmeta: item?.meta ?? {},\n\t\t\t\t\t\tpinned: pinned,\n\t\t\t\t\t\tfolder_id: folderId,\n\t\t\t\t\t\tcreated_at: item?.created_at ?? null,\n\t\t\t\t\t\tupdated_at: item?.updated_at ?? null\n\t\t\t\t\t}\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\n\t\tinitChatList();\n\t};\n\n\tconst inputFilesHandler = async (files) => {\n\t\tconsole.log(files);\n\n\t\tfor (const file of files) {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = async (e) => {\n\t\t\t\tconst content = e.target.result;\n\n\t\t\t\ttry {\n\t\t\t\t\tconst chatItems = JSON.parse(content);\n\t\t\t\t\timportChatHandler(chatItems);\n\t\t\t\t} catch {\n\t\t\t\t\ttoast.error($i18n.t(`Invalid file format.`));\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treader.readAsText(file);\n\t\t}\n\t};\n\n\tconst tagEventHandler = async (type, tagName, chatId) => {\n\t\tconsole.log(type, tagName, chatId);\n\t\tif (type === 'delete') {\n\t\t\tinitChatList();\n\t\t} else if (type === 'add') {\n\t\t\tinitChatList();\n\t\t}\n\t};\n\n\tlet draggedOver = false;\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\n\t\t// Check if a file is being draggedOver.\n\t\tif (e.dataTransfer?.types?.includes('Files')) {\n\t\t\tdraggedOver = true;\n\t\t} else {\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = () => {\n\t\tdraggedOver = false;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\t\tconsole.log(e); // Log the drop event\n\n\t\t// Perform file drop check and handle it accordingly\n\t\tif (e.dataTransfer?.files) {\n\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\n\n\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\tconsole.log(inputFiles); // Log the dropped files\n\t\t\t\tinputFilesHandler(inputFiles); // Handle the dropped files\n\t\t\t}\n\t\t}\n\n\t\tdraggedOver = false; // Reset draggedOver status after drop\n\t};\n\n\tlet touchstart;\n\tlet touchend;\n\n\tfunction checkDirection() {\n\t\tconst screenWidth = window.innerWidth;\n\t\tconst swipeDistance = Math.abs(touchend.screenX - touchstart.screenX);\n\t\tif (touchstart.clientX < 40 && swipeDistance >= screenWidth / 8) {\n\t\t\tif (touchend.screenX < touchstart.screenX) {\n\t\t\t\tshowSidebar.set(false);\n\t\t\t}\n\t\t\tif (touchend.screenX > touchstart.screenX) {\n\t\t\t\tshowSidebar.set(true);\n\t\t\t}\n\t\t}\n\t}\n\n\tconst onTouchStart = (e) => {\n\t\ttouchstart = e.changedTouches[0];\n\t\tconsole.log(touchstart.clientX);\n\t};\n\n\tconst onTouchEnd = (e) => {\n\t\ttouchend = e.changedTouches[0];\n\t\tcheckDirection();\n\t};\n\n\tconst onKeyDown = (e) => {\n\t\tif (e.key === 'Shift') {\n\t\t\tshiftKey = true;\n\t\t}\n\t};\n\n\tconst onKeyUp = (e) => {\n\t\tif (e.key === 'Shift') {\n\t\t\tshiftKey = false;\n\t\t}\n\t};\n\n\tconst onFocus = () => {};\n\n\tconst onBlur = () => {\n\t\tshiftKey = false;\n\t\tselectedChatId = null;\n\t};\n\n\tconst MIN_WIDTH = 220;\n\tconst MAX_WIDTH = 480;\n\n\tlet isResizing = false;\n\n\tlet startWidth = 0;\n\tlet startClientX = 0;\n\n\tconst resizeStartHandler = (e: MouseEvent) => {\n\t\tif ($mobile) return;\n\t\tisResizing = true;\n\n\t\tstartClientX = e.clientX;\n\t\tstartWidth = $sidebarWidth ?? 260;\n\n\t\tdocument.body.style.userSelect = 'none';\n\t};\n\n\tconst resizeEndHandler = () => {\n\t\tif (!isResizing) return;\n\t\tisResizing = false;\n\n\t\tdocument.body.style.userSelect = '';\n\t\tlocalStorage.setItem('sidebarWidth', String($sidebarWidth));\n\t};\n\n\tconst resizeSidebarHandler = (endClientX) => {\n\t\tconst dx = endClientX - startClientX;\n\t\tconst newSidebarWidth = Math.min(MAX_WIDTH, Math.max(MIN_WIDTH, startWidth + dx));\n\n\t\tsidebarWidth.set(newSidebarWidth);\n\t\tdocument.documentElement.style.setProperty('--sidebar-width', `${newSidebarWidth}px`);\n\t};\n\n\tlet unsubscribers = [];\n\n\tonMount(async () => {\n\t\ttry {\n\t\t\tconst width = Number(localStorage.getItem('sidebarWidth'));\n\t\t\tif (!Number.isNaN(width) && width >= MIN_WIDTH && width <= MAX_WIDTH) {\n\t\t\t\tsidebarWidth.set(width);\n\t\t\t}\n\t\t} catch {}\n\n\t\tdocument.documentElement.style.setProperty('--sidebar-width', `${$sidebarWidth}px`);\n\t\tsidebarWidth.subscribe((w) => {\n\t\t\tdocument.documentElement.style.setProperty('--sidebar-width', `${w}px`);\n\t\t});\n\n\t\tawait showSidebar.set(!$mobile ? localStorage.sidebar === 'true' : false);\n\n\t\tunsubscribers = [\n\t\t\tmobile.subscribe((value) => {\n\t\t\t\tif ($showSidebar && value) {\n\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t}\n\n\t\t\t\tif ($showSidebar && !value) {\n\t\t\t\t\tconst navElement = document.getElementsByTagName('nav')[0];\n\t\t\t\t\tif (navElement) {\n\t\t\t\t\t\tnavElement.style['-webkit-app-region'] = 'drag';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}),\n\t\t\tshowSidebar.subscribe(async (value) => {\n\t\t\t\tlocalStorage.sidebar = value;\n\n\t\t\t\t// nav element is not available on the first render\n\t\t\t\tconst navElement = document.getElementsByTagName('nav')[0];\n\n\t\t\t\tif (navElement) {\n\t\t\t\t\tif ($mobile) {\n\t\t\t\t\t\tif (!value) {\n\t\t\t\t\t\t\tnavElement.style['-webkit-app-region'] = 'drag';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnavElement.style['-webkit-app-region'] = 'no-drag';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnavElement.style['-webkit-app-region'] = 'drag';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (value) {\n\t\t\t\t\t// Only fetch channels if the feature is enabled and user has permission\n\t\t\t\t\tif (\n\t\t\t\t\t\t$config?.features?.enable_channels &&\n\t\t\t\t\t\t($user?.role === 'admin' || ($user?.permissions?.features?.channels ?? true))\n\t\t\t\t\t) {\n\t\t\t\t\t\tawait initChannels();\n\t\t\t\t\t}\n\t\t\t\t\tawait initChatList();\n\t\t\t\t}\n\t\t\t}),\n\t\t\tsettings.subscribe((value) => {\n\t\t\t\tif (pinnedModels != value?.pinnedModels ?? []) {\n\t\t\t\t\tpinnedModels = value?.pinnedModels ?? [];\n\t\t\t\t\tshowPinnedModels = pinnedModels.length > 0;\n\t\t\t\t}\n\t\t\t})\n\t\t];\n\n\t\twindow.addEventListener('keydown', onKeyDown);\n\t\twindow.addEventListener('keyup', onKeyUp);\n\n\t\twindow.addEventListener('touchstart', onTouchStart);\n\t\twindow.addEventListener('touchend', onTouchEnd);\n\n\t\twindow.addEventListener('focus', onFocus);\n\t\twindow.addEventListener('blur', onBlur);\n\n\t\tconst dropZone = document.getElementById('sidebar');\n\n\t\tdropZone?.addEventListener('dragover', onDragOver);\n\t\tdropZone?.addEventListener('drop', onDrop);\n\t\tdropZone?.addEventListener('dragleave', onDragLeave);\n\t});\n\n\tonDestroy(() => {\n\t\tif (unsubscribers && unsubscribers.length > 0) {\n\t\t\tunsubscribers.forEach((unsubscriber) => {\n\t\t\t\tif (unsubscriber) {\n\t\t\t\t\tunsubscriber();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\twindow.removeEventListener('keydown', onKeyDown);\n\t\twindow.removeEventListener('keyup', onKeyUp);\n\n\t\twindow.removeEventListener('touchstart', onTouchStart);\n\t\twindow.removeEventListener('touchend', onTouchEnd);\n\n\t\twindow.removeEventListener('focus', onFocus);\n\t\twindow.removeEventListener('blur', onBlur);\n\n\t\tconst dropZone = document.getElementById('sidebar');\n\n\t\tdropZone?.removeEventListener('dragover', onDragOver);\n\t\tdropZone?.removeEventListener('drop', onDrop);\n\t\tdropZone?.removeEventListener('dragleave', onDragLeave);\n\t});\n\n\tconst newChatHandler = async () => {\n\t\tselectedChatId = null;\n\t\tselectedFolder.set(null);\n\n\t\tif ($user?.role !== 'admin' && $user?.permissions?.chat?.temporary_enforced) {\n\t\t\tawait temporaryChatEnabled.set(true);\n\t\t} else {\n\t\t\tawait temporaryChatEnabled.set(false);\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif ($mobile) {\n\t\t\t\tshowSidebar.set(false);\n\t\t\t}\n\t\t}, 0);\n\t};\n\n\tconst itemClickHandler = async () => {\n\t\tselectedChatId = null;\n\t\tchatId.set('');\n\n\t\tif ($mobile) {\n\t\t\tshowSidebar.set(false);\n\t\t}\n\n\t\tawait tick();\n\t};\n\n\tconst isWindows = /Windows/i.test(navigator.userAgent);\n</script>\n\n<ArchivedChatsModal\n\tbind:show={$showArchivedChats}\n\tonUpdate={async () => {\n\t\tawait initChatList();\n\t}}\n/>\n\n<ChannelModal\n\tbind:show={showCreateChannel}\n\tonSubmit={async ({ type, name, is_private, access_control, group_ids, user_ids }) => {\n\t\tname = name?.trim();\n\n\t\tif (type === 'dm') {\n\t\t\tif (!user_ids || user_ids.length === 0) {\n\t\t\t\ttoast.error($i18n.t('Please select at least one user for Direct Message channel.'));\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tif (!name) {\n\t\t\t\ttoast.error($i18n.t('Channel name cannot be empty.'));\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst res = await createNewChannel(localStorage.token, {\n\t\t\ttype: type,\n\t\t\tname: name,\n\t\t\tis_private: is_private,\n\t\t\taccess_control: access_control,\n\t\t\tgroup_ids: group_ids,\n\t\t\tuser_ids: user_ids\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\t$socket.emit('join-channels', { auth: { token: $user?.token } });\n\t\t\tawait initChannels();\n\t\t\tshowCreateChannel = false;\n\t\t\tshowChannels = true;\n\t\t\tgoto(`/channels/${res.id}`);\n\t\t}\n\t}}\n/>\n\n<FolderModal\n\tbind:show={showCreateFolderModal}\n\tonSubmit={async (folder) => {\n\t\tawait createFolder(folder);\n\t\tshowCreateFolderModal = false;\n\t}}\n/>\n\n<!-- svelte-ignore a11y-no-static-element-interactions -->\n\n{#if $showSidebar}\n\t<div\n\t\tclass=\" {$isApp\n\t\t\t? ' ml-[4.5rem] md:ml-0'\n\t\t\t: ''} fixed md:hidden z-40 top-0 right-0 left-0 bottom-0 bg-black/60 w-full min-h-screen h-screen flex justify-center overflow-hidden overscroll-contain\"\n\t\ton:mousedown={() => {\n\t\t\tshowSidebar.set(!$showSidebar);\n\t\t}}\n\t/>\n{/if}\n\n<SearchModal\n\tbind:show={$showSearch}\n\tonClose={() => {\n\t\tif ($mobile) {\n\t\t\tshowSidebar.set(false);\n\t\t}\n\t}}\n/>\n\n<button\n\tid=\"sidebar-new-chat-button\"\n\tclass=\"hidden\"\n\ton:click={() => {\n\t\tgoto('/');\n\t\tnewChatHandler();\n\t}}\n/>\n\n<svelte:window\n\ton:mousemove={(e) => {\n\t\tif (!isResizing) return;\n\t\tresizeSidebarHandler(e.clientX);\n\t}}\n\ton:mouseup={() => {\n\t\tresizeEndHandler();\n\t}}\n/>\n\n{#if !$mobile && !$showSidebar}\n\t<div\n\t\tclass=\" pt-[7px] pb-2 px-2 flex flex-col justify-between text-black dark:text-white hover:bg-gray-50/30 dark:hover:bg-gray-950/30 h-full z-10 transition-all border-e-[0.5px] border-gray-50 dark:border-gray-850/30\"\n\t\tid=\"sidebar\"\n\t>\n\t\t<button\n\t\t\tclass=\"flex flex-col flex-1 {isWindows ? 'cursor-pointer' : 'cursor-[e-resize]'}\"\n\t\t\ton:click={async () => {\n\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t}}\n\t\t>\n\t\t\t<div class=\"pb-1.5\">\n\t\t\t\t<Tooltip\n\t\t\t\t\tcontent={$showSidebar ? $i18n.t('Close Sidebar') : $i18n.t('Open Sidebar')}\n\t\t\t\t\tplacement=\"right\"\n\t\t\t\t>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition group {isWindows\n\t\t\t\t\t\t\t? 'cursor-pointer'\n\t\t\t\t\t\t\t: 'cursor-[e-resize]'}\"\n\t\t\t\t\t\taria-label={$showSidebar ? $i18n.t('Close Sidebar') : $i18n.t('Open Sidebar')}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\" self-center flex items-center justify-center size-9\">\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc=\"{WEBUI_BASE_URL}/static/favicon.png\"\n\t\t\t\t\t\t\t\tclass=\"sidebar-new-chat-icon size-6 rounded-full group-hover:hidden\"\n\t\t\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<Sidebar className=\"size-5 hidden group-hover:flex\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\n\t\t\t<div class=\"-mt-[0.5px]\">\n\t\t\t\t<div class=\"\">\n\t\t\t\t\t<Tooltip content={$i18n.t('New Chat')} placement=\"right\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclass=\" cursor-pointer flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition group\"\n\t\t\t\t\t\t\thref=\"/\"\n\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\ton:click={async (e) => {\n\t\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\tgoto('/');\n\t\t\t\t\t\t\t\tnewChatHandler();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\taria-label={$i18n.t('New Chat')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" self-center flex items-center justify-center size-9\">\n\t\t\t\t\t\t\t\t<PencilSquare className=\"size-4.5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\n\t\t\t\t<div>\n\t\t\t\t\t<Tooltip content={$i18n.t('Search')} placement=\"right\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" cursor-pointer flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition group\"\n\t\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\tshowSearch.set(true);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\taria-label={$i18n.t('Search')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" self-center flex items-center justify-center size-9\">\n\t\t\t\t\t\t\t\t<Search className=\"size-4.5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\n\t\t\t\t{#if ($config?.features?.enable_notes ?? false) && ($user?.role === 'admin' || ($user?.permissions?.features?.notes ?? true))}\n\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Notes')} placement=\"right\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tclass=\" cursor-pointer flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition group\"\n\t\t\t\t\t\t\t\thref=\"/notes\"\n\t\t\t\t\t\t\t\ton:click={async (e) => {\n\t\t\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\tgoto('/notes');\n\t\t\t\t\t\t\t\t\titemClickHandler();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\taria-label={$i18n.t('Notes')}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center flex items-center justify-center size-9\">\n\t\t\t\t\t\t\t\t\t<Note className=\"size-4.5\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if $user?.role === 'admin' || $user?.permissions?.workspace?.models || $user?.permissions?.workspace?.knowledge || $user?.permissions?.workspace?.prompts || $user?.permissions?.workspace?.tools}\n\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Workspace')} placement=\"right\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tclass=\" cursor-pointer flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition group\"\n\t\t\t\t\t\t\t\thref=\"/workspace\"\n\t\t\t\t\t\t\t\ton:click={async (e) => {\n\t\t\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\tgoto('/workspace');\n\t\t\t\t\t\t\t\t\titemClickHandler();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\taria-label={$i18n.t('Workspace')}\n\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center flex items-center justify-center size-9\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"size-4.5\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</button>\n\n\t\t<div>\n\t\t\t<div>\n\t\t\t\t<div class=\" py-2 flex justify-center items-center\">\n\t\t\t\t\t{#if $user !== undefined && $user !== null}\n\t\t\t\t\t\t<UserMenu\n\t\t\t\t\t\t\trole={$user?.role}\n\t\t\t\t\t\t\tprofile={$config?.features?.enable_user_status ?? true}\n\t\t\t\t\t\t\tshowActiveUsers={false}\n\t\t\t\t\t\t\ton:show={(e) => {\n\t\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\n\t\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" cursor-pointer flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition group\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"self-center relative\">\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${$user?.id}/profile/image`}\n\t\t\t\t\t\t\t\t\t\tclass=\" size-7 object-cover rounded-full\"\n\t\t\t\t\t\t\t\t\t\talt={$i18n.t('Open User Profile Menu')}\n\t\t\t\t\t\t\t\t\t\taria-label={$i18n.t('Open User Profile Menu')}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t{#if $config?.features?.enable_user_status}\n\t\t\t\t\t\t\t\t\t\t<div class=\"absolute -bottom-0.5 -right-0.5\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"relative inline-flex size-2.5 rounded-full {true\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-green-500'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-gray-300 dark:bg-gray-700'} border-2 border-white dark:border-gray-900\"\n\t\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</UserMenu>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n\n<!-- {$i18n.t('New Folder')} -->\n<!-- {$i18n.t('Pinned')} -->\n\n{#if $showSidebar}\n\t<div\n\t\tbind:this={navElement}\n\t\tid=\"sidebar\"\n\t\tclass=\"h-screen max-h-[100dvh] min-h-screen select-none {$showSidebar\n\t\t\t? `${$mobile ? 'bg-gray-50 dark:bg-gray-950' : 'bg-gray-50/70 dark:bg-gray-950/70'} z-50`\n\t\t\t: ' bg-transparent z-0 '} {$isApp\n\t\t\t? `ml-[4.5rem] md:ml-0 `\n\t\t\t: ' transition-all duration-300 '} shrink-0 text-gray-900 dark:text-gray-200 text-sm fixed top-0 left-0 overflow-x-hidden\n        \"\n\t\ttransition:slide={{ duration: 250, axis: 'x' }}\n\t\tdata-state={$showSidebar}\n\t>\n\t\t<div\n\t\t\tclass=\" my-auto flex flex-col justify-between h-screen max-h-[100dvh] w-[var(--sidebar-width)] overflow-x-hidden scrollbar-hidden z-50 {$showSidebar\n\t\t\t\t? ''\n\t\t\t\t: 'invisible'}\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"sidebar px-[0.5625rem] pt-2 pb-1.5 flex justify-between space-x-1 text-gray-600 dark:text-gray-400 sticky top-0 z-10 -mb-3\"\n\t\t\t>\n\t\t\t\t<a\n\t\t\t\t\tclass=\"flex items-center rounded-xl size-8.5 h-full justify-center hover:bg-gray-100/50 dark:hover:bg-gray-850/50 transition no-drag-region\"\n\t\t\t\t\thref=\"/\"\n\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\ton:click={newChatHandler}\n\t\t\t\t>\n\t\t\t\t\t<img\n\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t\tsrc=\"{WEBUI_BASE_URL}/static/favicon.png\"\n\t\t\t\t\t\tclass=\"sidebar-new-chat-icon size-6 rounded-full\"\n\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t/>\n\t\t\t\t</a>\n\n\t\t\t\t<a href=\"/\" class=\"flex flex-1 px-1.5\" on:click={newChatHandler}>\n\t\t\t\t\t<div\n\t\t\t\t\t\tid=\"sidebar-webui-name\"\n\t\t\t\t\t\tclass=\" self-center font-medium text-gray-850 dark:text-white font-primary\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{$WEBUI_NAME}\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t\t<Tooltip\n\t\t\t\t\tcontent={$showSidebar ? $i18n.t('Close Sidebar') : $i18n.t('Open Sidebar')}\n\t\t\t\t\tplacement=\"bottom\"\n\t\t\t\t>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"flex rounded-xl size-8.5 justify-center items-center hover:bg-gray-100/50 dark:hover:bg-gray-850/50 transition {isWindows\n\t\t\t\t\t\t\t? 'cursor-pointer'\n\t\t\t\t\t\t\t: 'cursor-[w-resize]'}\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\taria-label={$showSidebar ? $i18n.t('Close Sidebar') : $i18n.t('Open Sidebar')}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\" self-center p-1.5\">\n\t\t\t\t\t\t\t<Sidebar />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\n\t\t\t\t<div\n\t\t\t\t\tclass=\"{scrollTop > 0\n\t\t\t\t\t\t? 'visible'\n\t\t\t\t\t\t: 'invisible'} sidebar-bg-gradient-to-b bg-linear-to-b from-gray-50 dark:from-gray-950 to-transparent from-50% pointer-events-none absolute inset-0 -z-10 -mb-6\"\n\t\t\t\t></div>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tclass=\"relative flex flex-col flex-1 overflow-y-auto scrollbar-hidden pt-3 pb-3\"\n\t\t\t\ton:scroll={(e) => {\n\t\t\t\t\tif (e.target.scrollTop === 0) {\n\t\t\t\t\t\tscrollTop = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscrollTop = e.target.scrollTop;\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div class=\"pb-1.5\">\n\t\t\t\t\t<div class=\"px-[0.4375rem] flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tid=\"sidebar-new-chat-button\"\n\t\t\t\t\t\t\tclass=\"group grow flex items-center space-x-3 rounded-2xl px-2.5 py-2 hover:bg-gray-100 dark:hover:bg-gray-900 transition outline-none\"\n\t\t\t\t\t\t\thref=\"/\"\n\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\ton:click={newChatHandler}\n\t\t\t\t\t\t\taria-label={$i18n.t('New Chat')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t\t\t\t<PencilSquare className=\" size-4.5\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"flex flex-1 self-center translate-y-[0.5px]\">\n\t\t\t\t\t\t\t\t<div class=\" self-center text-sm font-primary\">{$i18n.t('New Chat')}</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<HotkeyHint name=\"newChat\" className=\" group-hover:visible invisible\" />\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"px-[0.4375rem] flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tid=\"sidebar-search-button\"\n\t\t\t\t\t\t\tclass=\"group grow flex items-center space-x-3 rounded-2xl px-2.5 py-2 hover:bg-gray-100 dark:hover:bg-gray-900 transition outline-none\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tshowSearch.set(true);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\taria-label={$i18n.t('Search')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t\t\t\t<Search strokeWidth=\"2\" className=\"size-4.5\" />\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"flex flex-1 self-center translate-y-[0.5px]\">\n\t\t\t\t\t\t\t\t<div class=\" self-center text-sm font-primary\">{$i18n.t('Search')}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<HotkeyHint name=\"search\" className=\" group-hover:visible invisible\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if ($config?.features?.enable_notes ?? false) && ($user?.role === 'admin' || ($user?.permissions?.features?.notes ?? true))}\n\t\t\t\t\t\t<div class=\"px-[0.4375rem] flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tid=\"sidebar-notes-button\"\n\t\t\t\t\t\t\t\tclass=\"grow flex items-center space-x-3 rounded-2xl px-2.5 py-2 hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\t\t\t\thref=\"/notes\"\n\t\t\t\t\t\t\t\ton:click={itemClickHandler}\n\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\taria-label={$i18n.t('Notes')}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t\t\t\t\t<Note className=\"size-4.5\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"flex self-center translate-y-[0.5px]\">\n\t\t\t\t\t\t\t\t\t<div class=\" self-center text-sm font-primary\">{$i18n.t('Notes')}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if $user?.role === 'admin' || $user?.permissions?.workspace?.models || $user?.permissions?.workspace?.knowledge || $user?.permissions?.workspace?.prompts || $user?.permissions?.workspace?.tools}\n\t\t\t\t\t\t<div class=\"px-[0.4375rem] flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tid=\"sidebar-workspace-button\"\n\t\t\t\t\t\t\t\tclass=\"grow flex items-center space-x-3 rounded-2xl px-2.5 py-2 hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\t\t\t\thref=\"/workspace\"\n\t\t\t\t\t\t\t\ton:click={itemClickHandler}\n\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\taria-label={$i18n.t('Workspace')}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"size-4.5\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"flex self-center translate-y-[0.5px]\">\n\t\t\t\t\t\t\t\t\t<div class=\" self-center text-sm font-primary\">{$i18n.t('Workspace')}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t{#if ($models ?? []).length > 0 && (($settings?.pinnedModels ?? []).length > 0 || $config?.default_pinned_models)}\n\t\t\t\t\t<Folder\n\t\t\t\t\t\tid=\"sidebar-models\"\n\t\t\t\t\t\tbind:open={showPinnedModels}\n\t\t\t\t\t\tclassName=\"px-2 mt-0.5\"\n\t\t\t\t\t\tname={$i18n.t('Models')}\n\t\t\t\t\t\tchevron={false}\n\t\t\t\t\t\tdragAndDrop={false}\n\t\t\t\t\t>\n\t\t\t\t\t\t<PinnedModelList bind:selectedChatId {shiftKey} />\n\t\t\t\t\t</Folder>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if $config?.features?.enable_channels && ($user?.role === 'admin' || ($user?.permissions?.features?.channels ?? true))}\n\t\t\t\t\t<Folder\n\t\t\t\t\t\tid=\"sidebar-channels\"\n\t\t\t\t\t\tbind:open={showChannels}\n\t\t\t\t\t\tclassName=\"px-2 mt-0.5\"\n\t\t\t\t\t\tname={$i18n.t('Channels')}\n\t\t\t\t\t\tchevron={false}\n\t\t\t\t\t\tdragAndDrop={false}\n\t\t\t\t\t\tonAdd={$user?.role === 'admin' || ($user?.permissions?.features?.channels ?? true)\n\t\t\t\t\t\t\t? async () => {\n\t\t\t\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tshowCreateChannel = true;\n\t\t\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t: null}\n\t\t\t\t\t\tonAddLabel={$i18n.t('Create Channel')}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#each $channels as channel, channelIdx (`${channel?.id}`)}\n\t\t\t\t\t\t\t<ChannelItem\n\t\t\t\t\t\t\t\t{channel}\n\t\t\t\t\t\t\t\tonUpdate={async () => {\n\t\t\t\t\t\t\t\t\tawait initChannels();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t{#if channelIdx < $channels.length - 1 && channel.type !== $channels[channelIdx + 1]?.type}<hr\n\t\t\t\t\t\t\t\t\tclass=\" border-gray-100/40 dark:border-gray-800/10 my-1.5 w-full\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</Folder>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if $config?.features?.enable_folders && ($user?.role === 'admin' || ($user?.permissions?.features?.folders ?? true))}\n\t\t\t\t\t<Folder\n\t\t\t\t\t\tid=\"sidebar-folders\"\n\t\t\t\t\t\tbind:open={showFolders}\n\t\t\t\t\t\tclassName=\"px-2 mt-0.5\"\n\t\t\t\t\t\tname={$i18n.t('Folders')}\n\t\t\t\t\t\tchevron={false}\n\t\t\t\t\t\tonAdd={() => {\n\t\t\t\t\t\t\tshowCreateFolderModal = true;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonAddLabel={$i18n.t('New Folder')}\n\t\t\t\t\t\ton:drop={async (e) => {\n\t\t\t\t\t\t\tconst { type, id, item } = e.detail;\n\n\t\t\t\t\t\t\tif (type === 'folder') {\n\t\t\t\t\t\t\t\tif (folders[id].parent_id === null) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tconst res = await updateFolderParentIdById(localStorage.token, id, null).catch(\n\t\t\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\t\tawait initFolders();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Folders\n\t\t\t\t\t\t\tbind:folderRegistry\n\t\t\t\t\t\t\t{folders}\n\t\t\t\t\t\t\t{shiftKey}\n\t\t\t\t\t\t\tonDelete={(folderId) => {\n\t\t\t\t\t\t\t\tselectedFolder.set(null);\n\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:update={() => {\n\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:import={(e) => {\n\t\t\t\t\t\t\t\tconst { folderId, items } = e.detail;\n\t\t\t\t\t\t\t\timportChatHandler(items, false, folderId);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Folder>\n\t\t\t\t{/if}\n\n\t\t\t\t<Folder\n\t\t\t\t\tid=\"sidebar-chats\"\n\t\t\t\t\tclassName=\"px-2 mt-0.5\"\n\t\t\t\t\tname={$i18n.t('Chats')}\n\t\t\t\t\tchevron={false}\n\t\t\t\t\ton:change={async (e) => {\n\t\t\t\t\t\tselectedFolder.set(null);\n\t\t\t\t\t}}\n\t\t\t\t\ton:import={(e) => {\n\t\t\t\t\t\timportChatHandler(e.detail);\n\t\t\t\t\t}}\n\t\t\t\t\ton:drop={async (e) => {\n\t\t\t\t\t\tconst { type, id, item } = e.detail;\n\n\t\t\t\t\t\tif (type === 'chat') {\n\t\t\t\t\t\t\tlet chat = await getChatById(localStorage.token, id).catch((error) => {\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (!chat && item) {\n\t\t\t\t\t\t\t\tchat = await importChats(localStorage.token, [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tchat: item.chat,\n\t\t\t\t\t\t\t\t\t\tmeta: item?.meta ?? {},\n\t\t\t\t\t\t\t\t\t\tpinned: false,\n\t\t\t\t\t\t\t\t\t\tfolder_id: null,\n\t\t\t\t\t\t\t\t\t\tcreated_at: item?.created_at ?? null,\n\t\t\t\t\t\t\t\t\t\tupdated_at: item?.updated_at ?? null\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (chat) {\n\t\t\t\t\t\t\t\tconsole.log(chat);\n\t\t\t\t\t\t\t\tif (chat.folder_id) {\n\t\t\t\t\t\t\t\t\tconst res = await updateChatFolderIdById(localStorage.token, chat.id, null).catch(\n\t\t\t\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\tfolderRegistry[chat.folder_id]?.setFolderItems();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (chat.pinned) {\n\t\t\t\t\t\t\t\t\tconst res = await toggleChatPinnedStatusById(localStorage.token, chat.id);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (type === 'folder') {\n\t\t\t\t\t\t\tif (folders[id].parent_id === null) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst res = await updateFolderParentIdById(localStorage.token, id, null).catch(\n\t\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\tawait initFolders();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{#if $pinnedChats.length > 0}\n\t\t\t\t\t\t<div class=\"mb-1\">\n\t\t\t\t\t\t\t<div class=\"flex flex-col space-y-1 rounded-xl\">\n\t\t\t\t\t\t\t\t<Folder\n\t\t\t\t\t\t\t\t\tid=\"sidebar-pinned-chats\"\n\t\t\t\t\t\t\t\t\tbuttonClassName=\" text-gray-500\"\n\t\t\t\t\t\t\t\t\ton:import={(e) => {\n\t\t\t\t\t\t\t\t\t\timportChatHandler(e.detail, true);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ton:drop={async (e) => {\n\t\t\t\t\t\t\t\t\t\tconst { type, id, item } = e.detail;\n\n\t\t\t\t\t\t\t\t\t\tif (type === 'chat') {\n\t\t\t\t\t\t\t\t\t\t\tlet chat = await getChatById(localStorage.token, id).catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tif (!chat && item) {\n\t\t\t\t\t\t\t\t\t\t\t\tchat = await importChats(localStorage.token, [\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat: item.chat,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmeta: item?.meta ?? {},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpinned: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfolder_id: null,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcreated_at: item?.created_at ?? null,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tupdated_at: item?.updated_at ?? null\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif (chat) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(chat);\n\t\t\t\t\t\t\t\t\t\t\t\tif (chat.folder_id) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst res = await updateChatFolderIdById(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.id,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (!chat.pinned) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst res = await toggleChatPinnedStatusById(localStorage.token, chat.id);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tname={$i18n.t('Pinned')}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"ml-3 pl-1 mt-[1px] flex flex-col overflow-y-auto scrollbar-hidden border-s border-gray-100 dark:border-gray-900 text-gray-900 dark:text-gray-200\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{#each $pinnedChats as chat, idx (`pinned-chat-${chat?.id ?? idx}`)}\n\t\t\t\t\t\t\t\t\t\t\t<ChatItem\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\tid={chat.id}\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={chat.title}\n\t\t\t\t\t\t\t\t\t\t\t\t{shiftKey}\n\t\t\t\t\t\t\t\t\t\t\t\tselected={selectedChatId === chat.id}\n\t\t\t\t\t\t\t\t\t\t\t\ton:select={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectedChatId = chat.id;\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\ton:unselect={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\ton:tag={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst { type, name } = e.detail;\n\t\t\t\t\t\t\t\t\t\t\t\t\ttagEventHandler(type, name, chat.id);\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Folder>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div class=\" flex-1 flex flex-col overflow-y-auto scrollbar-hidden\">\n\t\t\t\t\t\t<div class=\"pt-1.5\">\n\t\t\t\t\t\t\t{#if $chats}\n\t\t\t\t\t\t\t\t{#each $chats as chat, idx (`chat-${chat?.id ?? idx}`)}\n\t\t\t\t\t\t\t\t\t{#if idx === 0 || (idx > 0 && chat.time_range !== $chats[idx - 1].time_range)}\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-full pl-2.5 text-xs text-gray-500 dark:text-gray-500 font-medium {idx ===\n\t\t\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t\t\t\t: 'pt-5'} pb-1.5\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t(chat.time_range)}\n\t\t\t\t\t\t\t\t\t\t\t<!-- localisation keys for time_range to be recognized from the i18next parser (so they don't get automatically removed):\n\t\t\t\t\t\t\t{$i18n.t('Today')}\n\t\t\t\t\t\t\t{$i18n.t('Yesterday')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 7 days')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 30 days')}\n\t\t\t\t\t\t\t{$i18n.t('January')}\n\t\t\t\t\t\t\t{$i18n.t('February')}\n\t\t\t\t\t\t\t{$i18n.t('March')}\n\t\t\t\t\t\t\t{$i18n.t('April')}\n\t\t\t\t\t\t\t{$i18n.t('May')}\n\t\t\t\t\t\t\t{$i18n.t('June')}\n\t\t\t\t\t\t\t{$i18n.t('July')}\n\t\t\t\t\t\t\t{$i18n.t('August')}\n\t\t\t\t\t\t\t{$i18n.t('September')}\n\t\t\t\t\t\t\t{$i18n.t('October')}\n\t\t\t\t\t\t\t{$i18n.t('November')}\n\t\t\t\t\t\t\t{$i18n.t('December')}\n\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t<ChatItem\n\t\t\t\t\t\t\t\t\t\tclassName=\"\"\n\t\t\t\t\t\t\t\t\t\tid={chat.id}\n\t\t\t\t\t\t\t\t\t\ttitle={chat.title}\n\t\t\t\t\t\t\t\t\t\t{shiftKey}\n\t\t\t\t\t\t\t\t\t\tselected={selectedChatId === chat.id}\n\t\t\t\t\t\t\t\t\t\ton:select={() => {\n\t\t\t\t\t\t\t\t\t\t\tselectedChatId = chat.id;\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ton:unselect={() => {\n\t\t\t\t\t\t\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ton:tag={(e) => {\n\t\t\t\t\t\t\t\t\t\t\tconst { type, name } = e.detail;\n\t\t\t\t\t\t\t\t\t\t\ttagEventHandler(type, name, chat.id);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{/each}\n\n\t\t\t\t\t\t\t\t{#if $scrollPaginationEnabled && !allChatsLoaded}\n\t\t\t\t\t\t\t\t\t<Loader\n\t\t\t\t\t\t\t\t\t\ton:visible={(e) => {\n\t\t\t\t\t\t\t\t\t\t\tif (!chatListLoading) {\n\t\t\t\t\t\t\t\t\t\t\t\tloadMoreChats();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" \">{$i18n.t('Loading...')}</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</Loader>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t\t\t<div class=\" \">{$i18n.t('Loading...')}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Folder>\n\t\t\t</div>\n\n\t\t\t<div class=\"px-1.5 pt-1.5 pb-2 sticky bottom-0 z-10 -mt-3 sidebar\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\" sidebar-bg-gradient-to-t bg-linear-to-t from-gray-50 dark:from-gray-950 to-transparent from-50% pointer-events-none absolute inset-0 -z-10 -mt-6\"\n\t\t\t\t></div>\n\t\t\t\t<div class=\"flex flex-col font-primary\">\n\t\t\t\t\t{#if $user !== undefined && $user !== null}\n\t\t\t\t\t\t<UserMenu\n\t\t\t\t\t\t\trole={$user?.role}\n\t\t\t\t\t\t\tprofile={$config?.features?.enable_user_status ?? true}\n\t\t\t\t\t\t\tshowActiveUsers={false}\n\t\t\t\t\t\t\ton:show={(e) => {\n\t\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\n\t\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" flex items-center rounded-2xl py-2 px-1.5 w-full hover:bg-gray-100/50 dark:hover:bg-gray-900/50 transition\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-3 relative\">\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${$user?.id}/profile/image`}\n\t\t\t\t\t\t\t\t\t\tclass=\" size-7 object-cover rounded-full\"\n\t\t\t\t\t\t\t\t\t\talt={$i18n.t('Open User Profile Menu')}\n\t\t\t\t\t\t\t\t\t\taria-label={$i18n.t('Open User Profile Menu')}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t{#if $config?.features?.enable_user_status}\n\t\t\t\t\t\t\t\t\t\t<div class=\"absolute -bottom-0.5 -right-0.5\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"relative inline-flex size-2.5 rounded-full {true\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-green-500'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-gray-300 dark:bg-gray-700'} border-2 border-white dark:border-gray-900\"\n\t\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center font-medium\">{$user?.name}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</UserMenu>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t{#if !$mobile}\n\t\t<div\n\t\t\tclass=\"relative flex items-center justify-center group border-l border-gray-50 dark:border-gray-850/30 hover:border-gray-200 dark:hover:border-gray-800 transition z-20\"\n\t\t\tid=\"sidebar-resizer\"\n\t\t\ton:mousedown={resizeStartHandler}\n\t\t\trole=\"separator\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\" absolute -left-1.5 -right-1.5 -top-0 -bottom-0 z-20 cursor-col-resize bg-transparent\"\n\t\t\t/>\n\t\t</div>\n\t{/if}\n{/if}\n","<script lang=\"ts\">\n\timport { getContext } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\timport { updateUserPassword } from '$lib/apis/auths';\n\timport SensitiveInput from '$lib/components/common/SensitiveInput.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\tlet show = false;\n\tlet currentPassword = '';\n\tlet newPassword = '';\n\tlet newPasswordConfirm = '';\n\n\tconst updatePasswordHandler = async () => {\n\t\tif (newPassword === newPasswordConfirm) {\n\t\t\tconst res = await updateUserPassword(localStorage.token, currentPassword, newPassword).catch(\n\t\t\t\t(error) => {\n\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (res) {\n\t\t\t\ttoast.success($i18n.t('Successfully updated.'));\n\t\t\t}\n\n\t\t\tcurrentPassword = '';\n\t\t\tnewPassword = '';\n\t\t\tnewPasswordConfirm = '';\n\t\t} else {\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t(\"The passwords you entered don't quite match. Please double-check and try again.\")\n\t\t\t);\n\t\t\tnewPassword = '';\n\t\t\tnewPasswordConfirm = '';\n\t\t}\n\t};\n</script>\n\n<form\n\tclass=\"flex flex-col text-sm\"\n\ton:submit|preventDefault={() => {\n\t\tupdatePasswordHandler();\n\t}}\n>\n\t<div class=\"flex justify-between items-center text-sm\">\n\t\t<div class=\"  font-medium\">{$i18n.t('Change Password')}</div>\n\t\t<button\n\t\t\tclass=\" text-xs font-medium text-gray-500\"\n\t\t\ttype=\"button\"\n\t\t\ton:click={() => {\n\t\t\t\tshow = !show;\n\t\t\t}}>{show ? $i18n.t('Hide') : $i18n.t('Show')}</button\n\t\t>\n\t</div>\n\n\t{#if show}\n\t\t<div class=\" py-2.5 space-y-1.5\">\n\t\t\t<div class=\"flex flex-col w-full\">\n\t\t\t\t<div class=\" mb-1 text-xs text-gray-500\">{$i18n.t('Current Password')}</div>\n\n\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t<SensitiveInput\n\t\t\t\t\t\tclass=\"w-full bg-transparent text-sm dark:text-gray-300 outline-hidden placeholder:opacity-30\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tbind:value={currentPassword}\n\t\t\t\t\t\tplaceholder={$i18n.t('Enter your current password')}\n\t\t\t\t\t\tautocomplete=\"current-password\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex flex-col w-full\">\n\t\t\t\t<div class=\" mb-1 text-xs text-gray-500\">{$i18n.t('New Password')}</div>\n\n\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t<SensitiveInput\n\t\t\t\t\t\tclass=\"w-full bg-transparent text-sm dark:text-gray-300 outline-hidden placeholder:opacity-30\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tbind:value={newPassword}\n\t\t\t\t\t\tplaceholder={$i18n.t('Enter your new password')}\n\t\t\t\t\t\tautocomplete=\"new-password\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex flex-col w-full\">\n\t\t\t\t<div class=\" mb-1 text-xs text-gray-500\">{$i18n.t('Confirm Password')}</div>\n\n\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t<SensitiveInput\n\t\t\t\t\t\tclass=\"w-full bg-transparent text-sm dark:text-gray-300 outline-hidden placeholder:opacity-30\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tbind:value={newPasswordConfirm}\n\t\t\t\t\t\tplaceholder={$i18n.t('Confirm your new password')}\n\t\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"mt-3 flex justify-end\">\n\t\t\t<button\n\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\t>\n\t\t\t\t{$i18n.t('Update password')}\n\t\t\t</button>\n\t\t</div>\n\t{/if}\n</form>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { onMount, getContext } from 'svelte';\n\n\timport { user, config, settings } from '$lib/stores';\n\timport { updateUserProfile, createAPIKey, getAPIKey, getSessionUser } from '$lib/apis/auths';\n\timport { WEBUI_BASE_URL } from '$lib/constants';\n\n\timport UpdatePassword from './Account/UpdatePassword.svelte';\n\timport { getGravatarUrl } from '$lib/apis/utils';\n\timport { generateInitialsImage, canvasPixelTest } from '$lib/utils';\n\timport { copyToClipboard } from '$lib/utils';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport SensitiveInput from '$lib/components/common/SensitiveInput.svelte';\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\timport { getUserById } from '$lib/apis/users';\n\timport User from '$lib/components/icons/User.svelte';\n\timport UserProfileImage from './Account/UserProfileImage.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let saveHandler: Function;\n\texport let saveSettings: Function;\n\n\tlet loaded = false;\n\n\tlet profileImageUrl = '';\n\tlet name = '';\n\tlet bio = '';\n\n\tlet _gender = '';\n\tlet gender = '';\n\tlet dateOfBirth = '';\n\n\tlet webhookUrl = '';\n\tlet showAPIKeys = false;\n\n\tlet JWTTokenCopied = false;\n\n\tlet APIKey = '';\n\tlet APIKeyCopied = false;\n\tlet profileImageInputElement: HTMLInputElement;\n\n\tconst submitHandler = async () => {\n\t\tif (name !== $user?.name) {\n\t\t\tif (profileImageUrl === generateInitialsImage($user?.name) || profileImageUrl === '') {\n\t\t\t\tprofileImageUrl = generateInitialsImage(name);\n\t\t\t}\n\t\t}\n\n\t\tif (webhookUrl !== $settings?.notifications?.webhook_url) {\n\t\t\tsaveSettings({\n\t\t\t\tnotifications: {\n\t\t\t\t\t...$settings.notifications,\n\t\t\t\t\twebhook_url: webhookUrl\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst updatedUser = await updateUserProfile(localStorage.token, {\n\t\t\tname: name,\n\t\t\tprofile_image_url: profileImageUrl,\n\t\t\tbio: bio ? bio : null,\n\t\t\tgender: gender ? gender : null,\n\t\t\tdate_of_birth: dateOfBirth ? dateOfBirth : null\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t});\n\n\t\tif (updatedUser) {\n\t\t\t// Get Session User Info\n\t\t\tconst sessionUser = await getSessionUser(localStorage.token).catch((error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tawait user.set(sessionUser);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst createAPIKeyHandler = async () => {\n\t\tAPIKey = await createAPIKey(localStorage.token);\n\t\tif (APIKey) {\n\t\t\ttoast.success($i18n.t('API Key created.'));\n\t\t} else {\n\t\t\ttoast.error($i18n.t('Failed to create API Key.'));\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\tconst user = await getSessionUser(localStorage.token).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (user) {\n\t\t\tname = user?.name ?? '';\n\t\t\tprofileImageUrl = user?.profile_image_url ?? '';\n\t\t\tbio = user?.bio ?? '';\n\n\t\t\t_gender = user?.gender ?? '';\n\t\t\tgender = _gender;\n\n\t\t\tdateOfBirth = user?.date_of_birth ?? '';\n\t\t}\n\n\t\twebhookUrl = $settings?.notifications?.webhook_url ?? '';\n\n\t\t// Only fetch API key if the feature is enabled and user has permission\n\t\tif (\n\t\t\tuser &&\n\t\t\t($config?.features?.enable_api_keys ?? true) &&\n\t\t\t(user?.role === 'admin' || (user?.permissions?.features?.api_keys ?? false))\n\t\t) {\n\t\t\tAPIKey = await getAPIKey(localStorage.token).catch((error) => {\n\t\t\t\tconsole.log(error);\n\t\t\t\treturn '';\n\t\t\t});\n\t\t}\n\n\t\tloaded = true;\n\t});\n</script>\n\n<div id=\"tab-account\" class=\"flex flex-col h-full justify-between text-sm\">\n\t<div class=\" overflow-y-scroll max-h-[28rem] md:max-h-full\">\n\t\t<div class=\"space-y-1\">\n\t\t\t<div>\n\t\t\t\t<div class=\"text-base font-medium\">{$i18n.t('Your Account')}</div>\n\n\t\t\t\t<div class=\"text-xs text-gray-500 mt-0.5\">\n\t\t\t\t\t{$i18n.t('Manage your account information.')}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<!-- <div class=\" text-sm font-medium\">{$i18n.t('Account')}</div> -->\n\n\t\t\t<div class=\"flex space-x-5 my-4\">\n\t\t\t\t<UserProfileImage bind:profileImageUrl user={$user} />\n\n\t\t\t\t<div class=\"flex flex-1 flex-col\">\n\t\t\t\t\t<div class=\" flex-1\">\n\t\t\t\t\t\t<div class=\"flex flex-col w-full\">\n\t\t\t\t\t\t\t<div class=\" mb-1 text-xs font-medium\">{$i18n.t('Name')}</div>\n\n\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclass=\"w-full text-sm dark:text-gray-300 bg-transparent outline-hidden\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tbind:value={name}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Enter your name')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex flex-col w-full mt-2\">\n\t\t\t\t\t\t\t<div class=\" mb-1 text-xs font-medium\">{$i18n.t('Bio')}</div>\n\n\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\tclassName=\"w-full text-sm dark:text-gray-300 bg-transparent outline-hidden\"\n\t\t\t\t\t\t\t\t\tminSize={60}\n\t\t\t\t\t\t\t\t\tbind:value={bio}\n\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Share your background and interests')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex flex-col w-full mt-2\">\n\t\t\t\t\t\t\t<div class=\" mb-1 text-xs font-medium\">{$i18n.t('Gender')}</div>\n\n\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\tclass=\"dark:bg-gray-900 w-full text-sm dark:text-gray-300 bg-transparent outline-hidden\"\n\t\t\t\t\t\t\t\t\tbind:value={_gender}\n\t\t\t\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\t\t\t\tconsole.log(_gender);\n\n\t\t\t\t\t\t\t\t\t\tif (_gender === 'custom') {\n\t\t\t\t\t\t\t\t\t\t\t// Handle custom gender input\n\t\t\t\t\t\t\t\t\t\t\tgender = '';\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tgender = _gender;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<option value=\"\" selected>{$i18n.t('Prefer not to say')}</option>\n\t\t\t\t\t\t\t\t\t<option value=\"male\">{$i18n.t('Male')}</option>\n\t\t\t\t\t\t\t\t\t<option value=\"female\">{$i18n.t('Female')}</option>\n\t\t\t\t\t\t\t\t\t<option value=\"custom\">{$i18n.t('Custom')}</option>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{#if _gender === 'custom'}\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclass=\"w-full text-sm dark:text-gray-300 bg-transparent outline-hidden mt-1\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Enter your gender')}\n\t\t\t\t\t\t\t\t\tbind:value={gender}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex flex-col w-full mt-2\">\n\t\t\t\t\t\t\t<div class=\" mb-1 text-xs font-medium\">{$i18n.t('Birth Date')}</div>\n\n\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclass=\"w-full text-sm dark:text-gray-300 dark:placeholder:text-gray-300 bg-transparent outline-hidden\"\n\t\t\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\t\t\tbind:value={dateOfBirth}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t{#if $config?.features?.enable_user_webhooks}\n\t\t\t<div class=\"mt-2\">\n\t\t\t\t<div class=\"flex flex-col w-full\">\n\t\t\t\t\t<div class=\" mb-1 text-xs font-medium\">{$i18n.t('Notification Webhook')}</div>\n\n\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\"w-full text-sm outline-hidden\"\n\t\t\t\t\t\t\ttype=\"url\"\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Enter your webhook URL')}\n\t\t\t\t\t\t\tbind:value={webhookUrl}\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<hr class=\"border-gray-50 dark:border-gray-850/30 my-4\" />\n\n\t\t{#if $config?.features.enable_login_form}\n\t\t\t<div class=\"mt-2\">\n\t\t\t\t<UpdatePassword />\n\t\t\t</div>\n\t\t{/if}\n\n\t\t{#if ($config?.features?.enable_api_keys ?? true) && ($user?.role === 'admin' || ($user?.permissions?.features?.api_keys ?? false))}\n\t\t\t<div class=\"flex justify-between items-center text-sm mt-2\">\n\t\t\t\t<div class=\"  font-medium\">{$i18n.t('API keys')}</div>\n\t\t\t\t<button\n\t\t\t\t\tclass=\" text-xs font-medium text-gray-500\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshowAPIKeys = !showAPIKeys;\n\t\t\t\t\t}}>{showAPIKeys ? $i18n.t('Hide') : $i18n.t('Show')}</button\n\t\t\t\t>\n\t\t\t</div>\n\n\t\t\t{#if showAPIKeys}\n\t\t\t\t<div class=\"flex flex-col\">\n\t\t\t\t\t{#if $user?.role === 'admin'}\n\t\t\t\t\t\t<div class=\"justify-between w-full mt-2\">\n\t\t\t\t\t\t\t<div class=\"flex justify-between w-full\">\n\t\t\t\t\t\t\t\t<div class=\"self-center text-xs font-medium mb-1\">{$i18n.t('JWT Token')}</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"flex\">\n\t\t\t\t\t\t\t\t<SensitiveInput value={localStorage.token} readOnly={true} />\n\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"ml-1.5 px-1.5 py-1 dark:hover:bg-gray-850 transition rounded-lg\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tcopyToClipboard(localStorage.token);\n\t\t\t\t\t\t\t\t\t\tJWTTokenCopied = true;\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t\tJWTTokenCopied = false;\n\t\t\t\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{#if JWTTokenCopied}\n\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z\"\n\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M11.986 3H12a2 2 0 0 1 2 2v6a2 2 0 0 1-1.5 1.937V7A2.5 2.5 0 0 0 10 4.5H4.063A2 2 0 0 1 6 3h.014A2.25 2.25 0 0 1 8.25 1h1.5a2.25 2.25 0 0 1 2.236 2ZM10.5 4v-.75a.75.75 0 0 0-.75-.75h-1.5a.75.75 0 0 0-.75.75V4h3Z\"\n\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M3 6a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H3Zm1.75 2.5a.75.75 0 0 0 0 1.5h3.5a.75.75 0 0 0 0-1.5h-3.5ZM4 11.75a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5h-3.5a.75.75 0 0 1-.75-.75Z\"\n\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if ($config?.features?.enable_api_keys ?? true) && ($user?.role === 'admin' || ($user?.permissions?.features?.api_keys ?? false))}\n\t\t\t\t\t\t<div class=\"justify-between w-full mt-2\">\n\t\t\t\t\t\t\t{#if $user?.role === 'admin'}\n\t\t\t\t\t\t\t\t<div class=\"flex justify-between w-full\">\n\t\t\t\t\t\t\t\t\t<div class=\"self-center text-xs font-medium mb-1\">{$i18n.t('API Key')}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t<div class=\"flex\">\n\t\t\t\t\t\t\t\t{#if APIKey}\n\t\t\t\t\t\t\t\t\t<SensitiveInput value={APIKey} readOnly={true} />\n\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclass=\"ml-1.5 px-1.5 py-1 dark:hover:bg-gray-850 transition rounded-lg\"\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\tcopyToClipboard(APIKey);\n\t\t\t\t\t\t\t\t\t\t\tAPIKeyCopied = true;\n\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t\t\tAPIKeyCopied = false;\n\t\t\t\t\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{#if APIKeyCopied}\n\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M11.986 3H12a2 2 0 0 1 2 2v6a2 2 0 0 1-1.5 1.937V7A2.5 2.5 0 0 0 10 4.5H4.063A2 2 0 0 1 6 3h.014A2.25 2.25 0 0 1 8.25 1h1.5a2.25 2.25 0 0 1 2.236 2ZM10.5 4v-.75a.75.75 0 0 0-.75-.75h-1.5a.75.75 0 0 0-.75.75V4h3Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M3 6a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H3Zm1.75 2.5a.75.75 0 0 0 0 1.5h3.5a.75.75 0 0 0 0-1.5h-3.5ZM4 11.75a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5h-3.5a.75.75 0 0 1-.75-.75Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Create new key')}>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\" px-1.5 py-1 dark:hover:bg-gray-850transition rounded-lg\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tcreateAPIKeyHandler();\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclass=\"flex gap-1.5 items-center font-medium px-3.5 py-1.5 rounded-lg bg-gray-100/70 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\tcreateAPIKeyHandler();\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Plus strokeWidth=\"2\" className=\" size-3.5\" />\n\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('Create new secret key')}</button\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t{/if}\n\t</div>\n\n\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\n\t\t<button\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\ton:click={async () => {\n\t\t\t\tconst res = await submitHandler();\n\n\t\t\t\tif (res) {\n\t\t\t\t\tsaveHandler();\n\t\t\t\t}\n\t\t\t}}\n\t\t>\n\t\t\t{$i18n.t('Save')}\n\t\t</button>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { getVersionUpdates } from '$lib/apis';\n\timport { getOllamaVersion } from '$lib/apis/ollama';\n\timport { WEBUI_BUILD_HASH, WEBUI_VERSION } from '$lib/constants';\n\timport { WEBUI_NAME, config, showChangelog } from '$lib/stores';\n\timport { compareVersion } from '$lib/utils';\n\timport { onMount, getContext } from 'svelte';\n\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\tlet ollamaVersion = '';\n\n\tlet updateAvailable = null;\n\tlet version = {\n\t\tcurrent: '',\n\t\tlatest: ''\n\t};\n\n\tconst checkForVersionUpdates = async () => {\n\t\tupdateAvailable = null;\n\t\tversion = await getVersionUpdates(localStorage.token).catch((error) => {\n\t\t\treturn {\n\t\t\t\tcurrent: WEBUI_VERSION,\n\t\t\t\tlatest: WEBUI_VERSION\n\t\t\t};\n\t\t});\n\n\t\tconsole.log(version);\n\n\t\tupdateAvailable = compareVersion(version.latest, version.current);\n\t\tconsole.log(updateAvailable);\n\t};\n\n\tonMount(async () => {\n\t\tollamaVersion = await getOllamaVersion(localStorage.token).catch((error) => {\n\t\t\treturn '';\n\t\t});\n\n\t\tif ($config?.features?.enable_version_update_check) {\n\t\t\tcheckForVersionUpdates();\n\t\t}\n\t});\n</script>\n\n<div id=\"tab-about\" class=\"flex flex-col h-full justify-between space-y-3 text-sm mb-6\">\n\t<div class=\" space-y-3 overflow-y-scroll max-h-[28rem] md:max-h-full\">\n\t\t<div>\n\t\t\t<div class=\" mb-2.5 text-sm font-medium flex space-x-2 items-center\">\n\t\t\t\t<div>\n\t\t\t\t\t{$WEBUI_NAME}\n\t\t\t\t\t{$i18n.t('Version')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"flex w-full justify-between items-center\">\n\t\t\t\t<div class=\"flex flex-col text-xs text-gray-700 dark:text-gray-200\">\n\t\t\t\t\t<div class=\"flex gap-1\">\n\t\t\t\t\t\t<Tooltip content={WEBUI_BUILD_HASH}>\n\t\t\t\t\t\t\tv{WEBUI_VERSION}\n\t\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t\t{#if $config?.features?.enable_version_update_check}\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref=\"https://github.com/open-webui/open-webui/releases/tag/v{version.latest}\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{updateAvailable === null\n\t\t\t\t\t\t\t\t\t? $i18n.t('Checking for updates...')\n\t\t\t\t\t\t\t\t\t: updateAvailable\n\t\t\t\t\t\t\t\t\t\t? `(v${version.latest} ${$i18n.t('available!')})`\n\t\t\t\t\t\t\t\t\t\t: $i18n.t('(latest)')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" underline flex items-center space-x-1 text-xs text-gray-500 dark:text-gray-500\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tshowChangelog.set(true);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div>{$i18n.t(\"See what's new\")}</div>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t{#if $config?.features?.enable_version_update_check}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" text-xs px-3 py-1.5 bg-gray-100 hover:bg-gray-200 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-lg font-medium\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tcheckForVersionUpdates();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{$i18n.t('Check for updates')}\n\t\t\t\t\t</button>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\n\t\t{#if ollamaVersion}\n\t\t\t<hr class=\" border-gray-100/30 dark:border-gray-850/30\" />\n\n\t\t\t<div>\n\t\t\t\t<div class=\" mb-2.5 text-sm font-medium\">{$i18n.t('Ollama Version')}</div>\n\t\t\t\t<div class=\"flex w-full\">\n\t\t\t\t\t<div class=\"flex-1 text-xs text-gray-700 dark:text-gray-200\">\n\t\t\t\t\t\t{ollamaVersion ?? 'N/A'}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<hr class=\" border-gray-100/30 dark:border-gray-850/30\" />\n\n\t\t{#if $config?.license_metadata}\n\t\t\t<div class=\"mb-2 text-xs\">\n\t\t\t\t{#if !$WEBUI_NAME.includes('Open WebUI')}\n\t\t\t\t\t<span class=\" text-gray-500 dark:text-gray-300 font-medium\">{$WEBUI_NAME}</span> -\n\t\t\t\t{/if}\n\n\t\t\t\t<span class=\" capitalize\">{$config?.license_metadata?.type}</span> license purchased by\n\t\t\t\t<span class=\" capitalize\">{$config?.license_metadata?.organization_name}</span>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex space-x-1\">\n\t\t\t\t<a href=\"https://discord.gg/5rJgQTnV4s\" target=\"_blank\">\n\t\t\t\t\t<img\n\t\t\t\t\t\talt=\"Discord\"\n\t\t\t\t\t\tsrc=\"https://img.shields.io/badge/Discord-Open_WebUI-blue?logo=discord&logoColor=white\"\n\t\t\t\t\t/>\n\t\t\t\t</a>\n\n\t\t\t\t<a href=\"https://twitter.com/OpenWebUI\" target=\"_blank\">\n\t\t\t\t\t<img\n\t\t\t\t\t\talt=\"X (formerly Twitter) Follow\"\n\t\t\t\t\t\tsrc=\"https://img.shields.io/twitter/follow/OpenWebUI\"\n\t\t\t\t\t/>\n\t\t\t\t</a>\n\n\t\t\t\t<a href=\"https://github.com/open-webui/open-webui\" target=\"_blank\">\n\t\t\t\t\t<img\n\t\t\t\t\t\talt=\"Github Repo\"\n\t\t\t\t\t\tsrc=\"https://img.shields.io/github/stars/open-webui/open-webui?style=social&label=Star us on Github\"\n\t\t\t\t\t/>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div class=\"mt-2 text-xs text-gray-400 dark:text-gray-500\">\n\t\t\tEmoji graphics provided by\n\t\t\t<a href=\"https://github.com/jdecked/twemoji\" target=\"_blank\">Twemoji</a>, licensed under\n\t\t\t<a href=\"https://creativecommons.org/licenses/by/4.0/\" target=\"_blank\">CC-BY 4.0</a>.\n\t\t</div>\n\n\t\t<div>\n\t\t\t<pre\n\t\t\t\tclass=\"text-xs text-gray-400 dark:text-gray-500\">Copyright (c) {new Date().getFullYear()} <a\n\t\t\t\t\thref=\"https://openwebui.com\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tclass=\"underline\">Open WebUI Inc.</a\n\t\t\t\t> <a href=\"https://github.com/open-webui/open-webui/blob/main/LICENSE\" target=\"_blank\"\n\t\t\t\t\t>All rights reserved.</a\n\t\t\t\t>\n</pre>\n\t\t</div>\n\n\t\t<div class=\"mt-2 text-xs text-gray-400 dark:text-gray-500\">\n\t\t\t{$i18n.t('Created by')}\n\t\t\t<a\n\t\t\t\tclass=\" text-gray-500 dark:text-gray-300 font-medium\"\n\t\t\t\thref=\"https://github.com/tjbck\"\n\t\t\t\ttarget=\"_blank\">Timothy J. Baek</a\n\t\t\t>\n\t\t</div>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { createEventDispatcher, onMount, getContext } from 'svelte';\n\timport { getLanguages, changeLanguage } from '$lib/i18n';\n\tconst dispatch = createEventDispatcher();\n\n\timport { config, models, settings, theme, user } from '$lib/stores';\n\n\tconst i18n = getContext('i18n');\n\n\timport AdvancedParams from './Advanced/AdvancedParams.svelte';\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\texport let saveSettings: Function;\n\texport let getModels: Function;\n\n\t// General\n\tlet themes = ['dark', 'light', 'oled-dark'];\n\tlet selectedTheme = 'system';\n\n\tlet languages: Awaited<ReturnType<typeof getLanguages>> = [];\n\tlet lang = $i18n.language;\n\tlet notificationEnabled = false;\n\tlet system = '';\n\n\tlet showAdvanced = false;\n\n\tconst toggleNotification = async () => {\n\t\tconst permission = await Notification.requestPermission();\n\n\t\tif (permission === 'granted') {\n\t\t\tnotificationEnabled = !notificationEnabled;\n\t\t\tsaveSettings({ notificationEnabled: notificationEnabled });\n\t\t} else {\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t(\n\t\t\t\t\t'Response notifications cannot be activated as the website permissions have been denied. Please visit your browser settings to grant the necessary access.'\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n\n\tlet params = {\n\t\t// Advanced\n\t\tstream_response: null,\n\t\tstream_delta_chunk_size: null,\n\t\tfunction_calling: null,\n\t\tseed: null,\n\t\ttemperature: null,\n\t\treasoning_effort: null,\n\t\tlogit_bias: null,\n\t\tfrequency_penalty: null,\n\t\tpresence_penalty: null,\n\t\trepeat_penalty: null,\n\t\trepeat_last_n: null,\n\t\tmirostat: null,\n\t\tmirostat_eta: null,\n\t\tmirostat_tau: null,\n\t\ttop_k: null,\n\t\ttop_p: null,\n\t\tmin_p: null,\n\t\tstop: null,\n\t\ttfs_z: null,\n\t\tnum_ctx: null,\n\t\tnum_batch: null,\n\t\tnum_keep: null,\n\t\tmax_tokens: null,\n\t\tnum_gpu: null\n\t};\n\n\tconst saveHandler = async () => {\n\t\tsaveSettings({\n\t\t\tsystem: system !== '' ? system : undefined,\n\t\t\tparams: {\n\t\t\t\tstream_response: params.stream_response !== null ? params.stream_response : undefined,\n\t\t\t\tstream_delta_chunk_size:\n\t\t\t\t\tparams.stream_delta_chunk_size !== null ? params.stream_delta_chunk_size : undefined,\n\t\t\t\tfunction_calling: params.function_calling !== null ? params.function_calling : undefined,\n\t\t\t\tseed: (params.seed !== null ? params.seed : undefined) ?? undefined,\n\t\t\t\tstop: params.stop ? params.stop.split(',').filter((e) => e) : undefined,\n\t\t\t\ttemperature: params.temperature !== null ? params.temperature : undefined,\n\t\t\t\treasoning_effort: params.reasoning_effort !== null ? params.reasoning_effort : undefined,\n\t\t\t\tlogit_bias: params.logit_bias !== null ? params.logit_bias : undefined,\n\t\t\t\tfrequency_penalty: params.frequency_penalty !== null ? params.frequency_penalty : undefined,\n\t\t\t\tpresence_penalty: params.frequency_penalty !== null ? params.frequency_penalty : undefined,\n\t\t\t\trepeat_penalty: params.frequency_penalty !== null ? params.frequency_penalty : undefined,\n\t\t\t\trepeat_last_n: params.repeat_last_n !== null ? params.repeat_last_n : undefined,\n\t\t\t\tmirostat: params.mirostat !== null ? params.mirostat : undefined,\n\t\t\t\tmirostat_eta: params.mirostat_eta !== null ? params.mirostat_eta : undefined,\n\t\t\t\tmirostat_tau: params.mirostat_tau !== null ? params.mirostat_tau : undefined,\n\t\t\t\ttop_k: params.top_k !== null ? params.top_k : undefined,\n\t\t\t\ttop_p: params.top_p !== null ? params.top_p : undefined,\n\t\t\t\tmin_p: params.min_p !== null ? params.min_p : undefined,\n\t\t\t\ttfs_z: params.tfs_z !== null ? params.tfs_z : undefined,\n\t\t\t\tnum_ctx: params.num_ctx !== null ? params.num_ctx : undefined,\n\t\t\t\tnum_batch: params.num_batch !== null ? params.num_batch : undefined,\n\t\t\t\tnum_keep: params.num_keep !== null ? params.num_keep : undefined,\n\t\t\t\tmax_tokens: params.max_tokens !== null ? params.max_tokens : undefined,\n\t\t\t\tuse_mmap: params.use_mmap !== null ? params.use_mmap : undefined,\n\t\t\t\tuse_mlock: params.use_mlock !== null ? params.use_mlock : undefined,\n\t\t\t\tnum_thread: params.num_thread !== null ? params.num_thread : undefined,\n\t\t\t\tnum_gpu: params.num_gpu !== null ? params.num_gpu : undefined,\n\t\t\t\tthink: params.think !== null ? params.think : undefined,\n\t\t\t\tkeep_alive: params.keep_alive !== null ? params.keep_alive : undefined,\n\t\t\t\tformat: params.format !== null ? params.format : undefined\n\t\t\t}\n\t\t});\n\t\tdispatch('save');\n\t};\n\n\tonMount(async () => {\n\t\tselectedTheme = localStorage.theme ?? 'system';\n\n\t\tlanguages = await getLanguages();\n\n\t\tnotificationEnabled = $settings.notificationEnabled ?? false;\n\t\tsystem = $settings.system ?? '';\n\n\t\tparams = { ...params, ...$settings.params };\n\t\tparams.stop = $settings?.params?.stop ? ($settings?.params?.stop ?? []).join(',') : null;\n\t});\n\n\tconst applyTheme = (_theme: string) => {\n\t\tlet themeToApply = _theme === 'oled-dark' ? 'dark' : _theme === 'her' ? 'light' : _theme;\n\n\t\tif (_theme === 'system') {\n\t\t\tthemeToApply = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n\t\t}\n\n\t\tif (themeToApply === 'dark' && !_theme.includes('oled')) {\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-800', '#333');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-850', '#262626');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-900', '#171717');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-950', '#0d0d0d');\n\t\t}\n\n\t\tthemes\n\t\t\t.filter((e) => e !== themeToApply)\n\t\t\t.forEach((e) => {\n\t\t\t\te.split(' ').forEach((e) => {\n\t\t\t\t\tdocument.documentElement.classList.remove(e);\n\t\t\t\t});\n\t\t\t});\n\n\t\tthemeToApply.split(' ').forEach((e) => {\n\t\t\tdocument.documentElement.classList.add(e);\n\t\t});\n\n\t\tconst metaThemeColor = document.querySelector('meta[name=\"theme-color\"]');\n\t\tif (metaThemeColor) {\n\t\t\tif (_theme.includes('system')) {\n\t\t\t\tconst systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches\n\t\t\t\t\t? 'dark'\n\t\t\t\t\t: 'light';\n\t\t\t\tconsole.log('Setting system meta theme color: ' + systemTheme);\n\t\t\t\tmetaThemeColor.setAttribute('content', systemTheme === 'light' ? '#ffffff' : '#171717');\n\t\t\t} else {\n\t\t\t\tconsole.log('Setting meta theme color: ' + _theme);\n\t\t\t\tmetaThemeColor.setAttribute(\n\t\t\t\t\t'content',\n\t\t\t\t\t_theme === 'dark'\n\t\t\t\t\t\t? '#171717'\n\t\t\t\t\t\t: _theme === 'oled-dark'\n\t\t\t\t\t\t\t? '#000000'\n\t\t\t\t\t\t\t: _theme === 'her'\n\t\t\t\t\t\t\t\t? '#983724'\n\t\t\t\t\t\t\t\t: '#ffffff'\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof window !== 'undefined' && window.applyTheme) {\n\t\t\twindow.applyTheme();\n\t\t}\n\n\t\tif (_theme.includes('oled')) {\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-800', '#101010');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-850', '#050505');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-900', '#000000');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-950', '#000000');\n\t\t\tdocument.documentElement.classList.add('dark');\n\t\t}\n\n\t\tconsole.log(_theme);\n\t};\n\n\tconst themeChangeHandler = (_theme: string) => {\n\t\ttheme.set(_theme);\n\t\tlocalStorage.setItem('theme', _theme);\n\t\tapplyTheme(_theme);\n\t};\n</script>\n\n<div class=\"flex flex-col h-full justify-between text-sm\" id=\"tab-general\">\n\t<div class=\"  overflow-y-scroll max-h-[28rem] md:max-h-full\">\n\t\t<div class=\"\">\n\t\t\t<div class=\" mb-1 text-sm font-medium\">{$i18n.t('WebUI Settings')}</div>\n\n\t\t\t<div class=\"flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Theme')}</div>\n\t\t\t\t<div class=\"flex items-center relative\">\n\t\t\t\t\t<select\n\t\t\t\t\t\tclass=\"dark:bg-gray-900 w-fit pr-8 rounded-sm py-2 px-2 text-xs bg-transparent text-right {$settings.highContrastMode\n\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t: 'outline-hidden'}\"\n\t\t\t\t\t\tbind:value={selectedTheme}\n\t\t\t\t\t\tplaceholder={$i18n.t('Select a theme')}\n\t\t\t\t\t\ton:change={() => themeChangeHandler(selectedTheme)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<option value=\"system\"> {$i18n.t('System')}</option>\n\t\t\t\t\t\t<option value=\"dark\"> {$i18n.t('Dark')}</option>\n\t\t\t\t\t\t<option value=\"oled-dark\"> {$i18n.t('OLED Dark')}</option>\n\t\t\t\t\t\t<option value=\"light\"> {$i18n.t('Light')}</option>\n\t\t\t\t\t\t<option value=\"her\"> Her</option>\n\t\t\t\t\t\t<!-- <option value=\"rose-pine dark\"> {$i18n.t('Ros Pine')}</option>\n\t\t\t\t\t\t<option value=\"rose-pine-dawn light\"> {$i18n.t('Ros Pine Dawn')}</option> -->\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\" flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Language')}</div>\n\t\t\t\t<div class=\"flex items-center relative\">\n\t\t\t\t\t<select\n\t\t\t\t\t\tclass=\"dark:bg-gray-900 w-fit pr-8 rounded-sm py-2 px-2 text-xs bg-transparent text-right {$settings.highContrastMode\n\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t: 'outline-hidden'}\"\n\t\t\t\t\t\tbind:value={lang}\n\t\t\t\t\t\tplaceholder={$i18n.t('Select a language')}\n\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\tchangeLanguage(lang);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#each languages as language}\n\t\t\t\t\t\t\t<option value={language['code']}>{language['title']}</option>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{#if $i18n.language === 'en-US' && !($config?.license_metadata ?? false)}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"mb-2 text-xs {($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t? 'text-gray-800 dark:text-gray-100'\n\t\t\t\t\t\t: 'text-gray-400 dark:text-gray-500'}\"\n\t\t\t\t>\n\t\t\t\t\tCouldn't find your language?\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"font-medium underline {($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t? 'text-gray-700 dark:text-gray-200'\n\t\t\t\t\t\t\t: 'text-gray-300'}\"\n\t\t\t\t\t\thref=\"https://github.com/open-webui/open-webui/blob/main/docs/CONTRIBUTING.md#-translations-and-internationalization\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t>\n\t\t\t\t\t\tHelp us translate Open WebUI!\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Notifications')}</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\ttoggleNotification();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if notificationEnabled === true}\n\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('On')}</span>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Off')}</span>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t{#if $user?.role === 'admin' || (($user?.permissions.chat?.controls ?? true) && ($user?.permissions.chat?.system_prompt ?? true))}\n\t\t\t<hr class=\"border-gray-100/30 dark:border-gray-850/30 my-3\" />\n\n\t\t\t<div>\n\t\t\t\t<div class=\" my-2.5 text-sm font-medium\">{$i18n.t('System Prompt')}</div>\n\t\t\t\t<Textarea\n\t\t\t\t\tbind:value={system}\n\t\t\t\t\tclassName={'w-full text-sm outline-hidden resize-vertical' +\n\t\t\t\t\t\t($settings.highContrastMode\n\t\t\t\t\t\t\t? ' p-2.5 border-2 border-gray-300 dark:border-gray-700 rounded-lg bg-transparent text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 overflow-y-hidden'\n\t\t\t\t\t\t\t: '  dark:text-gray-300 ')}\n\t\t\t\t\trows=\"4\"\n\t\t\t\t\tplaceholder={$i18n.t('Enter system prompt here')}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t{#if $user?.role === 'admin' || (($user?.permissions.chat?.controls ?? true) && ($user?.permissions.chat?.params ?? true))}\n\t\t\t<div class=\"mt-2 space-y-3 pr-1.5\">\n\t\t\t\t<div class=\"flex justify-between items-center text-sm\">\n\t\t\t\t\t<div class=\"  font-medium\">{$i18n.t('Advanced Parameters')}</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" text-xs font-medium {($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t? 'text-gray-800 dark:text-gray-100'\n\t\t\t\t\t\t\t: 'text-gray-400 dark:text-gray-500'}\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tshowAdvanced = !showAdvanced;\n\t\t\t\t\t\t}}>{showAdvanced ? $i18n.t('Hide') : $i18n.t('Show')}</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\n\t\t\t\t{#if showAdvanced}\n\t\t\t\t\t<AdvancedParams admin={$user?.role === 'admin'} bind:params />\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\n\t\t<button\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\ton:click={() => {\n\t\t\t\tsaveHandler();\n\t\t\t}}\n\t\t>\n\t\t\t{$i18n.t('Save')}\n\t\t</button>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext, onMount } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport Minus from '$lib/components/icons/Minus.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\n\texport let show = false;\n\texport let onSave = () => {};\n\n\texport let floatingActionButtons = null;\n\n\tconst submitHandler = async () => {\n\t\tonSave(floatingActionButtons);\n\t\tshow = false;\n\t};\n\n\t$: if (show) {\n\t}\n\n\tonMount(() => {});\n</script>\n\n<Modal size=\"sm\" bind:show>\n\t<div>\n\t\t<div class=\" flex justify-between dark:text-gray-100 px-5 pt-4 pb-1.5\">\n\t\t\t<h1 class=\"text-lg font-medium self-center font-primary\">\n\t\t\t\t{$i18n.t('Quick Actions')}\n\t\t\t</h1>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\taria-label={$i18n.t('Close modal')}\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className={'size-5'} />\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full px-4 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t<form\n\t\t\t\t\tclass=\"flex flex-col w-full px-1\"\n\t\t\t\t\ton:submit={(e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-xs flex items-center justify-between mb-2\">\n\t\t\t\t\t\t\t<div class=\"font-medium\">{$i18n.t('Actions')}</div>\n\n\t\t\t\t\t\t\t<div class=\"flex items-center gap-2 text-gray-700 dark:text-gray-300\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tif (floatingActionButtons === null) {\n\t\t\t\t\t\t\t\t\t\t\tfloatingActionButtons = [\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: 'ask',\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: $i18n.t('Ask'),\n\t\t\t\t\t\t\t\t\t\t\t\t\tinput: true,\n\t\t\t\t\t\t\t\t\t\t\t\t\tprompt: `{{SELECTED_CONTENT}}\\n\\n\\n{{INPUT_CONTENT}}`\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: 'explain',\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: $i18n.t('Explain'),\n\t\t\t\t\t\t\t\t\t\t\t\t\tinput: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\tprompt: `{{SELECTED_CONTENT}}\\n\\n\\n${$i18n.t('Explain')}`\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfloatingActionButtons = null;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{#if floatingActionButtons === null}\n\t\t\t\t\t\t\t\t\t\t<span class=\"\">{$i18n.t('Default')}</span>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<span class=\"\">{$i18n.t('Custom')}</span>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t{#if floatingActionButtons !== null}\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclass=\"\"\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\tlet id = `new-button`;\n\t\t\t\t\t\t\t\t\t\t\tlet idx = 0;\n\n\t\t\t\t\t\t\t\t\t\t\twhile (floatingActionButtons.some((b) => b.id === id)) {\n\t\t\t\t\t\t\t\t\t\t\t\tidx++;\n\t\t\t\t\t\t\t\t\t\t\t\tid = `new-button-${idx}`;\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tfloatingActionButtons = [\n\t\t\t\t\t\t\t\t\t\t\t\t...floatingActionButtons,\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: `${$i18n.t('New Button')}`,\n\t\t\t\t\t\t\t\t\t\t\t\t\tinput: true,\n\t\t\t\t\t\t\t\t\t\t\t\t\tprompt: `{{CONTENT}}\\n\\n\\n{{INPUT_CONTENT}}`\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Plus className=\"size-4 \" />\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if floatingActionButtons === null || floatingActionButtons.length === 0}\n\t\t\t\t\t\t\t<div class=\"text-gray-500 dark:text-gray-400 text-xs w-full text-center py-5\">\n\t\t\t\t\t\t\t\t{$i18n.t('Default action buttons will be used.')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t{#each floatingActionButtons as button, buttonIdx}\n\t\t\t\t\t\t\t\t<div class=\" py-1 flex w-full justify-between items-start\">\n\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col items-start pr-2\">\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\tclass=\" self-center text-xs outline-none w-20\"\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Button Label')}\n\t\t\t\t\t\t\t\t\t\t\tbind:value={button.label}\n\t\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\tclass=\" self-center text-xs outline-none w-20 text-gray-600 dark:text-gray-400\"\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Button ID')}\n\t\t\t\t\t\t\t\t\t\t\tbind:value={button.id}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2 w-full\">\n\t\t\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\t\t\tclassName=\" self-center text-xs w-full outline-none\"\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Button Prompt')}\n\t\t\t\t\t\t\t\t\t\t\tminSize={30}\n\t\t\t\t\t\t\t\t\t\t\tbind:value={button.prompt}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclass=\"pl-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\tfloatingActionButtons = floatingActionButtons.filter(\n\t\t\t\t\t\t\t\t\t\t\t\t(b) => b.id !== button.id\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Minus className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<hr class=\"border-gray-50 dark:border-gray-850/30 my-2\" />\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex justify-end text-sm font-medium\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{$i18n.t('Save')}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext, onMount } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport Minus from '$lib/components/icons/Minus.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\n\texport let show = false;\n\texport let size = null;\n\texport let onSave = () => {};\n\n\tconst submitHandler = async () => {\n\t\tonSave(size);\n\t\tshow = false;\n\t};\n\n\tonMount(() => {});\n</script>\n\n<Modal size=\"sm\" bind:show>\n\t<div>\n\t\t<div class=\" flex justify-between dark:text-gray-100 px-5 pt-4 pb-1.5\">\n\t\t\t<h1 class=\"text-lg font-medium self-center font-primary\">\n\t\t\t\t{$i18n.t('Manage')}\n\t\t\t</h1>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\taria-label={$i18n.t('Close modal')}\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className={'size-5'} />\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full px-4 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t<form\n\t\t\t\t\tclass=\"flex flex-col w-full px-1\"\n\t\t\t\t\ton:submit={(e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\" py-0.5 flex flex-col w-full text-sm\">\n\t\t\t\t\t\t\t\t<div id=\"image-compression-size-label\" class=\" text-xs mb-2\">\n\t\t\t\t\t\t\t\t\t{$i18n.t('Image Max Compression Size')}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"p-1 flex-1 flex gap-2\">\n\t\t\t\t\t\t\t\t\t<div class=\" flex-1\">\n\t\t\t\t\t\t\t\t\t\t<label class=\"sr-only\" for=\"image-comp-width\"\n\t\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Image Max Compression Size width')}</label\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\tbind:value={size.width}\n\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\t\taria-labelledby=\"image-comp-width\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-full bg-transparent outline-hidden text-center\"\n\t\t\t\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Width')}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\"self-center text-gray-500 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\t<XMark />\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t\t\t<label class=\"sr-only\" for=\"image-comp-height\"\n\t\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Image Max Compression Size height')}</label\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\tbind:value={size.height}\n\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\t\taria-labelledby=\"image-comp-height\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-full bg-transparent outline-hidden text-center\"\n\t\t\t\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Height')}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex justify-end text-sm font-medium\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{$i18n.t('Save')}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n","<script lang=\"ts\">\n\timport { config, models, settings, user } from '$lib/stores';\n\timport { createEventDispatcher, onMount, onDestroy, getContext } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport { updateUserInfo } from '$lib/apis/users';\n\timport { getUserPosition } from '$lib/utils';\n\timport { setTextScale } from '$lib/utils/text-scale';\n\n\timport Minus from '$lib/components/icons/Minus.svelte';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport ManageFloatingActionButtonsModal from './Interface/ManageFloatingActionButtonsModal.svelte';\n\timport ManageImageCompressionModal from './Interface/ManageImageCompressionModal.svelte';\n\n\tconst dispatch = createEventDispatcher();\n\n\tconst i18n = getContext('i18n');\n\n\texport let saveSettings: Function;\n\n\tlet backgroundImageUrl = null;\n\tlet inputFiles = null;\n\tlet filesInputElement;\n\n\t// Addons\n\tlet titleAutoGenerate = true;\n\tlet autoFollowUps = true;\n\tlet autoTags = true;\n\n\tlet responseAutoCopy = false;\n\tlet widescreenMode = false;\n\tlet splitLargeChunks = false;\n\tlet scrollOnBranchChange = true;\n\tlet userLocation = false;\n\n\t// Interface\n\tlet defaultModelId = '';\n\tlet showUsername = false;\n\n\tlet notificationSound = true;\n\tlet notificationSoundAlways = false;\n\n\tlet highContrastMode = false;\n\n\tlet detectArtifacts = true;\n\tlet displayMultiModelResponsesInTabs = false;\n\n\tlet richTextInput = true;\n\tlet showFormattingToolbar = false;\n\tlet insertPromptAsRichText = false;\n\tlet promptAutocomplete = false;\n\n\tlet largeTextAsFile = false;\n\n\tlet insertSuggestionPrompt = false;\n\tlet keepFollowUpPrompts = false;\n\tlet insertFollowUpPrompt = false;\n\n\tlet regenerateMenu = true;\n\n\tlet landingPageMode = '';\n\tlet chatBubble = true;\n\tlet chatDirection: 'LTR' | 'RTL' | 'auto' = 'auto';\n\tlet ctrlEnterToSend = false;\n\tlet copyFormatted = false;\n\n\tlet temporaryChatByDefault = false;\n\tlet chatFadeStreamingText = true;\n\tlet collapseCodeBlocks = false;\n\tlet expandDetails = false;\n\tlet showChatTitleInTab = true;\n\n\tlet showFloatingActionButtons = true;\n\tlet floatingActionButtons = null;\n\n\tlet imageCompression = false;\n\tlet imageCompressionSize = {\n\t\twidth: '',\n\t\theight: ''\n\t};\n\tlet imageCompressionInChannels = true;\n\n\t// chat export\n\tlet stylizedPdfExport = true;\n\n\t// Admin - Show Update Available Toast\n\tlet showUpdateToast = true;\n\tlet showChangelog = true;\n\n\tlet showEmojiInCall = false;\n\tlet voiceInterruption = false;\n\tlet hapticFeedback = false;\n\n\tlet webSearch = null;\n\n\tlet iframeSandboxAllowSameOrigin = false;\n\tlet iframeSandboxAllowForms = false;\n\n\tlet showManageFloatingActionButtonsModal = false;\n\tlet showManageImageCompressionModal = false;\n\n\tlet textScale = null;\n\n\tconst toggleLandingPageMode = async () => {\n\t\tlandingPageMode = landingPageMode === '' ? 'chat' : '';\n\t\tsaveSettings({ landingPageMode: landingPageMode });\n\t};\n\n\tconst toggleUserLocation = async () => {\n\t\tif (userLocation) {\n\t\t\tconst position = await getUserPosition().catch((error) => {\n\t\t\t\ttoast.error(error.message);\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tif (position) {\n\t\t\t\tawait updateUserInfo(localStorage.token, { location: position });\n\t\t\t\ttoast.success($i18n.t('User location successfully retrieved.'));\n\t\t\t} else {\n\t\t\t\tuserLocation = false;\n\t\t\t}\n\t\t}\n\n\t\tsaveSettings({ userLocation });\n\t};\n\n\tconst toggleTitleAutoGenerate = async () => {\n\t\tsaveSettings({\n\t\t\ttitle: {\n\t\t\t\t...$settings.title,\n\t\t\t\tauto: titleAutoGenerate\n\t\t\t}\n\t\t});\n\t};\n\n\tconst toggleResponseAutoCopy = async () => {\n\t\tconst permission = await navigator.clipboard\n\t\t\t.readText()\n\t\t\t.then(() => {\n\t\t\t\treturn 'granted';\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\treturn '';\n\t\t\t});\n\n\t\tif (permission === 'granted') {\n\t\t\tsaveSettings({ responseAutoCopy: responseAutoCopy });\n\t\t} else {\n\t\t\tresponseAutoCopy = false;\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t(\n\t\t\t\t\t'Clipboard write permission denied. Please check your browser settings to grant the necessary access.'\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n\n\tconst toggleChangeChatDirection = async () => {\n\t\tif (chatDirection === 'auto') {\n\t\t\tchatDirection = 'LTR';\n\t\t} else if (chatDirection === 'LTR') {\n\t\t\tchatDirection = 'RTL';\n\t\t} else if (chatDirection === 'RTL') {\n\t\t\tchatDirection = 'auto';\n\t\t}\n\t\tsaveSettings({ chatDirection });\n\t};\n\n\tconst togglectrlEnterToSend = async () => {\n\t\tctrlEnterToSend = !ctrlEnterToSend;\n\t\tsaveSettings({ ctrlEnterToSend });\n\t};\n\n\tconst updateInterfaceHandler = async () => {\n\t\tsaveSettings({\n\t\t\tmodels: [defaultModelId],\n\t\t\timageCompressionSize: imageCompressionSize\n\t\t});\n\t};\n\n\tconst toggleWebSearch = async () => {\n\t\twebSearch = webSearch === null ? 'always' : null;\n\t\tsaveSettings({ webSearch: webSearch });\n\t};\n\n\tconst setTextScaleHandler = (scale) => {\n\t\ttextScale = scale;\n\t\tsetTextScale(textScale);\n\n\t\tif (textScale === 1) {\n\t\t\ttextScale = null;\n\t\t}\n\t\tsaveSettings({ textScale });\n\t};\n\n\tonMount(async () => {\n\t\ttitleAutoGenerate = $settings?.title?.auto ?? true;\n\t\tautoTags = $settings?.autoTags ?? true;\n\t\tautoFollowUps = $settings?.autoFollowUps ?? true;\n\n\t\thighContrastMode = $settings?.highContrastMode ?? false;\n\n\t\tdetectArtifacts = $settings?.detectArtifacts ?? true;\n\t\tresponseAutoCopy = $settings?.responseAutoCopy ?? false;\n\n\t\tshowUsername = $settings?.showUsername ?? false;\n\t\tshowUpdateToast = $settings?.showUpdateToast ?? true;\n\t\tshowChangelog = $settings?.showChangelog ?? true;\n\n\t\tshowEmojiInCall = $settings?.showEmojiInCall ?? false;\n\t\tvoiceInterruption = $settings?.voiceInterruption ?? false;\n\n\t\tdisplayMultiModelResponsesInTabs = $settings?.displayMultiModelResponsesInTabs ?? false;\n\t\tchatFadeStreamingText = $settings?.chatFadeStreamingText ?? true;\n\n\t\trichTextInput = $settings?.richTextInput ?? true;\n\t\tshowFormattingToolbar = $settings?.showFormattingToolbar ?? false;\n\t\tinsertPromptAsRichText = $settings?.insertPromptAsRichText ?? false;\n\t\tpromptAutocomplete = $settings?.promptAutocomplete ?? false;\n\n\t\tinsertSuggestionPrompt = $settings?.insertSuggestionPrompt ?? false;\n\t\tkeepFollowUpPrompts = $settings?.keepFollowUpPrompts ?? false;\n\t\tinsertFollowUpPrompt = $settings?.insertFollowUpPrompt ?? false;\n\n\t\tregenerateMenu = $settings?.regenerateMenu ?? true;\n\n\t\tlargeTextAsFile = $settings?.largeTextAsFile ?? false;\n\t\tcopyFormatted = $settings?.copyFormatted ?? false;\n\n\t\tcollapseCodeBlocks = $settings?.collapseCodeBlocks ?? false;\n\t\texpandDetails = $settings?.expandDetails ?? false;\n\n\t\tlandingPageMode = $settings?.landingPageMode ?? '';\n\t\tchatBubble = $settings?.chatBubble ?? true;\n\t\twidescreenMode = $settings?.widescreenMode ?? false;\n\t\tsplitLargeChunks = $settings?.splitLargeChunks ?? false;\n\t\tscrollOnBranchChange = $settings?.scrollOnBranchChange ?? true;\n\n\t\ttemporaryChatByDefault = $settings?.temporaryChatByDefault ?? false;\n\t\tchatDirection = $settings?.chatDirection ?? 'auto';\n\t\tuserLocation = $settings?.userLocation ?? false;\n\t\tshowChatTitleInTab = $settings?.showChatTitleInTab ?? true;\n\n\t\tnotificationSound = $settings?.notificationSound ?? true;\n\t\tnotificationSoundAlways = $settings?.notificationSoundAlways ?? false;\n\n\t\tiframeSandboxAllowSameOrigin = $settings?.iframeSandboxAllowSameOrigin ?? false;\n\t\tiframeSandboxAllowForms = $settings?.iframeSandboxAllowForms ?? false;\n\n\t\tstylizedPdfExport = $settings?.stylizedPdfExport ?? true;\n\n\t\thapticFeedback = $settings?.hapticFeedback ?? false;\n\t\tctrlEnterToSend = $settings?.ctrlEnterToSend ?? false;\n\n\t\tshowFloatingActionButtons = $settings?.showFloatingActionButtons ?? true;\n\t\tfloatingActionButtons = $settings?.floatingActionButtons ?? null;\n\n\t\timageCompression = $settings?.imageCompression ?? false;\n\t\timageCompressionSize = $settings?.imageCompressionSize ?? { width: '', height: '' };\n\t\timageCompressionInChannels = $settings?.imageCompressionInChannels ?? true;\n\n\t\tdefaultModelId = $settings?.models?.at(0) ?? '';\n\t\tif ($config?.default_models) {\n\t\t\tdefaultModelId = $config.default_models.split(',')[0];\n\t\t}\n\n\t\tbackgroundImageUrl = $settings?.backgroundImageUrl ?? null;\n\t\twebSearch = $settings?.webSearch ?? null;\n\n\t\ttextScale = $settings?.textScale ?? null;\n\t});\n</script>\n\n<ManageFloatingActionButtonsModal\n\tbind:show={showManageFloatingActionButtonsModal}\n\t{floatingActionButtons}\n\tonSave={(buttons) => {\n\t\tfloatingActionButtons = buttons;\n\t\tsaveSettings({ floatingActionButtons });\n\t}}\n/>\n\n<ManageImageCompressionModal\n\tbind:show={showManageImageCompressionModal}\n\tsize={imageCompressionSize}\n\tonSave={(size) => {\n\t\tsaveSettings({ imageCompressionSize: size });\n\t}}\n/>\n\n<form\n\tid=\"tab-interface\"\n\tclass=\"flex flex-col h-full justify-between space-y-3 text-sm\"\n\ton:submit|preventDefault={() => {\n\t\tupdateInterfaceHandler();\n\t\tdispatch('save');\n\t}}\n>\n\t<input\n\t\tbind:this={filesInputElement}\n\t\tbind:files={inputFiles}\n\t\ttype=\"file\"\n\t\thidden\n\t\taccept=\"image/*\"\n\t\ton:change={() => {\n\t\t\tlet reader = new FileReader();\n\t\t\treader.onload = (event) => {\n\t\t\t\tlet originalImageUrl = `${event.target.result}`;\n\n\t\t\t\tbackgroundImageUrl = originalImageUrl;\n\t\t\t\tsaveSettings({ backgroundImageUrl });\n\t\t\t};\n\n\t\t\tif (\n\t\t\t\tinputFiles &&\n\t\t\t\tinputFiles.length > 0 &&\n\t\t\t\t['image/gif', 'image/webp', 'image/jpeg', 'image/png'].includes(inputFiles[0]['type'])\n\t\t\t) {\n\t\t\t\treader.readAsDataURL(inputFiles[0]);\n\t\t\t} else {\n\t\t\t\tconsole.log(`Unsupported File Type '${inputFiles[0]['type']}'.`);\n\t\t\t\tinputFiles = null;\n\t\t\t}\n\t\t}}\n\t/>\n\n\t<div class=\" space-y-3 overflow-y-scroll max-h-[28rem] md:max-h-full\">\n\t\t<div>\n\t\t\t<h1 class=\" mb-2 text-sm font-medium\">{$i18n.t('UI')}</h1>\n\n\t\t\t<div>\n\t\t\t\t<div class=\"py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<label id=\"ui-scale-label\" class=\" self-center text-xs\" for=\"ui-scale-slider\">\n\t\t\t\t\t\t{$i18n.t('UI Scale')}\n\t\t\t\t\t</label>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"text-xs\"\n\t\t\t\t\t\t\taria-live=\"polite\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tif (textScale === null) {\n\t\t\t\t\t\t\t\t\ttextScale = 1;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttextScale = null;\n\t\t\t\t\t\t\t\t\tsetTextScaleHandler(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if textScale === null}\n\t\t\t\t\t\t\t\t<span>{$i18n.t('Default')}</span>\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<span>{textScale}x</span>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{#if textScale !== null}\n\t\t\t\t\t<div class=\" flex items-center gap-2 px-1 pb-1\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"rounded-lg p-1 transition outline-gray-200 hover:bg-gray-100 dark:outline-gray-700 dark:hover:bg-gray-800\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\ttextScale = Math.max(1, parseFloat((textScale - 0.1).toFixed(2)));\n\t\t\t\t\t\t\t\tsetTextScaleHandler(textScale);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\taria-labelledby=\"ui-scale-label\"\n\t\t\t\t\t\t\taria-label={$i18n.t('Decrease UI Scale')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Minus className=\"h-3.5 w-3.5\" />\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<div class=\"flex-1 flex items-center\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tid=\"ui-scale-slider\"\n\t\t\t\t\t\t\t\tclass=\"w-full\"\n\t\t\t\t\t\t\t\ttype=\"range\"\n\t\t\t\t\t\t\t\tmin=\"1\"\n\t\t\t\t\t\t\t\tmax=\"1.5\"\n\t\t\t\t\t\t\t\tstep={0.01}\n\t\t\t\t\t\t\t\tbind:value={textScale}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsetTextScaleHandler(textScale);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\taria-labelledby=\"ui-scale-label\"\n\t\t\t\t\t\t\t\taria-valuemin=\"1\"\n\t\t\t\t\t\t\t\taria-valuemax=\"1.5\"\n\t\t\t\t\t\t\t\taria-valuenow={textScale}\n\t\t\t\t\t\t\t\taria-valuetext={`${textScale}x`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"rounded-lg p-1 transition outline-gray-200 hover:bg-gray-100 dark:outline-gray-700 dark:hover:bg-gray-800\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\ttextScale = Math.min(1.5, parseFloat((textScale + 0.1).toFixed(2)));\n\t\t\t\t\t\t\t\tsetTextScaleHandler(textScale);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\taria-labelledby=\"ui-scale-label\"\n\t\t\t\t\t\t\taria-label={$i18n.t('Increase UI Scale')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Plus className=\"h-3.5 w-3.5\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"high-contrast-mode-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('High Contrast Mode')} ({$i18n.t('Beta')})\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"high-contrast-mode-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={highContrastMode}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ highContrastMode });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"use-chat-title-as-tab-title-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Display chat title in tab')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"use-chat-title-as-tab-title-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={showChatTitleInTab}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ showChatTitleInTab });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\"py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"notification-sound-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Notification Sound')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"notification-sound-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={notificationSound}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ notificationSound });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if notificationSound}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"play-notification-sound-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t('Always Play Notification Sound')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"play-notification-sound-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={notificationSoundAlways}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ notificationSoundAlways });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div>\n\t\t\t\t<div id=\"allow-user-location-label\" class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div class=\" self-center text-xs\">{$i18n.t('Allow User Location')}</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"allow-user-location-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={userLocation}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\ttoggleUserLocation();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"haptic-feedback-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Haptic Feedback')} ({$i18n.t('Android')})\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"haptic-feedback-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={hapticFeedback}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ hapticFeedback });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"copy-formatted-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Copy Formatted Text')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"copy-formatted-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={copyFormatted}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ copyFormatted });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if $user?.role === 'admin'}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"toast-notifications-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t('Toast notifications for new updates')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"toast-notifications-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={showUpdateToast}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ showUpdateToast });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"whats-new-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t(`Show \"What's New\" modal on login`)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"whats-new-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={showChangelog}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ showChangelog });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div class=\" my-2 text-sm font-medium\">{$i18n.t('Chat')}</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"chat-direction-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Chat direction')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-labelledby=\"chat-direction-label chat-direction-mode\"\n\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\ton:click={toggleChangeChatDirection}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"ml-2 self-center\" id=\"chat-direction-mode\">\n\t\t\t\t\t\t\t{chatDirection === 'LTR'\n\t\t\t\t\t\t\t\t? $i18n.t('LTR')\n\t\t\t\t\t\t\t\t: chatDirection === 'RTL'\n\t\t\t\t\t\t\t\t\t? $i18n.t('RTL')\n\t\t\t\t\t\t\t\t\t: $i18n.t('Auto')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"landing-page-mode-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Landing Page Mode')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-labelledby=\"landing-page-mode-label notification-sound-state\"\n\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\ttoggleLandingPageMode();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"ml-2 self-center\" id=\"notification-sound-state\"\n\t\t\t\t\t\t\t>{landingPageMode === '' ? $i18n.t('Default') : $i18n.t('Chat')}</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"chat-background-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Chat Background Image')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-labelledby=\"chat-background-label background-image-url-state\"\n\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tif (backgroundImageUrl !== null) {\n\t\t\t\t\t\t\t\tbackgroundImageUrl = null;\n\t\t\t\t\t\t\t\tsaveSettings({ backgroundImageUrl });\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfilesInputElement.click();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"ml-2 self-center\" id=\"background-image-url-state\"\n\t\t\t\t\t\t\t>{backgroundImageUrl !== null ? $i18n.t('Reset') : $i18n.t('Upload')}</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"chat-bubble-ui-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Chat Bubble UI')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tariaLabelledbyId=\"chat-bubble-ui-label\"\n\t\t\t\t\t\t\tbind:state={chatBubble}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ chatBubble });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if !$settings.chatBubble}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"chat-bubble-username-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t('Display the username instead of You in the Chat')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"chat-bubble-username-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={showUsername}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ showUsername });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"widescreen-mode-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Widescreen Mode')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"widescreen-mode-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={widescreenMode}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ widescreenMode });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if $user.role === 'admin' || $user?.permissions?.chat?.temporary}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"temp-chat-default-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t('Temporary Chat by Default')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"temp-chat-default-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={temporaryChatByDefault}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ temporaryChatByDefault });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"fade-streaming-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Fade Effect for Streaming Text')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"fade-streaming-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={chatFadeStreamingText}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ chatFadeStreamingText });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"auto-generation-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Title Auto-Generation')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"auto-generation-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={titleAutoGenerate}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\ttoggleTitleAutoGenerate();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div class=\" self-center text-xs\" id=\"follow-up-auto-generation-label\">\n\t\t\t\t\t\t{$i18n.t('Follow-Up Auto-Generation')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"follow-up-auto-generation-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={autoFollowUps}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ autoFollowUps });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"chat-tags-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Chat Tags Auto-Generation')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"chat-tags-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={autoTags}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ autoTags });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"auto-copy-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Auto-Copy Response to Clipboard')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"auto-copy-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={responseAutoCopy}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\ttoggleResponseAutoCopy();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"insert-suggestion-prompt-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Insert Suggestion Prompt to Input')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"insert-suggestion-prompt-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={insertSuggestionPrompt}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ insertSuggestionPrompt });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"keep-follow-up-prompts-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Keep Follow-Up Prompts in Chat')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"keep-follow-up-prompts-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={keepFollowUpPrompts}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ keepFollowUpPrompts });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"insert-follow-up-prompt-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Insert Follow-Up Prompt to Input')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"insert-follow-up-prompt-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={insertFollowUpPrompt}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ insertFollowUpPrompt });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"regenerate-menu-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Regenerate Menu')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"regenerate-menu-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={regenerateMenu}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ regenerateMenu });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"always-collapse-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Always Collapse Code Blocks')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"always-collapse-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={collapseCodeBlocks}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ collapseCodeBlocks });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"always-expand-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Always Expand Details')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"always-expand-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={expandDetails}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ expandDetails });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"keep-followup-prompts-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Display Multi-model Responses in Tabs')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"keep-followup-prompts-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={displayMultiModelResponsesInTabs}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ displayMultiModelResponsesInTabs });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"scroll-on-branch-change-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Scroll On Branch Change')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"scroll-on-branch-change-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={scrollOnBranchChange}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ scrollOnBranchChange });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"stylized-pdf-export-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Stylized PDF Export')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"stylized-pdf-export-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={stylizedPdfExport}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ stylizedPdfExport });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<label id=\"floating-action-buttons-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Floating Quick Actions')}\n\t\t\t\t\t</label>\n\n\t\t\t\t\t<div class=\"flex items-center gap-3 p-1\">\n\t\t\t\t\t\t{#if showFloatingActionButtons}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"text-xs text-gray-700 dark:text-gray-400 underline\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\taria-label={$i18n.t('Open Modal To Manage Floating Quick Actions')}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowManageFloatingActionButtonsModal = true;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{$i18n.t('Manage')}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"floating-action-buttons-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={showFloatingActionButtons}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ showFloatingActionButtons });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"web-search-in-chat-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Web Search in Chat')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-labelledby=\"web-search-in-chat-label web-search-state\"\n\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\ttoggleWebSearch();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"ml-2 self-center\" id=\"web-search-state\"\n\t\t\t\t\t\t\t>{webSearch === 'always' ? $i18n.t('Always') : $i18n.t('Default')}</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\" my-2 text-sm font-medium\">{$i18n.t('Input')}</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"enter-key-behavior-label ctrl-enter-to-send-state\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Enter Key Behavior')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-labelledby=\"enter-key-behavior-label\"\n\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\ttogglectrlEnterToSend();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"ml-2 self-center\" id=\"ctrl-enter-to-send-state\"\n\t\t\t\t\t\t\t>{ctrlEnterToSend === true\n\t\t\t\t\t\t\t\t? $i18n.t('Ctrl+Enter to Send')\n\t\t\t\t\t\t\t\t: $i18n.t('Enter to Send')}</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"rich-input-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Rich Text Input for Chat')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tariaLabelledbyId=\"rich-input-label\"\n\t\t\t\t\t\t\tbind:state={richTextInput}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ richTextInput });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if $config?.features?.enable_autocomplete_generation}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"prompt-autocompletion-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t('Prompt Autocompletion')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"prompt-autocompletion-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={promptAutocomplete}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ promptAutocomplete });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t{#if richTextInput}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"show-formatting-toolbar-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t('Show Formatting Toolbar')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"show-formatting-toolbar-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={showFormattingToolbar}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ showFormattingToolbar });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"insert-prompt-as-rich-text-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t('Insert Prompt as Rich Text')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"insert-prompt-as-rich-text-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={insertPromptAsRichText}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ insertPromptAsRichText });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"paste-large-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Paste Large Text as File')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tariaLabelledbyId=\"paste-large-label\"\n\t\t\t\t\t\t\tbind:state={largeTextAsFile}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ largeTextAsFile });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\" my-2 text-sm font-medium\">{$i18n.t('Artifacts')}</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"detect-artifacts-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Detect Artifacts Automatically')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"detect-artifacts-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={detectArtifacts}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ detectArtifacts });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"iframe-sandbox-allow-same-origin-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('iframe Sandbox Allow Same Origin')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"iframe-sandbox-allow-same-origin-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={iframeSandboxAllowSameOrigin}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ iframeSandboxAllowSameOrigin });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"iframe-sandbox-allow-forms-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('iframe Sandbox Allow Forms')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"iframe-sandbox-allow-forms-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={iframeSandboxAllowForms}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ iframeSandboxAllowForms });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\" my-2 text-sm font-medium\">{$i18n.t('Voice')}</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div class=\" self-center text-xs\" id=\"allow-voice-interruption-in-call-label\">\n\t\t\t\t\t\t{$i18n.t('Allow Voice Interruption in Call')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"allow-voice-interruption-in-call-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={voiceInterruption}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ voiceInterruption });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"display-emoji-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Display Emoji in Call')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"display-emoji-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={showEmojiInCall}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ showEmojiInCall });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\" my-2 text-sm font-medium\">{$i18n.t('File')}</div>\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div id=\"image-compression-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t{$i18n.t('Image Compression')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center gap-3 p-1\">\n\t\t\t\t\t\t{#if imageCompression}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"text-xs text-gray-700 dark:text-gray-400 underline\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\taria-label={$i18n.t('Open Modal To Manage Image Compression')}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowManageImageCompressionModal = true;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{$i18n.t('Manage')}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tariaLabelledbyId=\"image-compression-label\"\n\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\tbind:state={imageCompression}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tsaveSettings({ imageCompression });\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if imageCompression}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t\t<div id=\"image-compression-in-channels-label\" class=\" self-center text-xs\">\n\t\t\t\t\t\t\t{$i18n.t('Compress Images in Channels')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 p-1\">\n\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\tariaLabelledbyId=\"image-compression-in-channels-label\"\n\t\t\t\t\t\t\t\ttooltip={true}\n\t\t\t\t\t\t\t\tbind:state={imageCompressionInChannels}\n\t\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\t\tsaveSettings({ imageCompressionInChannels });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\n\t<div class=\"flex justify-end text-sm font-medium\">\n\t\t<button\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\ttype=\"submit\"\n\t\t>\n\t\t\t{$i18n.t('Save')}\n\t\t</button>\n\t</div>\n</form>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { createEventDispatcher, onMount, getContext } from 'svelte';\n\n\timport { user, settings, config } from '$lib/stores';\n\timport { getVoices as _getVoices } from '$lib/apis/audio';\n\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\tconst dispatch = createEventDispatcher();\n\n\tconst i18n = getContext('i18n');\n\n\texport let saveSettings: Function;\n\n\t// Audio\n\tlet conversationMode = false;\n\tlet speechAutoSend = false;\n\tlet responseAutoPlayback = false;\n\tlet nonLocalVoices = false;\n\n\tlet STTEngine = '';\n\tlet STTLanguage = '';\n\n\tlet TTSEngine = '';\n\tlet TTSEngineConfig = {};\n\n\tlet TTSModel = null;\n\tlet TTSModelProgress = null;\n\tlet TTSModelLoading = false;\n\n\tlet voices = [];\n\tlet voice = '';\n\n\t// Audio speed control\n\tlet playbackRate = 1;\n\n\tconst getVoices = async () => {\n\t\tif (TTSEngine === 'browser-kokoro') {\n\t\t\tif (!TTSModel) {\n\t\t\t\tawait loadKokoro();\n\t\t\t}\n\n\t\t\tvoices = Object.entries(TTSModel.voices).map(([key, value]) => {\n\t\t\t\treturn {\n\t\t\t\t\tid: key,\n\t\t\t\t\tname: value.name,\n\t\t\t\t\tlocalService: false\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\tif ($config.audio.tts.engine === '') {\n\t\t\t\tconst getVoicesLoop = setInterval(async () => {\n\t\t\t\t\tvoices = await speechSynthesis.getVoices();\n\n\t\t\t\t\t// do your loop\n\t\t\t\t\tif (voices.length > 0) {\n\t\t\t\t\t\tclearInterval(getVoicesLoop);\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t} else {\n\t\t\t\tconst res = await _getVoices(localStorage.token).catch((e) => {\n\t\t\t\t\ttoast.error(`${e}`);\n\t\t\t\t});\n\n\t\t\t\tif (res) {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t\tvoices = res.voices;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tconst toggleResponseAutoPlayback = async () => {\n\t\tresponseAutoPlayback = !responseAutoPlayback;\n\t\tsaveSettings({ responseAutoPlayback: responseAutoPlayback });\n\t};\n\n\tconst toggleSpeechAutoSend = async () => {\n\t\tspeechAutoSend = !speechAutoSend;\n\t\tsaveSettings({ speechAutoSend: speechAutoSend });\n\t};\n\n\tonMount(async () => {\n\t\tplaybackRate = $settings.audio?.tts?.playbackRate ?? 1;\n\t\tconversationMode = $settings.conversationMode ?? false;\n\t\tspeechAutoSend = $settings.speechAutoSend ?? false;\n\t\tresponseAutoPlayback = $settings.responseAutoPlayback ?? false;\n\n\t\tSTTEngine = $settings?.audio?.stt?.engine ?? '';\n\t\tSTTLanguage = $settings?.audio?.stt?.language ?? '';\n\n\t\tTTSEngine = $settings?.audio?.tts?.engine ?? '';\n\t\tTTSEngineConfig = $settings?.audio?.tts?.engineConfig ?? {};\n\n\t\tif ($settings?.audio?.tts?.defaultVoice === $config.audio.tts.voice) {\n\t\t\tvoice = $settings?.audio?.tts?.voice ?? $config.audio.tts.voice ?? '';\n\t\t} else {\n\t\t\tvoice = $config.audio.tts.voice ?? '';\n\t\t}\n\n\t\tnonLocalVoices = $settings.audio?.tts?.nonLocalVoices ?? false;\n\n\t\tawait getVoices();\n\t});\n\n\t$: if (TTSEngine && TTSEngineConfig) {\n\t\tonTTSEngineChange();\n\t}\n\n\tconst onTTSEngineChange = async () => {\n\t\tif (TTSEngine === 'browser-kokoro') {\n\t\t\tawait loadKokoro();\n\t\t}\n\t};\n\n\tconst loadKokoro = async () => {\n\t\tif (TTSEngine === 'browser-kokoro') {\n\t\t\tvoices = [];\n\n\t\t\tif (TTSEngineConfig?.dtype) {\n\t\t\t\tTTSModel = null;\n\t\t\t\tTTSModelProgress = null;\n\t\t\t\tTTSModelLoading = true;\n\n\t\t\t\tconst model_id = 'onnx-community/Kokoro-82M-v1.0-ONNX';\n\n\t\t\t\tconst { KokoroTTS } = await import('kokoro-js');\n\t\t\t\tTTSModel = await KokoroTTS.from_pretrained(model_id, {\n\t\t\t\t\tdtype: TTSEngineConfig.dtype, // Options: \"fp32\", \"fp16\", \"q8\", \"q4\", \"q4f16\"\n\t\t\t\t\tdevice: !!navigator?.gpu ? 'webgpu' : 'wasm', // Detect WebGPU\n\t\t\t\t\tprogress_callback: (e) => {\n\t\t\t\t\t\tTTSModelProgress = e;\n\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tawait getVoices();\n\n\t\t\t\t// const rawAudio = await tts.generate(inputText, {\n\t\t\t\t// \t// Use `tts.list_voices()` to list all available voices\n\t\t\t\t// \tvoice: voice\n\t\t\t\t// });\n\n\t\t\t\t// const blobUrl = URL.createObjectURL(await rawAudio.toBlob());\n\t\t\t\t// const audio = new Audio(blobUrl);\n\n\t\t\t\t// audio.play();\n\t\t\t}\n\t\t}\n\t};\n</script>\n\n<form\n\tid=\"tab-audio\"\n\tclass=\"flex flex-col h-full justify-between space-y-3 text-sm\"\n\ton:submit|preventDefault={async () => {\n\t\tsaveSettings({\n\t\t\taudio: {\n\t\t\t\tstt: {\n\t\t\t\t\tengine: STTEngine !== '' ? STTEngine : undefined,\n\t\t\t\t\tlanguage: STTLanguage !== '' ? STTLanguage : undefined\n\t\t\t\t},\n\t\t\t\ttts: {\n\t\t\t\t\tengine: TTSEngine !== '' ? TTSEngine : undefined,\n\t\t\t\t\tengineConfig: TTSEngineConfig,\n\t\t\t\t\tplaybackRate: playbackRate,\n\t\t\t\t\tvoice: voice !== '' ? voice : undefined,\n\t\t\t\t\tdefaultVoice: $config?.audio?.tts?.voice ?? '',\n\t\t\t\t\tnonLocalVoices: $config.audio.tts.engine === '' ? nonLocalVoices : undefined\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tdispatch('save');\n\t}}\n>\n\t<div class=\" space-y-3 overflow-y-scroll max-h-[28rem] md:max-h-full\">\n\t\t<div>\n\t\t\t<div class=\" mb-1 text-sm font-medium\">{$i18n.t('STT Settings')}</div>\n\n\t\t\t{#if $config.audio.stt.engine !== 'web'}\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Speech-to-Text Engine')}</div>\n\t\t\t\t\t<div class=\"flex items-center relative\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tclass=\"dark:bg-gray-900 w-fit pr-8 rounded-sm px-2 p-1 text-xs bg-transparent outline-hidden text-right\"\n\t\t\t\t\t\t\tbind:value={STTEngine}\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Select an engine')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\">{$i18n.t('Default')}</option>\n\t\t\t\t\t\t\t<option value=\"web\">{$i18n.t('Web API')}</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Language')}</div>\n\n\t\t\t\t\t<div class=\"flex items-center relative text-xs px-3\">\n\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\tcontent={$i18n.t(\n\t\t\t\t\t\t\t\t'The language of the input audio. Supplying the input language in ISO-639-1 (e.g. en) format will improve accuracy and latency. Leave blank to automatically detect the language.'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tplacement=\"top\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tbind:value={STTLanguage}\n\t\t\t\t\t\t\t\tplaceholder={$i18n.t('e.g. en')}\n\t\t\t\t\t\t\t\tclass=\" text-sm text-right bg-transparent dark:text-gray-300 outline-hidden\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-xs font-medium\">\n\t\t\t\t\t{$i18n.t('Instant Auto-Send After Voice Transcription')}\n\t\t\t\t</div>\n\n\t\t\t\t<button\n\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\ttoggleSpeechAutoSend();\n\t\t\t\t\t}}\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t>\n\t\t\t\t\t{#if speechAutoSend === true}\n\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('On')}</span>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Off')}</span>\n\t\t\t\t\t{/if}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div>\n\t\t\t<div class=\" mb-1 text-sm font-medium\">{$i18n.t('TTS Settings')}</div>\n\n\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Text-to-Speech Engine')}</div>\n\t\t\t\t<div class=\"flex items-center relative\">\n\t\t\t\t\t<select\n\t\t\t\t\t\tclass=\"dark:bg-gray-900 w-fit pr-8 rounded-sm px-2 p-1 text-xs bg-transparent outline-hidden text-right\"\n\t\t\t\t\t\tbind:value={TTSEngine}\n\t\t\t\t\t\tplaceholder={$i18n.t('Select an engine')}\n\t\t\t\t\t>\n\t\t\t\t\t\t<option value=\"\">{$i18n.t('Default')}</option>\n\t\t\t\t\t\t<option value=\"browser-kokoro\">{$i18n.t('Kokoro.js (Browser)')}</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if TTSEngine === 'browser-kokoro'}\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Kokoro.js Dtype')}</div>\n\t\t\t\t\t<div class=\"flex items-center relative\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tclass=\"dark:bg-gray-900 w-fit pr-8 rounded-sm px-2 p-1 text-xs bg-transparent outline-hidden text-right\"\n\t\t\t\t\t\t\tbind:value={TTSEngineConfig.dtype}\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Select dtype')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\" disabled selected>{$i18n.t('Select dtype')}</option>\n\t\t\t\t\t\t\t<option value=\"fp32\">fp32</option>\n\t\t\t\t\t\t\t<option value=\"fp16\">fp16</option>\n\t\t\t\t\t\t\t<option value=\"q8\">q8</option>\n\t\t\t\t\t\t\t<option value=\"q4\">q4</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Auto-playback response')}</div>\n\n\t\t\t\t<button\n\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\ttoggleResponseAutoPlayback();\n\t\t\t\t\t}}\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t>\n\t\t\t\t\t{#if responseAutoPlayback === true}\n\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('On')}</span>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Off')}</span>\n\t\t\t\t\t{/if}\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Speech Playback Speed')}</div>\n\n\t\t\t\t<div class=\"flex items-center relative text-xs px-3\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\tbind:value={playbackRate}\n\t\t\t\t\t\tclass=\" text-sm text-right bg-transparent dark:text-gray-300 outline-hidden\"\n\t\t\t\t\t/>\n\t\t\t\t\tx\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<hr class=\" border-gray-100/30 dark:border-gray-850/30\" />\n\n\t\t{#if TTSEngine === 'browser-kokoro'}\n\t\t\t{#if TTSModel}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" mb-2.5 text-sm font-medium\">{$i18n.t('Set Voice')}</div>\n\t\t\t\t\t<div class=\"flex w-full\">\n\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tlist=\"voice-list\"\n\t\t\t\t\t\t\t\tclass=\"w-full text-sm bg-transparent dark:text-gray-300 outline-hidden\"\n\t\t\t\t\t\t\t\tbind:value={voice}\n\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Select a voice')}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<datalist id=\"voice-list\">\n\t\t\t\t\t\t\t\t{#each voices as voice}\n\t\t\t\t\t\t\t\t\t<option value={voice.id}>{voice.name}</option>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</datalist>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\" mb-2.5 text-sm font-medium flex gap-2 items-center\">\n\t\t\t\t\t\t<Spinner className=\"size-4\" />\n\n\t\t\t\t\t\t<div class=\" text-sm font-medium shimmer\">\n\t\t\t\t\t\t\t{$i18n.t('Loading Kokoro.js...')}\n\t\t\t\t\t\t\t{TTSModelProgress && TTSModelProgress.status === 'progress'\n\t\t\t\t\t\t\t\t? `(${Math.round(TTSModelProgress.progress * 10) / 10}%)`\n\t\t\t\t\t\t\t\t: ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"text-xs text-gray-500\">\n\t\t\t\t\t\t{$i18n.t('Please do not close the settings page while loading the model.')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t{:else if $config.audio.tts.engine === ''}\n\t\t\t<div>\n\t\t\t\t<div class=\" mb-2.5 text-sm font-medium\">{$i18n.t('Set Voice')}</div>\n\t\t\t\t<div class=\"flex w-full\">\n\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tclass=\"dark:bg-gray-900 w-full text-sm bg-transparent dark:text-gray-300 outline-hidden\"\n\t\t\t\t\t\t\tbind:value={voice}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\" selected={voice !== ''}>{$i18n.t('Default')}</option>\n\t\t\t\t\t\t\t{#each voices.filter((v) => nonLocalVoices || v.localService === true) as _voice}\n\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\tvalue={_voice.name}\n\t\t\t\t\t\t\t\t\tclass=\"bg-gray-100 dark:bg-gray-700\"\n\t\t\t\t\t\t\t\t\tselected={voice === _voice.name}>{_voice.name}</option\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex items-center justify-between my-1.5\">\n\t\t\t\t\t<div class=\"text-xs\">\n\t\t\t\t\t\t{$i18n.t('Allow non-local voices')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"mt-1\">\n\t\t\t\t\t\t<Switch bind:state={nonLocalVoices} />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{:else if $config.audio.tts.engine !== ''}\n\t\t\t<div>\n\t\t\t\t<div class=\" mb-2.5 text-sm font-medium\">{$i18n.t('Set Voice')}</div>\n\t\t\t\t<div class=\"flex w-full\">\n\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tlist=\"voice-list\"\n\t\t\t\t\t\t\tclass=\"w-full text-sm bg-transparent dark:text-gray-300 outline-hidden\"\n\t\t\t\t\t\t\tbind:value={voice}\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Select a voice')}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<datalist id=\"voice-list\">\n\t\t\t\t\t\t\t{#each voices as voice}\n\t\t\t\t\t\t\t\t<option value={voice.id}>{voice.name}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</datalist>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t<div class=\"flex justify-end text-sm font-medium\">\n\t\t<button\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\ttype=\"submit\"\n\t\t>\n\t\t\t{$i18n.t('Save')}\n\t\t</button>\n\t</div>\n</form>\n","<script lang=\"ts\">\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\timport {\n\t\tchats,\n\t\tuser,\n\t\tsettings,\n\t\tscrollPaginationEnabled,\n\t\tcurrentChatPage,\n\t\tpinnedChats\n\t} from '$lib/stores';\n\n\timport {\n\t\tarchiveAllChats,\n\t\tdeleteAllChats,\n\t\tgetAllChats,\n\t\tgetChatList,\n\t\tgetPinnedChatList,\n\t\timportChats\n\t} from '$lib/apis/chats';\n\timport { getImportOrigin, convertOpenAIChats } from '$lib/utils';\n\timport { onMount, getContext } from 'svelte';\n\timport { goto } from '$app/navigation';\n\timport { toast } from 'svelte-sonner';\n\timport ArchivedChatsModal from '$lib/components/layout/ArchivedChatsModal.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let saveSettings: Function;\n\n\t// Chats\n\tlet importFiles;\n\n\tlet showArchiveConfirm = false;\n\tlet showDeleteConfirm = false;\n\tlet showArchivedChatsModal = false;\n\n\tlet chatImportInputElement: HTMLInputElement;\n\n\t$: if (importFiles) {\n\t\tconsole.log(importFiles);\n\n\t\tlet reader = new FileReader();\n\t\treader.onload = (event) => {\n\t\t\tlet chats = JSON.parse(event.target.result);\n\t\t\tconsole.log(chats);\n\t\t\tif (getImportOrigin(chats) == 'openai') {\n\t\t\t\ttry {\n\t\t\t\t\tchats = convertOpenAIChats(chats);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.log('Unable to import chats:', error);\n\t\t\t\t}\n\t\t\t}\n\t\t\timportChatsHandler(chats);\n\t\t};\n\n\t\tif (importFiles.length > 0) {\n\t\t\treader.readAsText(importFiles[0]);\n\t\t}\n\t}\n\n\tconst importChatsHandler = async (_chats) => {\n\t\tconst res = await importChats(\n\t\t\tlocalStorage.token,\n\t\t\t_chats.map((chat) => {\n\t\t\t\tif (chat.chat) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tchat: chat.chat,\n\t\t\t\t\t\tmeta: chat.meta ?? {},\n\t\t\t\t\t\tpinned: false,\n\t\t\t\t\t\tfolder_id: chat?.folder_id ?? null,\n\t\t\t\t\t\tcreated_at: chat?.created_at ?? null,\n\t\t\t\t\t\tupdated_at: chat?.updated_at ?? null\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\t// Legacy format\n\t\t\t\t\treturn {\n\t\t\t\t\t\tchat: chat,\n\t\t\t\t\t\tmeta: {},\n\t\t\t\t\t\tpinned: false,\n\t\t\t\t\t\tfolder_id: null,\n\t\t\t\t\t\tcreated_at: chat?.created_at ?? null,\n\t\t\t\t\t\tupdated_at: chat?.updated_at ?? null\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tif (res) {\n\t\t\ttoast.success(`Successfully imported ${res.length} chats.`);\n\t\t}\n\n\t\tcurrentChatPage.set(1);\n\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\tpinnedChats.set(await getPinnedChatList(localStorage.token));\n\t\tscrollPaginationEnabled.set(true);\n\t};\n\n\tconst exportChats = async () => {\n\t\tlet blob = new Blob([JSON.stringify(await getAllChats(localStorage.token))], {\n\t\t\ttype: 'application/json'\n\t\t});\n\t\tsaveAs(blob, `chat-export-${Date.now()}.json`);\n\t};\n\n\tconst archiveAllChatsHandler = async () => {\n\t\tawait goto('/');\n\t\tawait archiveAllChats(localStorage.token).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t});\n\n\t\tcurrentChatPage.set(1);\n\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\tpinnedChats.set([]);\n\t\tscrollPaginationEnabled.set(true);\n\t};\n\n\tconst deleteAllChatsHandler = async () => {\n\t\tawait goto('/');\n\t\tawait deleteAllChats(localStorage.token).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t});\n\n\t\tcurrentChatPage.set(1);\n\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\tscrollPaginationEnabled.set(true);\n\t};\n\n\tconst handleArchivedChatsChange = async () => {\n\t\tcurrentChatPage.set(1);\n\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\n\t\tscrollPaginationEnabled.set(true);\n\t};\n</script>\n\n<ArchivedChatsModal bind:show={showArchivedChatsModal} onUpdate={handleArchivedChatsChange} />\n\n<div id=\"tab-chats\" class=\"flex flex-col h-full justify-between space-y-3 text-sm\">\n\t<div class=\" space-y-2 overflow-y-scroll max-h-[28rem] md:max-h-full\">\n\t\t<div class=\"flex flex-col\">\n\t\t\t<input\n\t\t\t\tid=\"chat-import-input\"\n\t\t\t\tbind:this={chatImportInputElement}\n\t\t\t\tbind:files={importFiles}\n\t\t\t\ttype=\"file\"\n\t\t\t\taccept=\".json\"\n\t\t\t\thidden\n\t\t\t/>\n\t\t\t<button\n\t\t\t\tclass=\" flex rounded-md py-2 px-3.5 w-full hover:bg-gray-200 dark:hover:bg-gray-800 transition\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tchatImportInputElement.click();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div class=\" self-center mr-3\">\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\td=\"M4 2a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 4 14h8a1.5 1.5 0 0 0 1.5-1.5V6.621a1.5 1.5 0 0 0-.44-1.06L9.94 2.439A1.5 1.5 0 0 0 8.878 2H4Zm4 9.5a.75.75 0 0 1-.75-.75V8.06l-.72.72a.75.75 0 0 1-1.06-1.06l2-2a.75.75 0 0 1 1.06 0l2 2a.75.75 0 1 1-1.06 1.06l-.72-.72v2.69a.75.75 0 0 1-.75.75Z\"\n\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\" self-center text-sm font-medium\">{$i18n.t('Import Chats')}</div>\n\t\t\t</button>\n\n\t\t\t{#if $user?.role === 'admin' || ($user.permissions?.chat?.export ?? true)}\n\t\t\t\t<button\n\t\t\t\t\tclass=\" flex rounded-md py-2 px-3.5 w-full hover:bg-gray-200 dark:hover:bg-gray-800 transition\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\texportChats();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\" self-center mr-3\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\td=\"M4 2a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 4 14h8a1.5 1.5 0 0 0 1.5-1.5V6.621a1.5 1.5 0 0 0-.44-1.06L9.94 2.439A1.5 1.5 0 0 0 8.878 2H4Zm4 3.5a.75.75 0 0 1 .75.75v2.69l.72-.72a.75.75 0 1 1 1.06 1.06l-2 2a.75.75 0 0 1-1.06 0l-2-2a.75.75 0 0 1 1.06-1.06l.72.72V6.25A.75.75 0 0 1 8 5.5Z\"\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\" self-center text-sm font-medium\">{$i18n.t('Export Chats')}</div>\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<hr class=\" border-gray-100/30 dark:border-gray-850/30\" />\n\n\t\t<div class=\"flex flex-col\">\n\t\t\t<button\n\t\t\t\tclass=\" flex rounded-md py-2 px-3.5 w-full hover:bg-gray-200 dark:hover:bg-gray-800 transition\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowArchivedChatsModal = true;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div class=\" self-center mr-3\">\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M3.375 3C2.339 3 1.5 3.84 1.5 4.875v.75c0 1.036.84 1.875 1.875 1.875h17.25c1.035 0 1.875-.84 1.875-1.875v-.75C22.5 3.839 21.66 3 20.625 3H3.375Z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\td=\"m3.087 9 .54 9.176A3 3 0 0 0 6.62 21h10.757a3 3 0 0 0 2.995-2.824L20.913 9H3.087ZM12 10.5a.75.75 0 0 1 .75.75v4.94l1.72-1.72a.75.75 0 1 1 1.06 1.06l-3 3a.75.75 0 0 1-1.06 0l-3-3a.75.75 0 1 1 1.06-1.06l1.72 1.72v-4.94a.75.75 0 0 1 .75-.75Z\"\n\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\" self-center text-sm font-medium\">{$i18n.t('Archived Chats')}</div>\n\t\t\t</button>\n\n\t\t\t{#if showArchiveConfirm}\n\t\t\t\t<div class=\"flex justify-between rounded-md items-center py-2 px-3.5 w-full transition\">\n\t\t\t\t\t<div class=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path d=\"M2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3Z\" />\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\td=\"M13 6H3v6a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V6ZM5.72 7.47a.75.75 0 0 1 1.06 0L8 8.69l1.22-1.22a.75.75 0 1 1 1.06 1.06L9.06 9.75l1.22 1.22a.75.75 0 1 1-1.06 1.06L8 10.81l-1.22 1.22a.75.75 0 0 1-1.06-1.06l1.22-1.22-1.22-1.22a.75.75 0 0 1 0-1.06Z\"\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<span>{$i18n.t('Are you sure?')}</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex space-x-1.5 items-center\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"hover:text-white transition\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tarchiveAllChatsHandler();\n\t\t\t\t\t\t\t\tshowArchiveConfirm = false;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\td=\"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z\"\n\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"hover:text-white transition\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tshowArchiveConfirm = false;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<button\n\t\t\t\t\tclass=\" flex rounded-md py-2 px-3.5 w-full hover:bg-gray-200 dark:hover:bg-gray-800 transition\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshowArchiveConfirm = true;\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\" self-center mr-3\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M3.375 3C2.339 3 1.5 3.84 1.5 4.875v.75c0 1.036.84 1.875 1.875 1.875h17.25c1.035 0 1.875-.84 1.875-1.875v-.75C22.5 3.839 21.66 3 20.625 3H3.375Z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\td=\"m3.087 9 .54 9.176A3 3 0 0 0 6.62 21h10.757a3 3 0 0 0 2.995-2.824L20.913 9H3.087Zm6.163 3.75A.75.75 0 0 1 10 12h4a.75.75 0 0 1 0 1.5h-4a.75.75 0 0 1-.75-.75Z\"\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\" self-center text-sm font-medium\">{$i18n.t('Archive All Chats')}</div>\n\t\t\t\t</button>\n\t\t\t{/if}\n\n\t\t\t{#if showDeleteConfirm}\n\t\t\t\t<div class=\"flex justify-between rounded-md items-center py-2 px-3.5 w-full transition\">\n\t\t\t\t\t<div class=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path d=\"M2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3Z\" />\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\td=\"M13 6H3v6a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V6ZM5.72 7.47a.75.75 0 0 1 1.06 0L8 8.69l1.22-1.22a.75.75 0 1 1 1.06 1.06L9.06 9.75l1.22 1.22a.75.75 0 1 1-1.06 1.06L8 10.81l-1.22 1.22a.75.75 0 0 1-1.06-1.06l1.22-1.22-1.22-1.22a.75.75 0 0 1 0-1.06Z\"\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<span>{$i18n.t('Are you sure?')}</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex space-x-1.5 items-center\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"hover:text-white transition\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tdeleteAllChatsHandler();\n\t\t\t\t\t\t\t\tshowDeleteConfirm = false;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\td=\"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z\"\n\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"hover:text-white transition\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tshowDeleteConfirm = false;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<button\n\t\t\t\t\tclass=\" flex rounded-md py-2 px-3.5 w-full hover:bg-gray-200 dark:hover:bg-gray-800 transition\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\" self-center mr-3\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\td=\"M4 2a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 4 14h8a1.5 1.5 0 0 0 1.5-1.5V6.621a1.5 1.5 0 0 0-.44-1.06L9.94 2.439A1.5 1.5 0 0 0 8.878 2H4Zm7 7a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1 0-1.5h4.5A.75.75 0 0 1 11 9Z\"\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\" self-center text-sm font-medium\">{$i18n.t('Delete All Chats')}</div>\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n</div>\n","import { WEBUI_API_BASE_URL } from '$lib/constants';\n\nexport const getMemories = async (token: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/memories/`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const addNewMemory = async (token: string, content: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/memories/add`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tcontent: content\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateMemoryById = async (token: string, id: string, content: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/memories/${id}/update`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tcontent: content\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const queryMemory = async (token: string, content: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/memories/query`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tcontent: content\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const deleteMemoryById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/memories/${id}`, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const deleteMemoriesByUserId = async (token: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/memories/delete/user`, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n","<script>\n\timport { createEventDispatcher, getContext } from 'svelte';\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport { addNewMemory, updateMemoryById } from '$lib/apis/memories';\n\timport { toast } from 'svelte-sonner';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\n\tconst dispatch = createEventDispatcher();\n\n\texport let show;\n\tconst i18n = getContext('i18n');\n\n\tlet loading = false;\n\tlet content = '';\n\n\tconst submitHandler = async () => {\n\t\tloading = true;\n\n\t\tconst res = await addNewMemory(localStorage.token, content).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tconsole.log(res);\n\t\t\ttoast.success($i18n.t('Memory added successfully'));\n\t\t\tcontent = '';\n\t\t\tshow = false;\n\t\t\tdispatch('save');\n\t\t}\n\n\t\tloading = false;\n\t};\n</script>\n\n<Modal bind:show size=\"sm\">\n\t<div>\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-2\">\n\t\t\t<div class=\" text-lg font-medium self-center\">\n\t\t\t\t{$i18n.t('Add Memory')}\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className={'size-5'} />\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full px-5 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t<form\n\t\t\t\t\tclass=\"flex flex-col w-full\"\n\t\t\t\t\ton:submit|preventDefault={() => {\n\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tbind:value={content}\n\t\t\t\t\t\t\tclass=\" bg-transparent w-full text-sm rounded-xl p-3 outline outline-1 outline-gray-100 dark:outline-gray-800\"\n\t\t\t\t\t\t\trows=\"6\"\n\t\t\t\t\t\t\tstyle=\"resize: vertical;\"\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Enter a detail about yourself for your LLMs to recall')}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<div class=\"text-xs text-gray-500\">\n\t\t\t\t\t\t\t {$i18n.t('Refer to yourself as \"User\" (e.g., \"User is learning Spanish\")')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex justify-end pt-1 text-sm font-medium\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full {loading\n\t\t\t\t\t\t\t\t? ' cursor-not-allowed'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{$i18n.t('Add')}\n\n\t\t\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t\t\t<div class=\"ml-2 self-center\">\n\t\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n","<script>\n\timport { createEventDispatcher, getContext } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\n\timport { updateMemoryById } from '$lib/apis/memories';\n\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\n\tconst dispatch = createEventDispatcher();\n\n\texport let show;\n\texport let memory = {};\n\n\tconst i18n = getContext('i18n');\n\n\tlet loading = false;\n\tlet content = '';\n\n\t$: if (show) {\n\t\tsetContent();\n\t}\n\n\tconst setContent = () => {\n\t\tcontent = memory.content;\n\t};\n\n\tconst submitHandler = async () => {\n\t\tloading = true;\n\n\t\tconst res = await updateMemoryById(localStorage.token, memory.id, content).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tconsole.log(res);\n\t\t\ttoast.success($i18n.t('Memory updated successfully'));\n\t\t\tdispatch('save');\n\t\t\tshow = false;\n\t\t}\n\n\t\tloading = false;\n\t};\n</script>\n\n<Modal bind:show size=\"sm\">\n\t<div>\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-2\">\n\t\t\t<div class=\" text-lg font-medium self-center\">\n\t\t\t\t{$i18n.t('Edit Memory')}\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className={'size-5'} />\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full px-5 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t<form\n\t\t\t\t\tclass=\"flex flex-col w-full\"\n\t\t\t\t\ton:submit|preventDefault={() => {\n\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tbind:value={content}\n\t\t\t\t\t\t\tclass=\" bg-transparent w-full text-sm rounded-xl p-3 outline outline-1 outline-gray-100 dark:outline-gray-800\"\n\t\t\t\t\t\t\trows=\"6\"\n\t\t\t\t\t\t\tstyle=\"resize: vertical;\"\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Enter a detail about yourself for your LLMs to recall')}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<div class=\"text-xs text-gray-500\">\n\t\t\t\t\t\t\t {$i18n.t('Refer to yourself as \"User\" (e.g., \"User is learning Spanish\")')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex justify-end pt-1 text-sm font-medium\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full {loading\n\t\t\t\t\t\t\t\t? ' cursor-not-allowed'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{$i18n.t('Update')}\n\n\t\t\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t\t\t<div class=\"ml-2 self-center\">\n\t\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport dayjs from 'dayjs';\n\timport { getContext, createEventDispatcher } from 'svelte';\n\n\tconst dispatch = createEventDispatcher();\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport AddMemoryModal from './AddMemoryModal.svelte';\n\timport { deleteMemoriesByUserId, deleteMemoryById, getMemories } from '$lib/apis/memories';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport { error } from '@sveltejs/kit';\n\timport EditMemoryModal from './EditMemoryModal.svelte';\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\n\timport ConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\n\tconst i18n = getContext('i18n');\n\tdayjs.extend(localizedFormat);\n\n\texport let show = false;\n\n\tlet memories = [];\n\tlet loading = true;\n\n\tlet showAddMemoryModal = false;\n\tlet showEditMemoryModal = false;\n\n\tlet selectedMemory = null;\n\n\tlet showClearConfirmDialog = false;\n\n\tlet onClearConfirmed = async () => {\n\t\tconst res = await deleteMemoriesByUserId(localStorage.token).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res && memories.length > 0) {\n\t\t\ttoast.success($i18n.t('Memory cleared successfully'));\n\t\t\tmemories = [];\n\t\t}\n\t\tshowClearConfirmDialog = false;\n\t};\n\n\t$: if (show && memories.length === 0 && loading) {\n\t\t(async () => {\n\t\t\tmemories = await getMemories(localStorage.token);\n\t\t\tloading = false;\n\t\t})();\n\t}\n</script>\n\n<Modal size=\"lg\" bind:show>\n\t<div>\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-1\">\n\t\t\t<div class=\" text-lg font-medium self-center\">{$i18n.t('Memory')}</div>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col w-full px-5 pb-5 dark:text-gray-200\">\n\t\t\t<div\n\t\t\t\tclass=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6 h-[28rem] max-h-screen rounded-xl mb-4 mt-1\"\n\t\t\t>\n\t\t\t\t{#if memories.length > 0}\n\t\t\t\t\t<div class=\"text-left text-sm w-full mb-4 overflow-y-scroll\">\n\t\t\t\t\t\t<div class=\"relative overflow-x-auto\">\n\t\t\t\t\t\t\t<table class=\"w-full text-sm text-left text-gray-600 dark:text-gray-400 table-auto\">\n\t\t\t\t\t\t\t\t<thead\n\t\t\t\t\t\t\t\t\tclass=\"text-xs text-gray-700 uppercase bg-transparent dark:text-gray-200 border-b-2 border-gray-50 dark:border-gray-850/30\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<th scope=\"col\" class=\"px-3 py-2\"> {$i18n.t('Name')} </th>\n\t\t\t\t\t\t\t\t\t\t<th scope=\"col\" class=\"px-3 py-2 hidden md:flex\">\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Last Modified')}\n\t\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t\t<th scope=\"col\" class=\"px-3 py-2 text-right\" />\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t{#each memories as memory}\n\t\t\t\t\t\t\t\t\t\t<tr class=\"border-b border-gray-50 dark:border-gray-850/30 items-center\">\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"px-3 py-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"line-clamp-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{memory.content}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\" px-3 py-1 hidden md:flex h-[2.5rem]\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"my-auto whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{dayjs(memory.updated_at * 1000).format('LLL')}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"px-3 py-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex justify-end w-full\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content=\"Edit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit text-sm px-2 py-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedMemory = memory;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowEditMemoryModal = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 s-FoVA_WMOgxUD\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t><path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"s-FoVA_WMOgxUD\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/></svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content=\"Delete\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit text-sm px-2 py-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst res = await deleteMemoryById(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmemory.id\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.success($i18n.t('Memory deleted successfully'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmemories = await getMemories(localStorage.token);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"text-center flex h-full text-sm w-full\">\n\t\t\t\t\t\t<div class=\" my-auto pb-10 px-4 w-full text-gray-500\">\n\t\t\t\t\t\t\t{$i18n.t('Memories accessible by LLMs will be shown here.')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div class=\"flex text-sm font-medium gap-1.5\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\" px-3.5 py-1.5 font-medium hover:bg-black/5 dark:hover:bg-white/5 outline outline-1 outline-gray-100 dark:outline-gray-800 rounded-3xl\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshowAddMemoryModal = true;\n\t\t\t\t\t}}>{$i18n.t('Add Memory')}</button\n\t\t\t\t>\n\t\t\t\t<button\n\t\t\t\t\tclass=\" px-3.5 py-1.5 font-medium text-red-500 hover:bg-black/5 dark:hover:bg-white/5 outline outline-1 outline-red-100 dark:outline-red-800 rounded-3xl\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tif (memories.length > 0) {\n\t\t\t\t\t\t\tshowClearConfirmDialog = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error($i18n.t('No memories to clear'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}}>{$i18n.t('Clear memory')}</button\n\t\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n\n<ConfirmDialog\n\ttitle={$i18n.t('Clear Memory')}\n\tmessage={$i18n.t('Are you sure you want to clear all memories? This action cannot be undone.')}\n\tshow={showClearConfirmDialog}\n\ton:confirm={onClearConfirmed}\n\ton:cancel={() => {\n\t\tshowClearConfirmDialog = false;\n\t}}\n/>\n\n<AddMemoryModal\n\tbind:show={showAddMemoryModal}\n\ton:save={async () => {\n\t\tmemories = await getMemories(localStorage.token);\n\t}}\n/>\n\n<EditMemoryModal\n\tbind:show={showEditMemoryModal}\n\tmemory={selectedMemory}\n\ton:save={async () => {\n\t\tmemories = await getMemories(localStorage.token);\n\t}}\n/>\n","<script lang=\"ts\">\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport { config, models, settings, user } from '$lib/stores';\n\timport { createEventDispatcher, onMount, getContext, tick } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\timport ManageModal from './Personalization/ManageModal.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\tconst dispatch = createEventDispatcher();\n\n\tconst i18n = getContext('i18n');\n\n\texport let saveSettings: Function;\n\n\tlet showManageModal = false;\n\n\t// Addons\n\tlet enableMemory = false;\n\n\tonMount(async () => {\n\t\tenableMemory = $settings?.memory ?? false;\n\t});\n</script>\n\n<ManageModal bind:show={showManageModal} />\n\n<form\n\tid=\"tab-personalization\"\n\tclass=\"flex flex-col h-full justify-between space-y-3 text-sm\"\n\ton:submit|preventDefault={() => {\n\t\tdispatch('save');\n\t}}\n>\n\t<div class=\"py-1 overflow-y-scroll max-h-[28rem] md:max-h-full\">\n\t\t<div>\n\t\t\t<div class=\"flex items-center justify-between mb-1\">\n\t\t\t\t<Tooltip\n\t\t\t\t\tcontent={$i18n.t(\n\t\t\t\t\t\t'This is an experimental feature, it may not function as expected and is subject to change at any time.'\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"text-sm font-medium\">\n\t\t\t\t\t\t{$i18n.t('Memory')}\n\n\t\t\t\t\t\t<span class=\" text-xs text-gray-500\">({$i18n.t('Experimental')})</span>\n\t\t\t\t\t</div>\n\t\t\t\t</Tooltip>\n\n\t\t\t\t<div class=\"\">\n\t\t\t\t\t<Switch\n\t\t\t\t\t\tbind:state={enableMemory}\n\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\tsaveSettings({ memory: enableMemory });\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"text-xs text-gray-600 dark:text-gray-400\">\n\t\t\t<div>\n\t\t\t\t{$i18n.t(\n\t\t\t\t\t\"You can personalize your interactions with LLMs by adding memories through the 'Manage' button below, making them more helpful and tailored to you.\"\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t<!-- <div class=\"mt-3\">\n\t\t\t\tTo understand what LLM remembers or teach it something new, just chat with it:\n\n\t\t\t\t<div>- Remember that I like concise responses.</div>\n\t\t\t\t<div>- I just got a puppy!</div>\n\t\t\t\t<div>- What do you remember about me?</div>\n\t\t\t\t<div>- Where did we leave off on my last project?</div>\n\t\t\t</div> -->\n\t\t</div>\n\n\t\t<div class=\"mt-3 mb-1 ml-1\">\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclass=\" px-3.5 py-1.5 font-medium hover:bg-black/5 dark:hover:bg-white/5 outline outline-1 outline-gray-300 dark:outline-gray-800 rounded-3xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowManageModal = true;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{$i18n.t('Manage')}\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t<div class=\"flex justify-end text-sm font-medium\">\n\t\t<button\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\ttype=\"submit\"\n\t\t>\n\t\t\t{$i18n.t('Save')}\n\t\t</button>\n\t</div>\n</form>\n","<script lang=\"ts\">\n\timport { getContext, tick } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { settings } from '$lib/stores';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport SensitiveInput from '$lib/components/common/SensitiveInput.svelte';\n\timport Cog6 from '$lib/components/icons/Cog6.svelte';\n\timport AddConnectionModal from '$lib/components/AddConnectionModal.svelte';\n\timport ConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\n\texport let onDelete = () => {};\n\texport let onSubmit = () => {};\n\n\texport let pipeline = false;\n\n\texport let url = '';\n\texport let key = '';\n\texport let config = {};\n\n\tlet showConfigModal = false;\n\tlet showDeleteConfirmDialog = false;\n</script>\n\n<AddConnectionModal\n\tedit\n\tdirect\n\tbind:show={showConfigModal}\n\tconnection={{\n\t\turl,\n\t\tkey,\n\t\tconfig\n\t}}\n\tonDelete={() => {\n\t\tshowDeleteConfirmDialog = true;\n\t}}\n\tonSubmit={(connection) => {\n\t\turl = connection.url;\n\t\tkey = connection.key;\n\t\tconfig = connection.config;\n\t\tonSubmit(connection);\n\t}}\n/>\n\n<ConfirmDialog\n\tbind:show={showDeleteConfirmDialog}\n\ton:confirm={() => {\n\t\tonDelete();\n\t\tshowConfigModal = false;\n\t}}\n/>\n\n<div class=\"flex w-full gap-2 items-center\">\n\t<Tooltip\n\t\tclassName=\"w-full relative\"\n\t\tcontent={$i18n.t(`WebUI will make requests to \"{{url}}/chat/completions\"`, {\n\t\t\turl\n\t\t})}\n\t\tplacement=\"top-start\"\n\t>\n\t\t{#if !(config?.enable ?? true)}\n\t\t\t<div\n\t\t\t\tclass=\"absolute top-0 bottom-0 left-0 right-0 opacity-60 bg-white dark:bg-gray-900 z-10\"\n\t\t\t></div>\n\t\t{/if}\n\t\t<div class=\"flex w-full gap-2\">\n\t\t\t<div class=\"flex-1 relative\">\n\t\t\t\t<input\n\t\t\t\t\tclass={`w-full bg-transparent ${($settings?.highContrastMode ?? false) ? '' : 'outline-hidden'} ${pipeline ? 'pr-8' : ''}`}\n\t\t\t\t\tplaceholder={$i18n.t('API Base URL')}\n\t\t\t\t\tbind:value={url}\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t</Tooltip>\n\n\t<div class=\"flex gap-1\">\n\t\t<Tooltip content={$i18n.t('Configure')} className=\"self-start\">\n\t\t\t<button\n\t\t\t\taria-label={$i18n.t('Open modal to configure connection')}\n\t\t\t\tclass=\"self-center p-1 bg-transparent hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 rounded-lg transition\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowConfigModal = true;\n\t\t\t\t}}\n\t\t\t\ttype=\"button\"\n\t\t\t>\n\t\t\t\t<Cog6 />\n\t\t\t</button>\n\t\t</Tooltip>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { createEventDispatcher, onMount, getContext, tick } from 'svelte';\n\timport { getModels as _getModels } from '$lib/apis';\n\n\tconst dispatch = createEventDispatcher();\n\tconst i18n = getContext('i18n');\n\n\timport { models, settings, user } from '$lib/stores';\n\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport Connection from './Connections/Connection.svelte';\n\n\timport AddConnectionModal from '$lib/components/AddConnectionModal.svelte';\n\n\texport let saveSettings: Function;\n\n\tlet config = null;\n\n\tlet showConnectionModal = false;\n\n\tconst addConnectionHandler = async (connection) => {\n\t\tconfig.OPENAI_API_BASE_URLS.push(connection.url);\n\t\tconfig.OPENAI_API_KEYS.push(connection.key);\n\t\tconfig.OPENAI_API_CONFIGS[config.OPENAI_API_BASE_URLS.length - 1] = connection.config;\n\n\t\tawait updateHandler();\n\t};\n\n\tconst updateHandler = async () => {\n\t\t// Remove trailing slashes\n\t\tconfig.OPENAI_API_BASE_URLS = config.OPENAI_API_BASE_URLS.map((url) => url.replace(/\\/$/, ''));\n\n\t\t// Check if API KEYS length is same than API URLS length\n\t\tif (config.OPENAI_API_KEYS.length !== config.OPENAI_API_BASE_URLS.length) {\n\t\t\t// if there are more keys than urls, remove the extra keys\n\t\t\tif (config.OPENAI_API_KEYS.length > config.OPENAI_API_BASE_URLS.length) {\n\t\t\t\tconfig.OPENAI_API_KEYS = config.OPENAI_API_KEYS.slice(\n\t\t\t\t\t0,\n\t\t\t\t\tconfig.OPENAI_API_BASE_URLS.length\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// if there are more urls than keys, add empty keys\n\t\t\tif (config.OPENAI_API_KEYS.length < config.OPENAI_API_BASE_URLS.length) {\n\t\t\t\tconst diff = config.OPENAI_API_BASE_URLS.length - config.OPENAI_API_KEYS.length;\n\t\t\t\tfor (let i = 0; i < diff; i++) {\n\t\t\t\t\tconfig.OPENAI_API_KEYS.push('');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tawait saveSettings({\n\t\t\tdirectConnections: config\n\t\t});\n\t};\n\n\tonMount(async () => {\n\t\tconfig = $settings?.directConnections ?? {\n\t\t\tOPENAI_API_BASE_URLS: [],\n\t\t\tOPENAI_API_KEYS: [],\n\t\t\tOPENAI_API_CONFIGS: {}\n\t\t};\n\t});\n</script>\n\n<AddConnectionModal direct bind:show={showConnectionModal} onSubmit={addConnectionHandler} />\n\n<form\n\tid=\"tab-connections\"\n\tclass=\"flex flex-col h-full justify-between text-sm\"\n\ton:submit|preventDefault={() => {\n\t\tupdateHandler();\n\t}}\n>\n\t<div class=\" overflow-y-scroll scrollbar-hidden h-full\">\n\t\t{#if config !== null}\n\t\t\t<div class=\"\">\n\t\t\t\t<div class=\"pr-1.5\">\n\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t<div class=\"flex justify-between items-center mb-0.5\">\n\t\t\t\t\t\t\t<div class=\"font-medium\">{$i18n.t('Manage Direct Connections')}</div>\n\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t(`Add Connection`)}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"px-1\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tshowConnectionModal = true;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex flex-col gap-1.5\">\n\t\t\t\t\t\t\t{#each config?.OPENAI_API_BASE_URLS ?? [] as url, idx}\n\t\t\t\t\t\t\t\t<Connection\n\t\t\t\t\t\t\t\t\tbind:url\n\t\t\t\t\t\t\t\t\tbind:key={config.OPENAI_API_KEYS[idx]}\n\t\t\t\t\t\t\t\t\tbind:config={config.OPENAI_API_CONFIGS[idx]}\n\t\t\t\t\t\t\t\t\tonSubmit={() => {\n\t\t\t\t\t\t\t\t\t\tupdateHandler();\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tonDelete={() => {\n\t\t\t\t\t\t\t\t\t\tconfig.OPENAI_API_BASE_URLS = config.OPENAI_API_BASE_URLS.filter(\n\t\t\t\t\t\t\t\t\t\t\t(url, urlIdx) => idx !== urlIdx\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tconfig.OPENAI_API_KEYS = config.OPENAI_API_KEYS.filter(\n\t\t\t\t\t\t\t\t\t\t\t(key, keyIdx) => idx !== keyIdx\n\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\tlet newConfig = {};\n\t\t\t\t\t\t\t\t\t\tconfig.OPENAI_API_BASE_URLS.forEach((url, newIdx) => {\n\t\t\t\t\t\t\t\t\t\t\tnewConfig[newIdx] =\n\t\t\t\t\t\t\t\t\t\t\t\tconfig.OPENAI_API_CONFIGS[newIdx < idx ? newIdx : newIdx + 1];\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tconfig.OPENAI_API_CONFIGS = newConfig;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-1.5\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"text-xs {($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t? 'text-gray-800 dark:text-gray-100'\n\t\t\t\t\t\t\t\t: 'text-gray-500'}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{$i18n.t('Connect to your own OpenAI compatible API endpoints.')}\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t{$i18n.t(\n\t\t\t\t\t\t\t\t'CORS must be properly configured by the provider to allow requests from Open WebUI.'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex h-full justify-center\">\n\t\t\t\t<div class=\"my-auto\">\n\t\t\t\t\t<Spinner className=\"size-6\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\n\t\t<button\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\ttype=\"submit\"\n\t\t>\n\t\t\t{$i18n.t('Save')}\n\t\t</button>\n\t</div>\n</form>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { createEventDispatcher, onMount, getContext, tick } from 'svelte';\n\timport { getModels as _getModels, getToolServersData } from '$lib/apis';\n\n\tconst dispatch = createEventDispatcher();\n\tconst i18n = getContext('i18n');\n\n\timport { models, settings, toolServers, user } from '$lib/stores';\n\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport Connection from './Tools/Connection.svelte';\n\n\timport AddToolServerModal from '$lib/components/AddToolServerModal.svelte';\n\n\texport let saveSettings: Function;\n\n\tlet servers = null;\n\tlet showConnectionModal = false;\n\n\tconst addConnectionHandler = async (server) => {\n\t\tservers = [...servers, server];\n\t\tawait updateHandler();\n\t};\n\n\tconst updateHandler = async () => {\n\t\tawait saveSettings({\n\t\t\ttoolServers: servers\n\t\t});\n\n\t\tlet toolServersData = await getToolServersData($settings?.toolServers ?? []);\n\t\ttoolServersData = toolServersData.filter((data) => {\n\t\t\tif (data.error) {\n\t\t\t\ttoast.error(\n\t\t\t\t\t$i18n.t(`Failed to connect to {{URL}} OpenAPI tool server`, {\n\t\t\t\t\t\tURL: data?.url\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t\ttoolServers.set(toolServersData);\n\t};\n\n\tonMount(async () => {\n\t\tservers = $settings?.toolServers ?? [];\n\t});\n</script>\n\n<AddToolServerModal bind:show={showConnectionModal} onSubmit={addConnectionHandler} direct />\n\n<form\n\tid=\"tab-tools\"\n\tclass=\"flex flex-col h-full justify-between text-sm\"\n\ton:submit|preventDefault={() => {\n\t\tupdateHandler();\n\t}}\n>\n\t<div class=\" overflow-y-scroll scrollbar-hidden h-full\">\n\t\t{#if servers !== null}\n\t\t\t<div class=\"\">\n\t\t\t\t<div class=\"pr-1.5\">\n\t\t\t\t\t<!-- {$i18n.t(`Failed to connect to {{URL}} OpenAPI tool server`, {\n\t\t\t\t\t\tURL: 'server?.url'\n\t\t\t\t\t})} -->\n\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t<div class=\"flex justify-between items-center mb-0.5\">\n\t\t\t\t\t\t\t<div class=\"font-medium\">{$i18n.t('Manage Tool Servers')}</div>\n\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t(`Add Connection`)}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\taria-label={$i18n.t(`Add Connection`)}\n\t\t\t\t\t\t\t\t\tclass=\"px-1\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tshowConnectionModal = true;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex flex-col gap-1.5\">\n\t\t\t\t\t\t\t{#each servers as server, idx}\n\t\t\t\t\t\t\t\t<Connection\n\t\t\t\t\t\t\t\t\tbind:connection={server}\n\t\t\t\t\t\t\t\t\tdirect\n\t\t\t\t\t\t\t\t\tonSubmit={() => {\n\t\t\t\t\t\t\t\t\t\tupdateHandler();\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tonDelete={() => {\n\t\t\t\t\t\t\t\t\t\tservers = servers.filter((_, i) => i !== idx);\n\t\t\t\t\t\t\t\t\t\tupdateHandler();\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-1.5\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass={`text-xs \n\t\t\t\t\t\t\t\t${($settings?.highContrastMode ?? false) ? 'text-gray-800 dark:text-gray-100' : 'text-gray-500'}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{$i18n.t('Connect to your own OpenAPI compatible external tool servers.')}\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t{$i18n.t(\n\t\t\t\t\t\t\t\t'CORS must be properly configured by the provider to allow requests from Open WebUI.'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\" text-xs text-gray-600 dark:text-gray-300 mb-2\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclass=\"underline\"\n\t\t\t\t\t\t\thref=\"https://github.com/open-webui/openapi-servers\"\n\t\t\t\t\t\t\ttarget=\"_blank\">{$i18n.t('Learn more about OpenAPI tool servers.')}</a\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex h-full justify-center\">\n\t\t\t\t<div class=\"my-auto\">\n\t\t\t\t\t<Spinner className=\"size-6\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\n\t\t<button\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\ttype=\"submit\"\n\t\t>\n\t\t\t{$i18n.t('Save')}\n\t\t</button>\n\t</div>\n</form>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\t><path\n\t\td=\"M4 6V12C4 12 4 15 11 15C18 15 18 12 18 12V6\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M11 3C18 3 18 6 18 6C18 6 18 9 11 9C4 9 4 6 4 6C4 6 4 3 11 3Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path d=\"M11 21C4 21 4 18 4 18V12\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M19 21C20.1046 21 21 20.1046 21 19C21 17.8954 20.1046 17 19 17C18.6357 17 18.2942 17.0974 18 17.2676C17.4022 17.6134 17 18.2597 17 19C17 19.7403 17.4022 20.3866 18 20.7324C18.2942 20.9026 18.6357 21 19 21Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M19 22C20.6569 22 22 20.6569 22 19C22 17.3431 20.6569 16 19 16C17.3431 16 16 17.3431 16 19C16 20.6569 17.3431 22 19 22Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\tstroke-dasharray=\"0.3 2\"\n\t></path></svg\n>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\t><path\n\t\td=\"M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M19.6224 10.3954L18.5247 7.7448L20 6L18 4L16.2647 5.48295L13.5578 4.36974L12.9353 2H10.981L10.3491 4.40113L7.70441 5.51596L6 4L4 6L5.45337 7.78885L4.3725 10.4463L2 11V13L4.40111 13.6555L5.51575 16.2997L4 18L6 20L7.79116 18.5403L10.397 19.6123L11 22H13L13.6045 19.6132L16.2551 18.5155C16.6969 18.8313 18 20 18 20L20 18L18.5159 16.2494L19.6139 13.598L21.9999 12.9772L22 11L19.6224 10.3954Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path></svg\n>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\t><path\n\t\td=\"M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M4.271 18.3457C4.271 18.3457 6.50002 15.5 12 15.5C17.5 15.5 19.7291 18.3457 19.7291 18.3457\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M12 12C13.6569 12 15 10.6569 15 9C15 7.34315 13.6569 6 12 6C10.3431 6 9 7.34315 9 9C9 10.6569 10.3431 12 12 12Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path></svg\n>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\t><path\n\t\td=\"M1 13.8571V10.1429C1 9.03829 1.89543 8.14286 3 8.14286H5.9C6.09569 8.14286 6.28708 8.08544 6.45046 7.97772L12.4495 4.02228C13.1144 3.5839 14 4.06075 14 4.85714V19.1429C14 19.9392 13.1144 20.4161 12.4495 19.9777L6.45046 16.0223C6.28708 15.9146 6.09569 15.8571 5.9 15.8571H3C1.89543 15.8571 1 14.9617 1 13.8571Z\"\n\t></path><path\n\t\td=\"M17.5 7.5C17.5 7.5 19 9 19 11.5C19 14 17.5 15.5 17.5 15.5\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M20.5 4.5C20.5 4.5 23 7 23 11.5C23 16 20.5 18.5 20.5 18.5\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path></svg\n>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\t><path d=\"M12 11.5V16.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path\n\t\td=\"M12 7.51L12.01 7.49889\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path></svg\n>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n>\n\t<path\n\t\td=\"M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path>\n\t<path d=\"M16 8L16 10\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path>\n\n\t<path d=\"M8 8L8 10\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path>\n\n\t<path d=\"M9 16C9 16 10 17 12 17C14 17 15 16 15 16\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n\t></path>\n\n\t<path d=\"M12 8L12 13L11 13\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path>\n</svg>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\t><path\n\t\td=\"M19 8C20.6569 8 22 6.65685 22 5C22 3.34315 20.6569 2 19 2C17.3431 2 16 3.34315 16 5C16 6.65685 17.3431 8 19 8Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M21 12V15C21 18.3137 18.3137 21 15 21H9C5.68629 21 3 18.3137 3 15V9C3 5.68629 5.68629 3 9 3H12\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path></svg\n>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\t><path d=\"M2 20V19C2 15.134 5.13401 12 9 12V12\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M15.8038 12.3135C16.4456 11.6088 17.5544 11.6088 18.1962 12.3135V12.3135C18.5206 12.6697 18.9868 12.8628 19.468 12.8403V12.8403C20.4201 12.7958 21.2042 13.5799 21.1597 14.532V14.532C21.1372 15.0132 21.3303 15.4794 21.6865 15.8038V15.8038C22.3912 16.4456 22.3912 17.5544 21.6865 18.1962V18.1962C21.3303 18.5206 21.1372 18.9868 21.1597 19.468V19.468C21.2042 20.4201 20.4201 21.2042 19.468 21.1597V21.1597C18.9868 21.1372 18.5206 21.3303 18.1962 21.6865V21.6865C17.5544 22.3912 16.4456 22.3912 15.8038 21.6865V21.6865C15.4794 21.3303 15.0132 21.1372 14.532 21.1597V21.1597C13.5799 21.2042 12.7958 20.4201 12.8403 19.468V19.468C12.8628 18.9868 12.6697 18.5206 12.3135 18.1962V18.1962C11.6088 17.5544 11.6088 16.4456 12.3135 15.8038V15.8038C12.6697 15.4794 12.8628 15.0132 12.8403 14.532V14.532C12.7958 13.5799 13.5799 12.7958 14.532 12.8403V12.8403C15.0132 12.8628 15.4794 12.6697 15.8038 12.3135V12.3135Z\"\n\t></path><path\n\t\td=\"M15.3636 17L16.4546 18.0909L18.6364 15.9091\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M9 12C11.2091 12 13 10.2091 13 8C13 5.79086 11.2091 4 9 4C6.79086 4 5 5.79086 5 8C5 10.2091 6.79086 12 9 12Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path></svg\n>\n","<script lang=\"ts\">\n\timport { getContext, onMount, tick } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\timport { config, models, settings, user } from '$lib/stores';\n\timport { updateUserSettings } from '$lib/apis/users';\n\timport { getModels as _getModels } from '$lib/apis';\n\timport { goto } from '$app/navigation';\n\n\timport Modal from '../common/Modal.svelte';\n\timport Account from './Settings/Account.svelte';\n\timport About from './Settings/About.svelte';\n\timport General from './Settings/General.svelte';\n\timport Interface from './Settings/Interface.svelte';\n\timport Audio from './Settings/Audio.svelte';\n\timport DataControls from './Settings/DataControls.svelte';\n\timport Personalization from './Settings/Personalization.svelte';\n\timport Search from '../icons/Search.svelte';\n\timport XMark from '../icons/XMark.svelte';\n\timport Connections from './Settings/Connections.svelte';\n\timport Tools from './Settings/Tools.svelte';\n\timport DatabaseSettings from '../icons/DatabaseSettings.svelte';\n\timport SettingsAlt from '../icons/SettingsAlt.svelte';\n\timport Link from '../icons/Link.svelte';\n\timport UserCircle from '../icons/UserCircle.svelte';\n\timport SoundHigh from '../icons/SoundHigh.svelte';\n\timport InfoCircle from '../icons/InfoCircle.svelte';\n\timport WrenchAlt from '../icons/WrenchAlt.svelte';\n\timport Face from '../icons/Face.svelte';\n\timport AppNotification from '../icons/AppNotification.svelte';\n\timport UserBadgeCheck from '../icons/UserBadgeCheck.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\n\t$: if (show) {\n\t\taddScrollListener();\n\t} else {\n\t\tremoveScrollListener();\n\t}\n\n\tinterface SettingsTab {\n\t\tid: string;\n\t\ttitle: string;\n\t\tkeywords: string[];\n\t}\n\n\tconst allSettings: SettingsTab[] = [\n\t\t{\n\t\t\tid: 'general',\n\t\t\ttitle: 'General',\n\t\t\tkeywords: [\n\t\t\t\t'advancedparams',\n\t\t\t\t'advancedparameters',\n\t\t\t\t'advanced params',\n\t\t\t\t'advanced parameters',\n\t\t\t\t'configuration',\n\t\t\t\t'defaultparameters',\n\t\t\t\t'default parameters',\n\t\t\t\t'defaultsettings',\n\t\t\t\t'default settings',\n\t\t\t\t'general',\n\t\t\t\t'keepalive',\n\t\t\t\t'keep alive',\n\t\t\t\t'languages',\n\t\t\t\t'notifications',\n\t\t\t\t'requestmode',\n\t\t\t\t'request mode',\n\t\t\t\t'systemparameters',\n\t\t\t\t'system parameters',\n\t\t\t\t'systemprompt',\n\t\t\t\t'system prompt',\n\t\t\t\t'systemsettings',\n\t\t\t\t'system settings',\n\t\t\t\t'theme',\n\t\t\t\t'translate',\n\t\t\t\t'webuisettings',\n\t\t\t\t'webui settings'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'interface',\n\t\t\ttitle: 'Interface',\n\t\t\tkeywords: [\n\t\t\t\t'allow user location',\n\t\t\t\t'allow voice interruption in call',\n\t\t\t\t'allowuserlocation',\n\t\t\t\t'allowvoiceinterruptionincall',\n\t\t\t\t'always collapse codeblocks',\n\t\t\t\t'always collapse code blocks',\n\t\t\t\t'always expand details',\n\t\t\t\t'always on web search',\n\t\t\t\t'always play notification sound',\n\t\t\t\t'alwayscollapsecodeblocks',\n\t\t\t\t'alwaysexpanddetails',\n\t\t\t\t'alwaysonwebsearch',\n\t\t\t\t'alwaysplaynotificationsound',\n\t\t\t\t'android',\n\t\t\t\t'auto chat tags',\n\t\t\t\t'auto copy response to clipboard',\n\t\t\t\t'auto title',\n\t\t\t\t'autochattags',\n\t\t\t\t'autocopyresponsetoclipboard',\n\t\t\t\t'autotitle',\n\t\t\t\t'beta',\n\t\t\t\t'call',\n\t\t\t\t'chat background image',\n\t\t\t\t'chat bubble ui',\n\t\t\t\t'chat direction',\n\t\t\t\t'chat tags autogen',\n\t\t\t\t'chat tags autogeneration',\n\t\t\t\t'chat ui',\n\t\t\t\t'chatbackgroundimage',\n\t\t\t\t'chatbubbleui',\n\t\t\t\t'chatdirection',\n\t\t\t\t'chat tags autogeneration',\n\t\t\t\t'chattagsautogeneration',\n\t\t\t\t'chatui',\n\t\t\t\t'copy formatted text',\n\t\t\t\t'copyformattedtext',\n\t\t\t\t'default model',\n\t\t\t\t'defaultmodel',\n\t\t\t\t'design',\n\t\t\t\t'detect artifacts automatically',\n\t\t\t\t'detectartifactsautomatically',\n\t\t\t\t'display emoji in call',\n\t\t\t\t'display username',\n\t\t\t\t'displayemojiincall',\n\t\t\t\t'displayusername',\n\t\t\t\t'enter key behavior',\n\t\t\t\t'enterkeybehavior',\n\t\t\t\t'expand mode',\n\t\t\t\t'expandmode',\n\t\t\t\t'file',\n\t\t\t\t'followup autogeneration',\n\t\t\t\t'followupautogeneration',\n\t\t\t\t'fullscreen',\n\t\t\t\t'fullwidthmode',\n\t\t\t\t'full width mode',\n\t\t\t\t'haptic feedback',\n\t\t\t\t'hapticfeedback',\n\t\t\t\t'high contrast mode',\n\t\t\t\t'highcontrastmode',\n\t\t\t\t'iframe sandbox allow forms',\n\t\t\t\t'iframe sandbox allow same origin',\n\t\t\t\t'iframesandboxallowforms',\n\t\t\t\t'iframesandboxallowsameorigin',\n\t\t\t\t'imagecompression',\n\t\t\t\t'image compression',\n\t\t\t\t'imagemaxcompressionsize',\n\t\t\t\t'image max compression size',\n\t\t\t\t'interface customization',\n\t\t\t\t'interface options',\n\t\t\t\t'interfacecustomization',\n\t\t\t\t'interfaceoptions',\n\t\t\t\t'landing page mode',\n\t\t\t\t'landingpagemode',\n\t\t\t\t'layout',\n\t\t\t\t'left to right',\n\t\t\t\t'left-to-right',\n\t\t\t\t'lefttoright',\n\t\t\t\t'ltr',\n\t\t\t\t'paste large text as file',\n\t\t\t\t'pastelargetextasfile',\n\t\t\t\t'reset background',\n\t\t\t\t'resetbackground',\n\t\t\t\t'response auto copy',\n\t\t\t\t'responseautocopy',\n\t\t\t\t'rich text input for chat',\n\t\t\t\t'richtextinputforchat',\n\t\t\t\t'right to left',\n\t\t\t\t'right-to-left',\n\t\t\t\t'righttoleft',\n\t\t\t\t'rtl',\n\t\t\t\t'scroll behavior',\n\t\t\t\t'scroll on branch change',\n\t\t\t\t'scrollbehavior',\n\t\t\t\t'scrollonbranchchange',\n\t\t\t\t'select model',\n\t\t\t\t'selectmodel',\n\t\t\t\t'settings',\n\t\t\t\t'show username',\n\t\t\t\t'showusername',\n\t\t\t\t'stream large chunks',\n\t\t\t\t'streamlargechunks',\n\t\t\t\t'stylized pdf export',\n\t\t\t\t'stylizedpdfexport',\n\t\t\t\t'title autogeneration',\n\t\t\t\t'titleautogeneration',\n\t\t\t\t'toast notifications for new updates',\n\t\t\t\t'toastnotificationsfornewupdates',\n\t\t\t\t'upload background',\n\t\t\t\t'uploadbackground',\n\t\t\t\t'user interface',\n\t\t\t\t'user location access',\n\t\t\t\t'userinterface',\n\t\t\t\t'userlocationaccess',\n\t\t\t\t'vibration',\n\t\t\t\t'voice control',\n\t\t\t\t'voicecontrol',\n\t\t\t\t'widescreen mode',\n\t\t\t\t'widescreenmode',\n\t\t\t\t'whatsnew',\n\t\t\t\t'whats new',\n\t\t\t\t'websearchinchat',\n\t\t\t\t'web search in chat'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'connections',\n\t\t\ttitle: 'Connections',\n\t\t\tkeywords: [\n\t\t\t\t'addconnection',\n\t\t\t\t'add connection',\n\t\t\t\t'manageconnections',\n\t\t\t\t'manage connections',\n\t\t\t\t'manage direct connections',\n\t\t\t\t'managedirectconnections',\n\t\t\t\t'settings'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'tools',\n\t\t\ttitle: 'External Tools',\n\t\t\tkeywords: [\n\t\t\t\t'addconnection',\n\t\t\t\t'add connection',\n\t\t\t\t'managetools',\n\t\t\t\t'manage tools',\n\t\t\t\t'manage tool servers',\n\t\t\t\t'managetoolservers',\n\t\t\t\t'settings'\n\t\t\t]\n\t\t},\n\n\t\t{\n\t\t\tid: 'personalization',\n\t\t\ttitle: 'Personalization',\n\t\t\tkeywords: [\n\t\t\t\t'account preferences',\n\t\t\t\t'account settings',\n\t\t\t\t'accountpreferences',\n\t\t\t\t'accountsettings',\n\t\t\t\t'custom settings',\n\t\t\t\t'customsettings',\n\t\t\t\t'experimental',\n\t\t\t\t'memories',\n\t\t\t\t'memory',\n\t\t\t\t'personalization',\n\t\t\t\t'personalize',\n\t\t\t\t'personal settings',\n\t\t\t\t'personalsettings',\n\t\t\t\t'profile',\n\t\t\t\t'user preferences',\n\t\t\t\t'userpreferences'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'audio',\n\t\t\ttitle: 'Audio',\n\t\t\tkeywords: [\n\t\t\t\t'audio config',\n\t\t\t\t'audio control',\n\t\t\t\t'audio features',\n\t\t\t\t'audio input',\n\t\t\t\t'audio output',\n\t\t\t\t'audio playback',\n\t\t\t\t'audio voice',\n\t\t\t\t'audioconfig',\n\t\t\t\t'audiocontrol',\n\t\t\t\t'audiofeatures',\n\t\t\t\t'audioinput',\n\t\t\t\t'audiooutput',\n\t\t\t\t'audioplayback',\n\t\t\t\t'audiovoice',\n\t\t\t\t'auto playback response',\n\t\t\t\t'autoplaybackresponse',\n\t\t\t\t'auto transcribe',\n\t\t\t\t'autotranscribe',\n\t\t\t\t'instant auto send after voice transcription',\n\t\t\t\t'instantautosendaftervoicetranscription',\n\t\t\t\t'language',\n\t\t\t\t'non local voices',\n\t\t\t\t'nonlocalvoices',\n\t\t\t\t'save settings',\n\t\t\t\t'savesettings',\n\t\t\t\t'set voice',\n\t\t\t\t'setvoice',\n\t\t\t\t'sound settings',\n\t\t\t\t'soundsettings',\n\t\t\t\t'speech config',\n\t\t\t\t'speech mode',\n\t\t\t\t'speech playback speed',\n\t\t\t\t'speech rate',\n\t\t\t\t'speech recognition',\n\t\t\t\t'speech settings',\n\t\t\t\t'speech speed',\n\t\t\t\t'speech synthesis',\n\t\t\t\t'speech to text engine',\n\t\t\t\t'speechconfig',\n\t\t\t\t'speechmode',\n\t\t\t\t'speechplaybackspeed',\n\t\t\t\t'speechrate',\n\t\t\t\t'speechrecognition',\n\t\t\t\t'speechsettings',\n\t\t\t\t'speechspeed',\n\t\t\t\t'speechsynthesis',\n\t\t\t\t'speechtotextengine',\n\t\t\t\t'speedch playback rate',\n\t\t\t\t'speedchplaybackrate',\n\t\t\t\t'stt settings',\n\t\t\t\t'sttsettings',\n\t\t\t\t'text to speech engine',\n\t\t\t\t'text to speech',\n\t\t\t\t'textospeechengine',\n\t\t\t\t'texttospeech',\n\t\t\t\t'texttospeechvoice',\n\t\t\t\t'text to speech voice',\n\t\t\t\t'voice control',\n\t\t\t\t'voice modes',\n\t\t\t\t'voice options',\n\t\t\t\t'voice playback',\n\t\t\t\t'voice recognition',\n\t\t\t\t'voice speed',\n\t\t\t\t'voicecontrol',\n\t\t\t\t'voicemodes',\n\t\t\t\t'voiceoptions',\n\t\t\t\t'voiceplayback',\n\t\t\t\t'voicerecognition',\n\t\t\t\t'voicespeed',\n\t\t\t\t'volume'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'data_controls',\n\t\t\ttitle: 'Data Controls',\n\t\t\tkeywords: [\n\t\t\t\t'archive all chats',\n\t\t\t\t'archive chats',\n\t\t\t\t'archiveallchats',\n\t\t\t\t'archivechats',\n\t\t\t\t'archived chats',\n\t\t\t\t'archivedchats',\n\t\t\t\t'chat activity',\n\t\t\t\t'chat history',\n\t\t\t\t'chat settings',\n\t\t\t\t'chatactivity',\n\t\t\t\t'chathistory',\n\t\t\t\t'chatsettings',\n\t\t\t\t'conversation activity',\n\t\t\t\t'conversation history',\n\t\t\t\t'conversationactivity',\n\t\t\t\t'conversationhistory',\n\t\t\t\t'conversations',\n\t\t\t\t'convos',\n\t\t\t\t'delete all chats',\n\t\t\t\t'delete chats',\n\t\t\t\t'deleteallchats',\n\t\t\t\t'deletechats',\n\t\t\t\t'export chats',\n\t\t\t\t'exportchats',\n\t\t\t\t'import chats',\n\t\t\t\t'importchats',\n\t\t\t\t'message activity',\n\t\t\t\t'message archive',\n\t\t\t\t'message history',\n\t\t\t\t'messagearchive',\n\t\t\t\t'messagehistory'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'account',\n\t\t\ttitle: 'Account',\n\t\t\tkeywords: [\n\t\t\t\t'account preferences',\n\t\t\t\t'account settings',\n\t\t\t\t'accountpreferences',\n\t\t\t\t'accountsettings',\n\t\t\t\t'api keys',\n\t\t\t\t'apikeys',\n\t\t\t\t'change password',\n\t\t\t\t'changepassword',\n\t\t\t\t'jwt token',\n\t\t\t\t'jwttoken',\n\t\t\t\t'login',\n\t\t\t\t'new password',\n\t\t\t\t'newpassword',\n\t\t\t\t'notification webhook url',\n\t\t\t\t'notificationwebhookurl',\n\t\t\t\t'personal settings',\n\t\t\t\t'personalsettings',\n\t\t\t\t'privacy settings',\n\t\t\t\t'privacysettings',\n\t\t\t\t'profileavatar',\n\t\t\t\t'profile avatar',\n\t\t\t\t'profile details',\n\t\t\t\t'profile image',\n\t\t\t\t'profile picture',\n\t\t\t\t'profiledetails',\n\t\t\t\t'profileimage',\n\t\t\t\t'profilepicture',\n\t\t\t\t'security settings',\n\t\t\t\t'securitysettings',\n\t\t\t\t'update account',\n\t\t\t\t'update password',\n\t\t\t\t'updateaccount',\n\t\t\t\t'updatepassword',\n\t\t\t\t'user account',\n\t\t\t\t'user data',\n\t\t\t\t'user preferences',\n\t\t\t\t'user profile',\n\t\t\t\t'useraccount',\n\t\t\t\t'userdata',\n\t\t\t\t'username',\n\t\t\t\t'userpreferences',\n\t\t\t\t'userprofile',\n\t\t\t\t'webhook url',\n\t\t\t\t'webhookurl'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'about',\n\t\t\ttitle: 'About',\n\t\t\tkeywords: [\n\t\t\t\t'about app',\n\t\t\t\t'about me',\n\t\t\t\t'about open webui',\n\t\t\t\t'about page',\n\t\t\t\t'about us',\n\t\t\t\t'aboutapp',\n\t\t\t\t'aboutme',\n\t\t\t\t'aboutopenwebui',\n\t\t\t\t'aboutpage',\n\t\t\t\t'aboutus',\n\t\t\t\t'check for updates',\n\t\t\t\t'checkforupdates',\n\t\t\t\t'contact',\n\t\t\t\t'copyright',\n\t\t\t\t'details',\n\t\t\t\t'discord',\n\t\t\t\t'documentation',\n\t\t\t\t'github',\n\t\t\t\t'help',\n\t\t\t\t'information',\n\t\t\t\t'license',\n\t\t\t\t'redistributions',\n\t\t\t\t'release',\n\t\t\t\t'see whats new',\n\t\t\t\t'seewhatsnew',\n\t\t\t\t'settings',\n\t\t\t\t'software info',\n\t\t\t\t'softwareinfo',\n\t\t\t\t'support',\n\t\t\t\t'terms and conditions',\n\t\t\t\t'terms of use',\n\t\t\t\t'termsandconditions',\n\t\t\t\t'termsofuse',\n\t\t\t\t'timothy jae ryang baek',\n\t\t\t\t'timothy j baek',\n\t\t\t\t'timothyjaeryangbaek',\n\t\t\t\t'timothyjbaek',\n\t\t\t\t'twitter',\n\t\t\t\t'update info',\n\t\t\t\t'updateinfo',\n\t\t\t\t'version info',\n\t\t\t\t'versioninfo'\n\t\t\t]\n\t\t}\n\t];\n\n\tlet availableSettings = [];\n\tlet filteredSettings = [];\n\n\tlet search = '';\n\tlet searchDebounceTimeout;\n\n\tconst getAvailableSettings = () => {\n\t\treturn allSettings.filter((tab) => {\n\t\t\tif (tab.id === 'connections') {\n\t\t\t\treturn $config?.features?.enable_direct_connections;\n\t\t\t}\n\n\t\t\tif (tab.id === 'tools') {\n\t\t\t\treturn (\n\t\t\t\t\t$user?.role === 'admin' ||\n\t\t\t\t\t($user?.role === 'user' && $user?.permissions?.features?.direct_tool_servers)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (tab.id === 'interface') {\n\t\t\t\treturn $user?.role === 'admin' || ($user?.permissions?.settings?.interface ?? true);\n\t\t\t}\n\n\t\t\tif (tab.id === 'personalization') {\n\t\t\t\treturn (\n\t\t\t\t\t$config?.features?.enable_memories &&\n\t\t\t\t\t($user?.role === 'admin' || ($user?.permissions?.features?.memories ?? true))\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t};\n\n\tconst setFilteredSettings = () => {\n\t\tfilteredSettings = availableSettings\n\t\t\t.filter((tab) => {\n\t\t\t\treturn (\n\t\t\t\t\tsearch === '' ||\n\t\t\t\t\ttab.title.toLowerCase().includes(search.toLowerCase().trim()) ||\n\t\t\t\t\ttab.keywords.some((keyword) => keyword.includes(search.toLowerCase().trim()))\n\t\t\t\t);\n\t\t\t})\n\t\t\t.map((tab) => tab.id);\n\n\t\tif (filteredSettings.length > 0 && !filteredSettings.includes(selectedTab)) {\n\t\t\tselectedTab = filteredSettings[0];\n\t\t}\n\t};\n\n\tconst searchDebounceHandler = () => {\n\t\tif (searchDebounceTimeout) {\n\t\t\tclearTimeout(searchDebounceTimeout);\n\t\t}\n\n\t\tsearchDebounceTimeout = setTimeout(() => {\n\t\t\tsetFilteredSettings();\n\t\t}, 100);\n\t};\n\n\tconst saveSettings = async (updated) => {\n\t\tconsole.log(updated);\n\t\tawait settings.set({ ...$settings, ...updated });\n\t\tawait models.set(await getModels());\n\t\tawait updateUserSettings(localStorage.token, { ui: $settings });\n\t};\n\n\tconst getModels = async () => {\n\t\treturn await _getModels(\n\t\t\tlocalStorage.token,\n\t\t\t$config?.features?.enable_direct_connections && ($settings?.directConnections ?? null)\n\t\t);\n\t};\n\n\tlet selectedTab = 'general';\n\n\t// Function to handle sideways scrolling\n\tconst scrollHandler = (event) => {\n\t\tconst settingsTabsContainer = document.getElementById('settings-tabs-container');\n\t\tif (settingsTabsContainer) {\n\t\t\tevent.preventDefault(); // Prevent default vertical scrolling\n\t\t\tsettingsTabsContainer.scrollLeft += event.deltaY; // Scroll sideways\n\t\t}\n\t};\n\n\tconst addScrollListener = async () => {\n\t\tawait tick();\n\t\tconst settingsTabsContainer = document.getElementById('settings-tabs-container');\n\t\tif (settingsTabsContainer) {\n\t\t\tsettingsTabsContainer.addEventListener('wheel', scrollHandler);\n\t\t}\n\t};\n\n\tconst removeScrollListener = async () => {\n\t\tawait tick();\n\t\tconst settingsTabsContainer = document.getElementById('settings-tabs-container');\n\t\tif (settingsTabsContainer) {\n\t\t\tsettingsTabsContainer.removeEventListener('wheel', scrollHandler);\n\t\t}\n\t};\n\n\tonMount(() => {\n\t\tavailableSettings = getAvailableSettings();\n\t\tsetFilteredSettings();\n\n\t\tconfig.subscribe((configData) => {\n\t\t\tavailableSettings = getAvailableSettings();\n\t\t\tsetFilteredSettings();\n\t\t});\n\t});\n</script>\n\n<Modal size=\"2xl\" bind:show>\n\t<div class=\"text-gray-700 dark:text-gray-100 mx-1\">\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-4 md:px-4.5 pt-4.5 pb-0.5 md:pb-2.5\">\n\t\t\t<div class=\" text-lg font-medium self-center\">{$i18n.t('Settings')}</div>\n\t\t\t<button\n\t\t\t\taria-label={$i18n.t('Close settings modal')}\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className=\"w-5 h-5\"></XMark>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full pt-1 pb-4\">\n\t\t\t<div\n\t\t\t\trole=\"tablist\"\n\t\t\t\tid=\"settings-tabs-container\"\n\t\t\t\tclass=\"tabs flex flex-row overflow-x-auto gap-2.5 mx-3 md:pr-4 md:gap-1 md:flex-col flex-1 md:flex-none md:w-50 md:min-h-[42rem] md:max-h-[42rem] dark:text-gray-200 text-sm text-left mb-1 md:mb-0 -translate-y-1\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"hidden md:flex w-full rounded-full px-2.5 gap-2 bg-gray-100/80 dark:bg-gray-850/80 backdrop-blur-2xl my-1 mb-1.5\"\n\t\t\t\t\tid=\"settings-search\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"self-center rounded-l-xl bg-transparent\">\n\t\t\t\t\t\t<Search\n\t\t\t\t\t\t\tclassName=\"size-3.5\"\n\t\t\t\t\t\t\tstrokeWidth={($settings?.highContrastMode ?? false) ? '3' : '1.5'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<label class=\"sr-only\" for=\"search-input-settings-modal\">{$i18n.t('Search')}</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass={`w-full py-1 text-sm bg-transparent dark:text-gray-300 outline-hidden\n\t\t\t\t\t\t\t\t${($settings?.highContrastMode ?? false) ? 'placeholder-gray-800' : ''}`}\n\t\t\t\t\t\tbind:value={search}\n\t\t\t\t\t\tid=\"search-input-settings-modal\"\n\t\t\t\t\t\ton:input={searchDebounceHandler}\n\t\t\t\t\t\tplaceholder={$i18n.t('Search')}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t{#if filteredSettings.length > 0}\n\t\t\t\t\t{#each filteredSettings as tabId (tabId)}\n\t\t\t\t\t\t{#if tabId === 'general'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\taria-controls=\"tab-general\"\n\t\t\t\t\t\t\t\taria-selected={selectedTab === 'general'}\n\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'general'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'general';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<SettingsAlt strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('General')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'interface'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\taria-controls=\"tab-interface\"\n\t\t\t\t\t\t\t\taria-selected={selectedTab === 'interface'}\n\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'interface'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'interface';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<AppNotification strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Interface')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'connections'}\n\t\t\t\t\t\t\t{#if $user?.role === 'admin' || ($user?.role === 'user' && $config?.features?.enable_direct_connections)}\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\t\taria-controls=\"tab-connections\"\n\t\t\t\t\t\t\t\t\taria-selected={selectedTab === 'connections'}\n\t\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'connections'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tselectedTab = 'connections';\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t\t<Link strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Connections')}</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{:else if tabId === 'tools'}\n\t\t\t\t\t\t\t{#if $user?.role === 'admin' || ($user?.role === 'user' && $user?.permissions?.features?.direct_tool_servers)}\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\t\taria-controls=\"tab-tools\"\n\t\t\t\t\t\t\t\t\taria-selected={selectedTab === 'tools'}\n\t\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'tools'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tselectedTab = 'tools';\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t\t<WrenchAlt strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('External Tools')}</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{:else if tabId === 'personalization'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\taria-controls=\"tab-personalization\"\n\t\t\t\t\t\t\t\taria-selected={selectedTab === 'personalization'}\n\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'personalization'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'personalization';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<Face strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Personalization')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'audio'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\taria-controls=\"tab-audio\"\n\t\t\t\t\t\t\t\taria-selected={selectedTab === 'audio'}\n\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'audio'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'audio';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<SoundHigh strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Audio')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'data_controls'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\taria-controls=\"tab-data-controls\"\n\t\t\t\t\t\t\t\taria-selected={selectedTab === 'data_controls'}\n\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'data_controls'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'data_controls';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<DatabaseSettings strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Data Controls')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'account'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\taria-controls=\"tab-account\"\n\t\t\t\t\t\t\t\taria-selected={selectedTab === 'account'}\n\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'account'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'account';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<UserCircle strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Account')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'about'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t\taria-controls=\"tab-about\"\n\t\t\t\t\t\t\t\taria-selected={selectedTab === 'about'}\n\t\t\t\t\t\t\t\tclass={`px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'about'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'about';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<InfoCircle strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('About')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{/each}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"text-center text-gray-500 mt-4\">\n\t\t\t\t\t\t{$i18n.t('No results found')}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t{#if $user?.role === 'admin'}\n\t\t\t\t\t<a\n\t\t\t\t\t\thref=\"/admin/settings\"\n\t\t\t\t\t\tclass=\"px-0.5 md:px-2.5 py-1 min-w-fit rounded-xl flex-1 md:flex-none md:mt-auto flex text-left transition {$settings?.highContrastMode\n\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'}\"\n\t\t\t\t\t\ton:click={async (e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tawait goto('/admin/settings');\n\t\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t<UserBadgeCheck strokeWidth=\"2\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Admin Settings')}</div>\n\t\t\t\t\t</a>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div class=\"flex-1 px-3.5 md:pl-0 md:pr-4.5 md:min-h-[42rem] max-h-[42rem]\">\n\t\t\t\t{#if selectedTab === 'general'}\n\t\t\t\t\t<General\n\t\t\t\t\t\t{getModels}\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\ton:save={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'interface'}\n\t\t\t\t\t<Interface\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\ton:save={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'connections'}\n\t\t\t\t\t<Connections\n\t\t\t\t\t\tsaveSettings={async (updated) => {\n\t\t\t\t\t\t\tawait saveSettings(updated);\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'tools'}\n\t\t\t\t\t<Tools\n\t\t\t\t\t\tsaveSettings={async (updated) => {\n\t\t\t\t\t\t\tawait saveSettings(updated);\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'personalization'}\n\t\t\t\t\t<Personalization\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\ton:save={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'audio'}\n\t\t\t\t\t<Audio\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\ton:save={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'data_controls'}\n\t\t\t\t\t<DataControls {saveSettings} />\n\t\t\t\t{:else if selectedTab === 'account'}\n\t\t\t\t\t<Account\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\tsaveHandler={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'about'}\n\t\t\t\t\t<About />\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\tinput::-webkit-outer-spin-button,\n\tinput::-webkit-inner-spin-button {\n\t\t/* display: none; <- Crashes Chrome on hover */\n\t\t-webkit-appearance: none;\n\t\tmargin: 0; /* <-- Apparently some margin are still there even though it's hidden */\n\t}\n\n\t.tabs::-webkit-scrollbar {\n\t\tdisplay: none; /* for Chrome, Safari and Opera */\n\t}\n\n\t.tabs {\n\t\t-ms-overflow-style: none; /* IE and Edge */\n\t\tscrollbar-width: none; /* Firefox */\n\t}\n\n\tinput[type='number'] {\n\t\tappearance: textfield;\n\t\t-moz-appearance: textfield; /* Firefox */\n\t}\n</style>\n","<script lang=\"ts\">\n\timport DOMPurify from 'dompurify';\n\n\timport { onMount, getContext } from 'svelte';\n\timport { Confetti } from 'svelte-confetti';\n\n\timport { WEBUI_NAME, config, settings } from '$lib/stores';\n\n\timport { WEBUI_VERSION } from '$lib/constants';\n\timport { getChangelog } from '$lib/apis';\n\n\timport Modal from './common/Modal.svelte';\n\timport { updateUserSettings } from '$lib/apis/users';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\n\tlet changelog = null;\n\n\tconst init = async () => {\n\t\tchangelog = await getChangelog();\n\t};\n\n\tconst closeModal = async () => {\n\t\tlocalStorage.version = $config.version;\n\t\tawait settings.set({ ...$settings, ...{ version: $config.version } });\n\t\tawait updateUserSettings(localStorage.token, { ui: $settings });\n\t\tshow = false;\n\t};\n\n\t$: if (show) {\n\t\tinit();\n\t}\n</script>\n\n<Modal bind:show size=\"xl\">\n\t<div class=\"px-6 pt-5 dark:text-white text-black\">\n\t\t<div class=\"flex justify-between items-start\">\n\t\t\t<div class=\"text-xl font-medium\">\n\t\t\t\t{$i18n.t(\"What's New in\")}\n\t\t\t\t{$WEBUI_NAME}\n\t\t\t\t<Confetti x={[-1, -0.25]} y={[0, 0.5]} />\n\t\t\t</div>\n\t\t\t<button class=\"self-center\" on:click={closeModal} aria-label={$i18n.t('Close')}>\n\t\t\t\t<XMark className={'size-5'}>\n\t\t\t\t\t<p class=\"sr-only\">{$i18n.t('Close')}</p>\n\t\t\t\t</XMark>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class=\"flex items-center mt-1\">\n\t\t\t<div class=\"text-sm dark:text-gray-200\">{$i18n.t('Release Notes')}</div>\n\t\t\t<div class=\"flex self-center w-[1px] h-6 mx-2.5 bg-gray-50/50 dark:bg-gray-850/50\" />\n\t\t\t<div class=\"text-sm dark:text-gray-200\">\n\t\t\t\tv{WEBUI_VERSION}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class=\" w-full p-4 px-5 text-gray-700 dark:text-gray-100\">\n\t\t<div class=\" overflow-y-scroll max-h-[30rem] scrollbar-hidden\">\n\t\t\t<div class=\"mb-3\">\n\t\t\t\t{#if changelog}\n\t\t\t\t\t{#each Object.keys(changelog) as version}\n\t\t\t\t\t\t<div class=\" mb-3 pr-2\">\n\t\t\t\t\t\t\t<div class=\"font-semibold text-xl mb-1 dark:text-white\">\n\t\t\t\t\t\t\t\tv{version} - {changelog[version].date}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<hr class=\"border-gray-50/50 dark:border-gray-850/50 my-2\" />\n\n\t\t\t\t\t\t\t{#each Object.keys(changelog[version]).filter((section) => section !== 'date') as section}\n\t\t\t\t\t\t\t\t<div class=\"w-full\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"font-semibold uppercase text-xs {section === 'added'\n\t\t\t\t\t\t\t\t\t\t\t? 'bg-blue-500/20 text-blue-700 dark:text-blue-200'\n\t\t\t\t\t\t\t\t\t\t\t: section === 'fixed'\n\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-green-500/20 text-green-700 dark:text-green-200'\n\t\t\t\t\t\t\t\t\t\t\t\t: section === 'changed'\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-yellow-500/20 text-yellow-700 dark:text-yellow-200'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: section === 'removed'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-red-500/20 text-red-700 dark:text-red-200'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}  w-fit rounded-xl px-2 my-2.5\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{section}\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\"my-2.5 px-1.5 markdown-prose-sm !list-none !w-full !max-w-none\">\n\t\t\t\t\t\t\t\t\t\t{#each changelog[version][section] as entry}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t{@html DOMPurify.sanitize(entry?.raw)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/each}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\n\t\t\t<button\n\t\t\t\ton:click={closeModal}\n\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\t>\n\t\t\t\t<span class=\"relative\">{$i18n.t(\"Okay, Let's Go!\")}</span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</Modal>\n","<script lang=\"ts\">\n\timport DOMPurify from 'dompurify';\n\timport { marked } from 'marked';\n\n\timport { getAdminDetails } from '$lib/apis/auths';\n\timport { onMount, tick, getContext } from 'svelte';\n\timport { config } from '$lib/stores';\n\n\tconst i18n = getContext('i18n');\n\n\tlet adminDetails = null;\n\n\tonMount(async () => {\n\t\tadminDetails = await getAdminDetails(localStorage.token).catch((err) => {\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\t});\n</script>\n\n<div class=\"fixed w-full h-full flex z-999\">\n\t<div\n\t\tclass=\"absolute w-full h-full backdrop-blur-lg bg-white/10 dark:bg-gray-900/50 flex justify-center\"\n\t>\n\t\t<div class=\"m-auto pb-10 flex flex-col justify-center\">\n\t\t\t<div class=\"max-w-md\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"text-center dark:text-white text-2xl font-medium z-50\"\n\t\t\t\t\tstyle=\"white-space: pre-wrap;\"\n\t\t\t\t>\n\t\t\t\t\t{#if ($config?.ui?.pending_user_overlay_title ?? '').trim() !== ''}\n\t\t\t\t\t\t{$config.ui.pending_user_overlay_title}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{$i18n.t('Account Activation Pending')}<br />\n\t\t\t\t\t\t{$i18n.t('Contact Admin for WebUI Access')}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tclass=\" mt-4 text-center text-sm dark:text-gray-200 w-full\"\n\t\t\t\t\tstyle=\"white-space: pre-wrap;\"\n\t\t\t\t>\n\t\t\t\t\t{#if ($config?.ui?.pending_user_overlay_content ?? '').trim() !== ''}\n\t\t\t\t\t\t{@html marked.parse(\n\t\t\t\t\t\t\tDOMPurify.sanitize(\n\t\t\t\t\t\t\t\t($config?.ui?.pending_user_overlay_content ?? '').replace(/\\n/g, '<br>')\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{$i18n.t('Your account status is currently pending activation.')}{'\\n'}{$i18n.t(\n\t\t\t\t\t\t\t'To access the WebUI, please reach out to the administrator. Admins can manage user statuses from the Admin Panel.'\n\t\t\t\t\t\t)}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t{#if adminDetails}\n\t\t\t\t\t<div class=\"mt-4 text-sm font-medium text-center\">\n\t\t\t\t\t\t<div>{$i18n.t('Admin')}: {adminDetails.name} ({adminDetails.email})</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<div class=\" mt-6 mx-auto relative group w-fit\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"relative z-20 flex px-5 py-2 rounded-full bg-white border border-gray-100 dark:border-none hover:bg-gray-100 text-gray-700 transition font-medium text-sm\"\n\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\tlocation.href = '/';\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{$i18n.t('Check Again')}\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"text-xs text-center w-full mt-2 text-gray-400 underline\"\n\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\tlocalStorage.removeItem('token');\n\t\t\t\t\t\t\tlocation.href = '/auth';\n\t\t\t\t\t\t}}>{$i18n.t('Sign Out')}</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { getContext, createEventDispatcher } from 'svelte';\n\n\tconst dispatch = createEventDispatcher();\n\tconst i18n = getContext('i18n');\n\n\timport { WEBUI_VERSION } from '$lib/constants';\n\timport XMark from '../icons/XMark.svelte';\n\n\texport let version = {\n\t\tcurrent: WEBUI_VERSION,\n\t\tlatest: WEBUI_VERSION\n\t};\n</script>\n\n<div\n\tclass=\"flex items-start bg-[#F1F8FE] dark:bg-[#020C1D] border border-[3371D5] dark:border-[#03113B] text-[#2B6CD4] dark:text-[#6795EC] rounded-lg px-3.5 py-3 text-xs max-w-80 pr-2 w-full shadow-lg\"\n>\n\t<div class=\"flex-1 font-medium\">\n\t\t{$i18n.t(`A new version (v{{LATEST_VERSION}}) is now available.`, {\n\t\t\tLATEST_VERSION: version.latest\n\t\t})}\n\n\t\t<a href=\"https://github.com/open-webui/open-webui/releases\" target=\"_blank\" class=\"underline\">\n\t\t\t{$i18n.t('Update for the latest features and improvements.')}</a\n\t\t>\n\t</div>\n\n\t<div class=\" shrink-0 pr-1\">\n\t\t<button\n\t\t\tclass=\" hover:text-blue-900 dark:hover:text-blue-300 transition\"\n\t\t\ton:click={() => {\n\t\t\t\tdispatch('close');\n\t\t\t}}\n\t\t>\n\t\t\t<XMark />\n\t\t</button>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { onMount, tick, getContext } from 'svelte';\n\timport { openDB, deleteDB } from 'idb';\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/stores';\n\timport { fade } from 'svelte/transition';\n\n\timport { getModels, getToolServersData, getVersionUpdates } from '$lib/apis';\n\timport { getTools } from '$lib/apis/tools';\n\timport { getBanners } from '$lib/apis/configs';\n\timport { getUserSettings } from '$lib/apis/users';\n\n\timport { WEBUI_VERSION } from '$lib/constants';\n\timport { compareVersion } from '$lib/utils';\n\n\timport {\n\t\tconfig,\n\t\tuser,\n\t\tsettings,\n\t\tmodels,\n\t\tprompts,\n\t\tknowledge,\n\t\ttools,\n\t\tfunctions,\n\t\ttags,\n\t\tbanners,\n\t\tshowSettings,\n\t\tshowShortcuts,\n\t\tshowChangelog,\n\t\ttemporaryChatEnabled,\n\t\ttoolServers,\n\t\tshowSearch,\n\t\tshowSidebar\n\t} from '$lib/stores';\n\n\timport Sidebar from '$lib/components/layout/Sidebar.svelte';\n\timport SettingsModal from '$lib/components/chat/SettingsModal.svelte';\n\timport ChangelogModal from '$lib/components/ChangelogModal.svelte';\n\timport AccountPending from '$lib/components/layout/Overlay/AccountPending.svelte';\n\timport UpdateInfoToast from '$lib/components/layout/UpdateInfoToast.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport { Shortcut, shortcuts } from '$lib/shortcuts';\n\n\tconst i18n = getContext('i18n');\n\n\tlet loaded = false;\n\tlet DB = null;\n\tlet localDBChats = [];\n\n\tlet version;\n\n\tconst clearChatInputStorage = () => {\n\t\tconst chatInputKeys = Object.keys(localStorage).filter((key) => key.startsWith('chat-input'));\n\t\tif (chatInputKeys.length > 0) {\n\t\t\tchatInputKeys.forEach((key) => {\n\t\t\t\tlocalStorage.removeItem(key);\n\t\t\t});\n\t\t}\n\t};\n\n\tconst checkLocalDBChats = async () => {\n\t\ttry {\n\t\t\t// Check if IndexedDB exists\n\t\t\tDB = await openDB('Chats', 1);\n\n\t\t\tif (!DB) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst chats = await DB.getAllFromIndex('chats', 'timestamp');\n\t\t\tlocalDBChats = chats.map((item, idx) => chats[chats.length - 1 - idx]);\n\n\t\t\tif (localDBChats.length === 0) {\n\t\t\t\tawait deleteDB('Chats');\n\t\t\t}\n\t\t} catch (error) {\n\t\t\t// IndexedDB Not Found\n\t\t}\n\t};\n\n\tconst setUserSettings = async (cb: () => Promise<void>) => {\n\t\tlet userSettings = await getUserSettings(localStorage.token).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (!userSettings) {\n\t\t\ttry {\n\t\t\t\tuserSettings = JSON.parse(localStorage.getItem('settings') ?? '{}');\n\t\t\t} catch (e: unknown) {\n\t\t\t\tconsole.error('Failed to parse settings from localStorage', e);\n\t\t\t\tuserSettings = {};\n\t\t\t}\n\t\t}\n\n\t\tif (userSettings?.ui) {\n\t\t\tsettings.set(userSettings.ui);\n\t\t}\n\n\t\tif (cb) {\n\t\t\tawait cb();\n\t\t}\n\t};\n\n\tconst setModels = async () => {\n\t\tmodels.set(\n\t\t\tawait getModels(\n\t\t\t\tlocalStorage.token,\n\t\t\t\t$config?.features?.enable_direct_connections ? ($settings?.directConnections ?? null) : null\n\t\t\t)\n\t\t);\n\t};\n\n\tconst setToolServers = async () => {\n\t\tlet toolServersData = await getToolServersData($settings?.toolServers ?? []);\n\t\ttoolServersData = toolServersData.filter((data) => {\n\t\t\tif (!data || data.error) {\n\t\t\t\ttoast.error(\n\t\t\t\t\t$i18n.t(`Failed to connect to {{URL}} OpenAPI tool server`, {\n\t\t\t\t\t\tURL: data?.url\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\ttoolServers.set(toolServersData);\n\t};\n\n\tconst setBanners = async () => {\n\t\tconst bannersData = await getBanners(localStorage.token);\n\t\tbanners.set(bannersData);\n\t};\n\n\tconst setTools = async () => {\n\t\tconst toolsData = await getTools(localStorage.token);\n\t\ttools.set(toolsData);\n\t};\n\n\tonMount(async () => {\n\t\tif ($user === undefined || $user === null) {\n\t\t\tawait goto('/auth');\n\t\t\treturn;\n\t\t}\n\t\tif (!['user', 'admin'].includes($user?.role)) {\n\t\t\treturn;\n\t\t}\n\n\t\tclearChatInputStorage();\n\t\tawait Promise.all([\n\t\t\tcheckLocalDBChats(),\n\t\t\tsetBanners(),\n\t\t\tsetTools(),\n\t\t\tsetUserSettings(async () => {\n\t\t\t\tawait Promise.all([setModels(), setToolServers()]);\n\t\t\t})\n\t\t]);\n\n\t\t// Helper function to check if the pressed keys match the shortcut definition\n\t\tconst isShortcutMatch = (event: KeyboardEvent, shortcut): boolean => {\n\t\t\tconst keys = shortcut?.keys || [];\n\n\t\t\tconst normalized = keys.map((k) => k.toLowerCase());\n\t\t\tconst needCtrl = normalized.includes('ctrl') || normalized.includes('mod');\n\t\t\tconst needShift = normalized.includes('shift');\n\t\t\tconst needAlt = normalized.includes('alt');\n\n\t\t\tconst mainKeys = normalized.filter((k) => !['ctrl', 'shift', 'alt', 'mod'].includes(k));\n\n\t\t\t// Get the main key pressed\n\t\t\tconst keyPressed = event.key.toLowerCase();\n\n\t\t\t// Check modifiers\n\t\t\tif (needShift && !event.shiftKey) return false;\n\n\t\t\tif (needCtrl && !(event.ctrlKey || event.metaKey)) return false;\n\t\t\tif (!needCtrl && (event.ctrlKey || event.metaKey)) return false;\n\t\t\tif (needAlt && !event.altKey) return false;\n\t\t\tif (!needAlt && event.altKey) return false;\n\n\t\t\tif (mainKeys.length && !mainKeys.includes(keyPressed)) return false;\n\n\t\t\treturn true;\n\t\t};\n\n\t\tconst setupKeyboardShortcuts = () => {\n\t\t\tdocument.addEventListener('keydown', async (event) => {\n\t\t\t\tif (isShortcutMatch(event, shortcuts[Shortcut.SEARCH])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: SEARCH');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tshowSearch.set(!$showSearch);\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.NEW_CHAT])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: NEW_CHAT');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tdocument.getElementById('sidebar-new-chat-button')?.click();\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.FOCUS_INPUT])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: FOCUS_INPUT');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tdocument.getElementById('chat-input')?.focus();\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.COPY_LAST_CODE_BLOCK])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: COPY_LAST_CODE_BLOCK');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t[...document.getElementsByClassName('copy-code-button')]?.at(-1)?.click();\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.COPY_LAST_RESPONSE])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: COPY_LAST_RESPONSE');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t[...document.getElementsByClassName('copy-response-button')]?.at(-1)?.click();\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.TOGGLE_SIDEBAR])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: TOGGLE_SIDEBAR');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.DELETE_CHAT])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: DELETE_CHAT');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tdocument.getElementById('delete-chat-button')?.click();\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.OPEN_SETTINGS])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: OPEN_SETTINGS');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tshowSettings.set(!$showSettings);\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.SHOW_SHORTCUTS])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: SHOW_SHORTCUTS');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tshowShortcuts.set(!$showShortcuts);\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.CLOSE_MODAL])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: CLOSE_MODAL');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tshowSettings.set(false);\n\t\t\t\t\tshowShortcuts.set(false);\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.NEW_TEMPORARY_CHAT])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: NEW_TEMPORARY_CHAT');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tif ($user?.role !== 'admin' && $user?.permissions?.chat?.temporary_enforced) {\n\t\t\t\t\t\ttemporaryChatEnabled.set(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttemporaryChatEnabled.set(!$temporaryChatEnabled);\n\t\t\t\t\t}\n\t\t\t\t\tawait goto('/');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tdocument.getElementById('new-chat-button')?.click();\n\t\t\t\t\t}, 0);\n\t\t\t\t} else if (isShortcutMatch(event, shortcuts[Shortcut.GENERATE_MESSAGE_PAIR])) {\n\t\t\t\t\tconsole.log('Shortcut triggered: GENERATE_MESSAGE_PAIR');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tdocument.getElementById('generate-message-pair-button')?.click();\n\t\t\t\t} else if (\n\t\t\t\t\tisShortcutMatch(event, shortcuts[Shortcut.REGENERATE_RESPONSE]) &&\n\t\t\t\t\tdocument.activeElement?.id === 'chat-input'\n\t\t\t\t) {\n\t\t\t\t\tconsole.log('Shortcut triggered: REGENERATE_RESPONSE');\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t[...document.getElementsByClassName('regenerate-response-button')]?.at(-1)?.click();\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tsetupKeyboardShortcuts();\n\n\t\tif ($user?.role === 'admin' && ($settings?.showChangelog ?? true)) {\n\t\t\tshowChangelog.set($settings?.version !== $config.version);\n\t\t}\n\n\t\tif ($user?.role === 'admin' || ($user?.permissions?.chat?.temporary ?? true)) {\n\t\t\tif ($page.url.searchParams.get('temporary-chat') === 'true') {\n\t\t\t\ttemporaryChatEnabled.set(true);\n\t\t\t}\n\n\t\t\tif ($user?.role !== 'admin' && $user?.permissions?.chat?.temporary_enforced) {\n\t\t\t\ttemporaryChatEnabled.set(true);\n\t\t\t}\n\t\t}\n\n\t\t// Check for version updates\n\t\tif ($user?.role === 'admin' && $config?.features?.enable_version_update_check) {\n\t\t\t// Check if the user has dismissed the update toast in the last 24 hours\n\t\t\tif (localStorage.dismissedUpdateToast) {\n\t\t\t\tconst dismissedUpdateToast = new Date(Number(localStorage.dismissedUpdateToast));\n\t\t\t\tconst now = new Date();\n\n\t\t\t\tif (now - dismissedUpdateToast > 24 * 60 * 60 * 1000) {\n\t\t\t\t\tcheckForVersionUpdates();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcheckForVersionUpdates();\n\t\t\t}\n\t\t}\n\t\tawait tick();\n\n\t\tloaded = true;\n\t});\n\n\tconst checkForVersionUpdates = async () => {\n\t\tversion = await getVersionUpdates(localStorage.token).catch((error) => {\n\t\t\treturn {\n\t\t\t\tcurrent: WEBUI_VERSION,\n\t\t\t\tlatest: WEBUI_VERSION\n\t\t\t};\n\t\t});\n\t};\n</script>\n\n<SettingsModal bind:show={$showSettings} />\n<ChangelogModal bind:show={$showChangelog} />\n\n{#if version && compareVersion(version.latest, version.current) && ($settings?.showUpdateToast ?? true)}\n\t<div class=\" absolute bottom-8 right-8 z-50\" in:fade={{ duration: 100 }}>\n\t\t<UpdateInfoToast\n\t\t\t{version}\n\t\t\ton:close={() => {\n\t\t\t\tlocalStorage.setItem('dismissedUpdateToast', Date.now().toString());\n\t\t\t\tversion = null;\n\t\t\t}}\n\t\t/>\n\t</div>\n{/if}\n\n{#if $user}\n\t<div class=\"app relative\">\n\t\t<div\n\t\t\tclass=\" text-gray-700 dark:text-gray-100 bg-white dark:bg-gray-900 h-screen max-h-[100dvh] overflow-auto flex flex-row justify-end\"\n\t\t>\n\t\t\t{#if !['user', 'admin'].includes($user?.role)}\n\t\t\t\t<AccountPending />\n\t\t\t{:else}\n\t\t\t\t{#if localDBChats.length > 0}\n\t\t\t\t\t<div class=\"fixed w-full h-full flex z-50\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"absolute w-full h-full backdrop-blur-md bg-white/20 dark:bg-gray-900/50 flex justify-center\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"m-auto pb-44 flex flex-col justify-center\">\n\t\t\t\t\t\t\t\t<div class=\"max-w-md\">\n\t\t\t\t\t\t\t\t\t<div class=\"text-center dark:text-white text-2xl font-medium z-50\">\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('Important Update')}<br />\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('Action Required for Chat Log Storage')}\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\" mt-4 text-center text-sm dark:text-gray-200 w-full\">\n\t\t\t\t\t\t\t\t\t\t{$i18n.t(\n\t\t\t\t\t\t\t\t\t\t\t\"Saving chat logs directly to your browser's storage is no longer supported. Please take a moment to download and delete your chat logs by clicking the button below. Don't worry, you can easily re-import your chat logs to the backend through\"\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t<span class=\"font-medium dark:text-white\"\n\t\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Settings')} > {$i18n.t('Chats')} > {$i18n.t('Import Chats')}</span\n\t\t\t\t\t\t\t\t\t\t>. {$i18n.t(\n\t\t\t\t\t\t\t\t\t\t\t'This ensures that your valuable conversations are securely saved to your backend database. Thank you!'\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\" mt-6 mx-auto relative group w-fit\">\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\"relative z-20 flex px-5 py-2 rounded-full bg-white border border-gray-100 dark:border-none hover:bg-gray-100 transition font-medium text-sm\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\tlet blob = new Blob([JSON.stringify(localDBChats)], {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\tsaveAs(blob, `chat-export-${Date.now()}.json`);\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst tx = DB.transaction('chats', 'readwrite');\n\t\t\t\t\t\t\t\t\t\t\t\tawait Promise.all([tx.store.clear(), tx.done]);\n\t\t\t\t\t\t\t\t\t\t\t\tawait deleteDB('Chats');\n\n\t\t\t\t\t\t\t\t\t\t\t\tlocalDBChats = [];\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Download & Delete')}\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\"text-xs text-center w-full mt-2 text-gray-400 underline\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\tlocalDBChats = [];\n\t\t\t\t\t\t\t\t\t\t\t}}>{$i18n.t('Close')}</button\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<Sidebar />\n\n\t\t\t\t{#if loaded}\n\t\t\t\t\t<slot />\n\t\t\t\t{:else}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"w-full flex-1 h-full flex items-center justify-center {$showSidebar\n\t\t\t\t\t\t\t? '  md:max-w-[calc(100%-var(--sidebar-width))]'\n\t\t\t\t\t\t\t: ' '}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Spinner className=\"size-5\" />\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n{/if}\n\n<style>\n\t.loading {\n\t\tdisplay: inline-block;\n\t\tclip-path: inset(0 1ch 0 0);\n\t\tanimation: l 1s steps(3) infinite;\n\t\tletter-spacing: -0.5px;\n\t}\n\n\t@keyframes l {\n\t\tto {\n\t\t\tclip-path: inset(0 -1ch 0 0);\n\t\t}\n\t}\n\n\tpre[class*='language-'] {\n\t\tposition: relative;\n\t\toverflow: auto;\n\n\t\t/* make space  */\n\t\tmargin: 5px 0;\n\t\tpadding: 1.75rem 0 1.75rem 1rem;\n\t\tborder-radius: 10px;\n\t}\n\n\tpre[class*='language-'] button {\n\t\tposition: absolute;\n\t\ttop: 5px;\n\t\tright: 5px;\n\n\t\tfont-size: 0.9rem;\n\t\tpadding: 0.15rem;\n\t\tbackground-color: #828282;\n\n\t\tborder: ridge 1px #7b7b7c;\n\t\tborder-radius: 5px;\n\t\ttext-shadow: #c4c4c4 0 0 2px;\n\t}\n\n\tpre[class*='language-'] button:hover {\n\t\tcursor: pointer;\n\t\tbackground-color: #bcbabb;\n\t}\n</style>\n"],"file":"_app/immutable/nodes/2.DP8rt-Z8.js"}