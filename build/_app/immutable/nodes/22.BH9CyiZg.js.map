{"version":3,"file":"22.BH9CyiZg.js","sources":["../../../../../../src/lib/components/icons/ArrowUpLeftAlt.svelte","../../../../../../src/lib/components/channel/Messages/Message.svelte","../../../../../../src/lib/components/channel/Messages.svelte","../../../../../../src/lib/components/icons/UserAlt.svelte","../../../../../../src/lib/components/channel/ChannelInfoModal/UserList.svelte","../../../../../../src/lib/components/channel/ChannelInfoModal/AddMembersModal.svelte","../../../../../../src/lib/components/channel/ChannelInfoModal.svelte","../../../../../../src/lib/components/channel/PinnedMessagesModal.svelte","../../../../../../src/lib/components/channel/Navbar.svelte","../../../../../../src/lib/components/channel/Thread.svelte","../../../../../../src/lib/components/channel/Channel.svelte","../../../../../../src/routes/(app)/channels/[id]/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tstroke-width={strokeWidth}\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\t><path d=\"M10.25 4.75L6.75 8.25L10.25 11.75\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M6.75 8.25L12.75 8.25C14.9591 8.25 16.75 10.0409 16.75 12.25V19.25\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path></svg\n>\n","<script lang=\"ts\">\n\timport dayjs from 'dayjs';\n\timport relativeTime from 'dayjs/plugin/relativeTime';\n\timport isToday from 'dayjs/plugin/isToday';\n\timport isYesterday from 'dayjs/plugin/isYesterday';\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\n\n\tdayjs.extend(relativeTime);\n\tdayjs.extend(isToday);\n\tdayjs.extend(isYesterday);\n\tdayjs.extend(localizedFormat);\n\n\timport { getContext, onMount } from 'svelte';\n\tconst i18n = getContext<Writable<i18nType>>('i18n');\n\n\timport { formatDate } from '$lib/utils';\n\n\timport { settings, user, shortCodesToEmojis } from '$lib/stores';\n\timport { WEBUI_API_BASE_URL, WEBUI_BASE_URL } from '$lib/constants';\n\timport { getMessageData } from '$lib/apis/channels';\n\n\timport Markdown from '$lib/components/chat/Messages/Markdown.svelte';\n\timport ProfileImage from '$lib/components/chat/Messages/ProfileImage.svelte';\n\timport Name from '$lib/components/chat/Messages/Name.svelte';\n\timport ConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport Pencil from '$lib/components/icons/Pencil.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\timport Image from '$lib/components/common/Image.svelte';\n\timport FileItem from '$lib/components/common/FileItem.svelte';\n\timport ProfilePreview from './Message/ProfilePreview.svelte';\n\timport ChatBubbleOvalEllipsis from '$lib/components/icons/ChatBubble.svelte';\n\timport FaceSmile from '$lib/components/icons/FaceSmile.svelte';\n\timport EmojiPicker from '$lib/components/common/EmojiPicker.svelte';\n\timport ChevronRight from '$lib/components/icons/ChevronRight.svelte';\n\timport Emoji from '$lib/components/common/Emoji.svelte';\n\timport Skeleton from '$lib/components/chat/Messages/Skeleton.svelte';\n\timport ArrowUpLeftAlt from '$lib/components/icons/ArrowUpLeftAlt.svelte';\n\timport PinSlash from '$lib/components/icons/PinSlash.svelte';\n\timport Pin from '$lib/components/icons/Pin.svelte';\n\n\texport let className = '';\n\n\texport let message;\n\texport let channel;\n\n\texport let showUserProfile = true;\n\texport let thread = false;\n\n\texport let replyToMessage = false;\n\texport let disabled = false;\n\texport let pending = false;\n\n\texport let onDelete: Function = () => {};\n\texport let onEdit: Function = () => {};\n\texport let onReply: Function = () => {};\n\texport let onPin: Function = () => {};\n\texport let onThread: Function = () => {};\n\texport let onReaction: Function = () => {};\n\n\tlet showButtons = false;\n\n\tlet edit = false;\n\tlet editedContent = null;\n\tlet showDeleteConfirmDialog = false;\n\n\tconst loadMessageData = async () => {\n\t\tif (message && message?.data) {\n\t\t\tconst res = await getMessageData(localStorage.token, channel?.id, message.id);\n\t\t\tif (res) {\n\t\t\t\tmessage.data = res;\n\t\t\t}\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\tif (message && message?.data) {\n\t\t\tawait loadMessageData();\n\t\t}\n\t});\n</script>\n\n<ConfirmDialog\n\tbind:show={showDeleteConfirmDialog}\n\ttitle={$i18n.t('Delete Message')}\n\tmessage={$i18n.t('Are you sure you want to delete this message?')}\n\tonConfirm={async () => {\n\t\tawait onDelete();\n\t}}\n/>\n\n{#if message}\n\t<div\n\t\tid=\"message-{message.id}\"\n\t\tclass=\"flex flex-col justify-between w-full max-w-full mx-auto group hover:bg-gray-300/5 dark:hover:bg-gray-700/5 transition relative {className\n\t\t\t? className\n\t\t\t: `px-5 ${\n\t\t\t\t\treplyToMessage ? 'border-l-4 border-blue-500 bg-blue-100/10 dark:bg-blue-100/5 pl-4' : ''\n\t\t\t\t} ${\n\t\t\t\t\t(message?.reply_to_message?.meta?.model_id ?? message?.reply_to_message?.user_id) ===\n\t\t\t\t\t$user?.id\n\t\t\t\t\t\t? 'border-l-4 border-orange-500 bg-orange-100/10 dark:bg-orange-100/5 pl-4'\n\t\t\t\t\t\t: ''\n\t\t\t\t} ${message?.is_pinned ? 'bg-yellow-100/20 dark:bg-yellow-100/5' : ''}`} {showUserProfile\n\t\t\t? 'pt-1.5 pb-0.5'\n\t\t\t: ''}\"\n\t>\n\t\t{#if !edit && !disabled}\n\t\t\t<div\n\t\t\t\tclass=\" absolute {showButtons ? '' : 'invisible group-hover:visible'} right-1 -top-2 z-10\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"flex gap-1 rounded-lg bg-white dark:bg-gray-850 shadow-md p-0.5 border border-gray-100/30 dark:border-gray-850/30\"\n\t\t\t\t>\n\t\t\t\t\t{#if onReaction}\n\t\t\t\t\t\t<EmojiPicker\n\t\t\t\t\t\t\tonClose={() => (showButtons = false)}\n\t\t\t\t\t\t\tonSubmit={(name) => {\n\t\t\t\t\t\t\t\tshowButtons = false;\n\t\t\t\t\t\t\t\tonReaction(name);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Add Reaction')}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tshowButtons = true;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FaceSmile />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</EmojiPicker>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if onReply}\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Reply')}>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-0.5\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tonReply(message);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<ArrowUpLeftAlt className=\"size-5\" />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<Tooltip content={message?.is_pinned ? $i18n.t('Unpin') : $i18n.t('Pin')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tonPin(message);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if message?.is_pinned}\n\t\t\t\t\t\t\t\t<PinSlash className=\"size-4\" />\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<Pin className=\"size-4\" />\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t{#if !thread && onThread}\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Reply in Thread')}>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tonThread(message.id);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<ChatBubbleOvalEllipsis />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if message.user_id === $user?.id || $user?.role === 'admin'}\n\t\t\t\t\t\t{#if onEdit}\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Edit')}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tedit = true;\n\t\t\t\t\t\t\t\t\t\teditedContent = message.content;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Pencil />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t{#if onDelete}\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Delete')}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\n\t\t\t\t\t\t\t\t\ton:click={() => (showDeleteConfirmDialog = true)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<GarbageBin />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t{#if message?.is_pinned}\n\t\t\t<div class=\"flex {showUserProfile ? 'mb-0.5' : 'mt-0.5'}\">\n\t\t\t\t<div class=\"ml-8.5 flex items-center gap-1 px-1 rounded-full text-xs\">\n\t\t\t\t\t<Pin className=\"size-3 text-yellow-500 dark:text-yellow-300\" />\n\t\t\t\t\t<span class=\"text-gray-500\">{$i18n.t('Pinned')}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t{#if message?.reply_to_message?.user}\n\t\t\t<div class=\"relative text-xs mb-1\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"absolute h-3 w-7 left-[18px] top-2 rounded-tl-lg border-t-[1.5px] border-l-[1.5px] border-gray-200 dark:border-gray-700 z-0\"\n\t\t\t\t></div>\n\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ml-12 flex items-center space-x-2 relative z-0\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tconst messageElement = document.getElementById(\n\t\t\t\t\t\t\t`message-${message.reply_to_message.id}`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (messageElement) {\n\t\t\t\t\t\t\tmessageElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n\t\t\t\t\t\t\tmessageElement.classList.add('highlight');\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tmessageElement.classList.remove('highlight');\n\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{#if message?.reply_to_message?.meta?.model_id}\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/models/model/profile/image?id=${message.reply_to_message.meta.model_id}`}\n\t\t\t\t\t\t\talt={message.reply_to_message.meta.model_name ??\n\t\t\t\t\t\t\t\tmessage.reply_to_message.meta.model_id}\n\t\t\t\t\t\t\tclass=\"size-4 ml-0.5 rounded-full object-cover\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={message.reply_to_message.user?.role === 'webhook'\n\t\t\t\t\t\t\t\t? `${WEBUI_API_BASE_URL}/channels/webhooks/${message.reply_to_message.user?.id}/profile/image`\n\t\t\t\t\t\t\t\t: `${WEBUI_API_BASE_URL}/users/${message.reply_to_message.user?.id}/profile/image`}\n\t\t\t\t\t\t\talt={message.reply_to_message.user?.name ?? $i18n.t('Unknown User')}\n\t\t\t\t\t\t\tclass=\"size-4 ml-0.5 rounded-full object-cover\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div class=\"shrink-0\">\n\t\t\t\t\t\t{message?.reply_to_message.meta?.model_name ??\n\t\t\t\t\t\t\tmessage?.reply_to_message.user?.name ??\n\t\t\t\t\t\t\t$i18n.t('Unknown User')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"italic text-sm text-gray-500 dark:text-gray-400 line-clamp-1 w-full flex-1\">\n\t\t\t\t\t\t<Markdown id={`${message.id}-reply-to`} content={message?.reply_to_message?.content} />\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div\n\t\t\tclass=\" flex w-full message-{message.id} \"\n\t\t\tid=\"message-{message.id}\"\n\t\t\tdir={$settings.chatDirection}\n\t\t>\n\t\t\t<div class={`shrink-0 mr-1 w-9`}>\n\t\t\t\t{#if showUserProfile}\n\t\t\t\t\t{#if message?.meta?.model_id}\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/models/model/profile/image?id=${message.meta.model_id}`}\n\t\t\t\t\t\t\talt={message.meta.model_name ?? message.meta.model_id}\n\t\t\t\t\t\t\tclass=\"size-8 translate-y-1 ml-0.5 object-cover rounded-full\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<ProfilePreview user={message.user}>\n\t\t\t\t\t\t\t<ProfileImage\n\t\t\t\t\t\t\t\tsrc={message.user?.role === 'webhook'\n\t\t\t\t\t\t\t\t\t? `${WEBUI_API_BASE_URL}/channels/webhooks/${message.user?.id}/profile/image`\n\t\t\t\t\t\t\t\t\t: `${WEBUI_API_BASE_URL}/users/${message.user?.id}/profile/image`}\n\t\t\t\t\t\t\t\tclassName={'size-8 ml-0.5'}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ProfilePreview>\n\t\t\t\t\t{/if}\n\t\t\t\t{:else}\n\t\t\t\t\t<!-- <div class=\"w-7 h-7 rounded-full bg-transparent\" /> -->\n\n\t\t\t\t\t{#if message.created_at}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"mt-1.5 flex shrink-0 items-center text-xs self-center invisible group-hover:visible text-gray-500 font-medium first-letter:capitalize\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Tooltip content={dayjs(message.created_at / 1000000).format('LLLL')}>\n\t\t\t\t\t\t\t\t{dayjs(message.created_at / 1000000).format('HH:mm')}\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<div class=\"flex-auto w-0 pl-2\">\n\t\t\t\t{#if showUserProfile}\n\t\t\t\t\t<Name>\n\t\t\t\t\t\t<div class=\" self-end text-base shrink-0 font-medium truncate\">\n\t\t\t\t\t\t\t{#if message?.meta?.model_id}\n\t\t\t\t\t\t\t\t{message?.meta?.model_name ?? message?.meta?.model_id}\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t{message?.user?.name}\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if message.created_at}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" self-center text-xs text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Tooltip content={dayjs(message.created_at / 1000000).format('LLLL')}>\n\t\t\t\t\t\t\t\t\t<span class=\"line-clamp-1\">\n\t\t\t\t\t\t\t\t\t\t{#if dayjs(message.created_at / 1000000).isToday()}\n\t\t\t\t\t\t\t\t\t\t\t{dayjs(message.created_at / 1000000).format('LT')}\n\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t(formatDate(message.created_at / 1000000), {\n\t\t\t\t\t\t\t\t\t\t\t\tLOCALIZED_TIME: dayjs(message.created_at / 1000000).format('LT'),\n\t\t\t\t\t\t\t\t\t\t\t\tLOCALIZED_DATE: dayjs(message.created_at / 1000000).format('L')\n\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</Name>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if message?.data === true}\n\t\t\t\t\t<!-- loading indicator -->\n\t\t\t\t\t<div class=\" my-2\">\n\t\t\t\t\t\t<Skeleton />\n\t\t\t\t\t</div>\n\t\t\t\t{:else if (message?.data?.files ?? []).length > 0}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap\"\n\t\t\t\t\t\tdir={$settings?.chatDirection ?? 'auto'}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#each message?.data?.files as file}\n\t\t\t\t\t\t\t{@const fileUrl =\n\t\t\t\t\t\t\t\tfile.url.startsWith('data') || file.url.startsWith('http')\n\t\t\t\t\t\t\t\t\t? file.url\n\t\t\t\t\t\t\t\t\t: `${WEBUI_API_BASE_URL}/files/${file.url}${file?.content_type ? '/content' : ''}`}\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{#if file.type === 'image' || (file?.content_type ?? '').startsWith('image/')}\n\t\t\t\t\t\t\t\t\t<Image src={fileUrl} alt={file.name} imageClassName=\" max-h-96 rounded-lg\" />\n\t\t\t\t\t\t\t\t{:else if file.type === 'video' || (file?.content_type ?? '').startsWith('video/')}\n\t\t\t\t\t\t\t\t\t<video src={fileUrl} controls class=\" max-h-96 rounded-lg\"></video>\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<FileItem\n\t\t\t\t\t\t\t\t\t\titem={file}\n\t\t\t\t\t\t\t\t\t\turl={file.url}\n\t\t\t\t\t\t\t\t\t\tname={file.name}\n\t\t\t\t\t\t\t\t\t\ttype={file.type}\n\t\t\t\t\t\t\t\t\t\tsize={file?.size}\n\t\t\t\t\t\t\t\t\t\tsmall={true}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if edit}\n\t\t\t\t\t<div class=\"py-2\">\n\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\tclassName=\" bg-transparent outline-hidden w-full resize-none\"\n\t\t\t\t\t\t\tbind:value={editedContent}\n\t\t\t\t\t\t\tonKeydown={(e) => {\n\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\t\t\t\t\tdocument.getElementById('close-edit-message-button')?.click();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tconst isCmdOrCtrlPressed = e.metaKey || e.ctrlKey;\n\t\t\t\t\t\t\t\tconst isEnterPressed = e.key === 'Enter';\n\n\t\t\t\t\t\t\t\tif (isCmdOrCtrlPressed && isEnterPressed) {\n\t\t\t\t\t\t\t\t\tdocument.getElementById('confirm-edit-message-button')?.click();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\" mt-2 mb-1 flex justify-end text-sm font-medium\">\n\t\t\t\t\t\t\t<div class=\"flex space-x-1.5\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tid=\"close-edit-message-button\"\n\t\t\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tedit = false;\n\t\t\t\t\t\t\t\t\t\teditedContent = null;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{$i18n.t('Cancel')}\n\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tid=\"confirm-edit-message-button\"\n\t\t\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl\"\n\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\tonEdit(editedContent);\n\t\t\t\t\t\t\t\t\t\tedit = false;\n\t\t\t\t\t\t\t\t\t\teditedContent = null;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{$i18n.t('Save')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\" min-w-full markdown-prose {pending ? 'opacity-50' : ''}\">\n\t\t\t\t\t\t{#if (message?.content ?? '').trim() === '' && message?.meta?.model_id}\n\t\t\t\t\t\t\t<Skeleton />\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<Markdown\n\t\t\t\t\t\t\t\tid={message.id}\n\t\t\t\t\t\t\t\tcontent={message.content}\n\t\t\t\t\t\t\t\tparagraphTag=\"span\"\n\t\t\t\t\t\t\t/>{#if message.created_at !== message.updated_at && (message?.meta?.model_id ?? null) === null}<span\n\t\t\t\t\t\t\t\t\tclass=\"text-gray-500 text-[10px] pl-1 self-center\">({$i18n.t('edited')})</span\n\t\t\t\t\t\t\t\t>{/if}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if (message?.reactions ?? []).length > 0}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\"flex items-center flex-wrap gap-y-1.5 gap-1 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t{#each message.reactions as reaction}\n\t\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\t\tcontent={$i18n.t('{{NAMES}} reacted with {{REACTION}}', {\n\t\t\t\t\t\t\t\t\t\t\tNAMES: reaction.users\n\t\t\t\t\t\t\t\t\t\t\t\t.reduce((acc, u, idx) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst name = u.id === $user?.id ? $i18n.t('You') : u.name;\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst total = reaction.users.length;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t// First three names always added normally\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (idx < 3) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst separator =\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tidx === 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: idx === Math.min(2, total - 1)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? ` ${$i18n.t('and')} `\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ', ';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn `${acc}${separator}${name}`;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t// More than 4 â†’ \"and X others\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (idx === 3 && total > 4) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tacc +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t` ${$i18n.t('and {{COUNT}} others', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOUNT: total - 3\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn acc;\n\t\t\t\t\t\t\t\t\t\t\t\t}, '')\n\t\t\t\t\t\t\t\t\t\t\t\t.trim(),\n\t\t\t\t\t\t\t\t\t\t\tREACTION: `:${reaction.name}:`\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\"flex items-center gap-1.5 transition rounded-xl px-2 py-1 cursor-pointer {reaction.users\n\t\t\t\t\t\t\t\t\t\t\t\t.map((u) => u.id)\n\t\t\t\t\t\t\t\t\t\t\t\t.includes($user?.id)\n\t\t\t\t\t\t\t\t\t\t\t\t? ' bg-blue-300/10 outline outline-blue-500/50 outline-1'\n\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-gray-300/10 dark:bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1'}\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (onReaction) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonReaction(reaction.name);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Emoji shortCode={reaction.name} />\n\n\t\t\t\t\t\t\t\t\t\t\t{#if reaction.users.length > 0}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-xs font-medium text-gray-500 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{reaction.users?.length}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t{/each}\n\n\t\t\t\t\t\t\t\t{#if onReaction}\n\t\t\t\t\t\t\t\t\t<EmojiPicker\n\t\t\t\t\t\t\t\t\t\tonSubmit={(name) => {\n\t\t\t\t\t\t\t\t\t\t\tonReaction(name);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Add Reaction')}>\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"flex items-center gap-1.5 bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1 transition rounded-xl px-1 py-1 cursor-pointer text-gray-500 dark:text-gray-400\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<FaceSmile />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t</EmojiPicker>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if !thread && message.reply_count > 0}\n\t\t\t\t\t\t<div class=\"flex items-center gap-1.5 -mt-0.5 mb-1.5\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"flex items-center text-xs py-1 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tonThread(message.id);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"font-medium mr-1\">\n\t\t\t\t\t\t\t\t\t{$i18n.t('{{COUNT}} Replies', { COUNT: message.reply_count })}</span\n\t\t\t\t\t\t\t\t><span>\n\t\t\t\t\t\t\t\t\t{' - '}{$i18n.t('Last reply')}\n\t\t\t\t\t\t\t\t\t{dayjs.unix(message.latest_reply_at / 1000000000).fromNow()}</span\n\t\t\t\t\t\t\t\t>\n\n\t\t\t\t\t\t\t\t<span class=\"ml-1\">\n\t\t\t\t\t\t\t\t\t<ChevronRight className=\"size-2.5\" strokeWidth=\"3\" />\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<!-- {$i18n.t('View Replies')} -->\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n\n<style>\n\t.highlight {\n\t\tanimation: highlightAnimation 2s ease-in-out;\n\t}\n\n\t@keyframes highlightAnimation {\n\t\t0% {\n\t\t\tbackground-color: rgba(0, 60, 255, 0.1);\n\t\t}\n\t\t100% {\n\t\t\tbackground-color: transparent;\n\t\t}\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\n\timport dayjs from 'dayjs';\n\timport relativeTime from 'dayjs/plugin/relativeTime';\n\timport isToday from 'dayjs/plugin/isToday';\n\timport isYesterday from 'dayjs/plugin/isYesterday';\n\n\tdayjs.extend(relativeTime);\n\tdayjs.extend(isToday);\n\tdayjs.extend(isYesterday);\n\timport { tick, getContext, onMount, createEventDispatcher } from 'svelte';\n\n\timport { settings, user } from '$lib/stores';\n\n\timport Message from './Messages/Message.svelte';\n\timport Loader from '../common/Loader.svelte';\n\timport Spinner from '../common/Spinner.svelte';\n\timport {\n\t\taddReaction,\n\t\tdeleteMessage,\n\t\tpinMessage,\n\t\tremoveReaction,\n\t\tupdateMessage\n\t} from '$lib/apis/channels';\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\n\n\tconst i18n = getContext('i18n');\n\n\texport let id = null;\n\texport let channel = null;\n\texport let messages = [];\n\texport let replyToMessage = null;\n\texport let top = false;\n\texport let thread = false;\n\n\texport let onLoad: Function = () => {};\n\texport let onReply: Function = () => {};\n\texport let onThread: Function = () => {};\n\n\tlet messagesLoading = false;\n\n\tconst loadMoreMessages = async () => {\n\t\t// scroll slightly down to disable continuous loading\n\t\tconst element = document.getElementById('messages-container');\n\t\telement.scrollTop = element.scrollTop + 100;\n\n\t\tmessagesLoading = true;\n\n\t\tawait onLoad();\n\n\t\tawait tick();\n\t\tmessagesLoading = false;\n\t};\n</script>\n\n{#if messages}\n\t{@const messageList = messages.slice().reverse()}\n\t<div>\n\t\t{#if !top}\n\t\t\t<Loader\n\t\t\t\ton:visible={(e) => {\n\t\t\t\t\tconsole.info('visible');\n\t\t\t\t\tif (!messagesLoading) {\n\t\t\t\t\t\tloadMoreMessages();\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div class=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\">\n\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t<div class=\" \">{$i18n.t('Loading...')}</div>\n\t\t\t\t</div>\n\t\t\t</Loader>\n\t\t{:else if !thread}\n\t\t\t<div class=\"px-5 max-w-full mx-auto\">\n\t\t\t\t{#if channel}\n\t\t\t\t\t<div class=\"flex flex-col gap-1.5 pb-5 pt-10\">\n\t\t\t\t\t\t{#if channel?.type === 'dm'}\n\t\t\t\t\t\t\t<div class=\"flex ml-[1px] mr-0.5\">\n\t\t\t\t\t\t\t\t{#each channel.users.filter((u) => u.id !== $user?.id).slice(0, 2) as u, index}\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${u.id}/profile/image`}\n\t\t\t\t\t\t\t\t\t\talt={u.name}\n\t\t\t\t\t\t\t\t\t\tclass=\" size-7.5 rounded-full border-2 border-white dark:border-gray-900 {index ===\n\t\t\t\t\t\t\t\t\t\t1\n\t\t\t\t\t\t\t\t\t\t\t? '-ml-2.5'\n\t\t\t\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<div class=\"text-2xl font-medium capitalize\">\n\t\t\t\t\t\t\t{#if channel?.name}\n\t\t\t\t\t\t\t\t{channel.name}\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t{channel?.users\n\t\t\t\t\t\t\t\t\t?.filter((u) => u.id !== $user?.id)\n\t\t\t\t\t\t\t\t\t.map((u) => u.name)\n\t\t\t\t\t\t\t\t\t.join(', ')}\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\" text-gray-500\">\n\t\t\t\t\t\t\t{$i18n.t(\n\t\t\t\t\t\t\t\t'This channel was created on {{createdAt}}. This is the very beginning of the {{channelName}} channel.',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcreatedAt: dayjs(channel.created_at / 1000000).format('MMMM D, YYYY'),\n\t\t\t\t\t\t\t\t\tchannelName: channel.name\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"flex justify-center text-xs items-center gap-2 py-5\">\n\t\t\t\t\t\t<div class=\" \">{$i18n.t('Start of the channel')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if messageList.length > 0}\n\t\t\t\t\t<hr class=\" border-gray-50 dark:border-gray-700/20 py-2.5 w-full\" />\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\n\t\t{#each messageList as message, messageIdx (id ? `${id}-${message.id}` : message.id)}\n\t\t\t<Message\n\t\t\t\t{message}\n\t\t\t\t{channel}\n\t\t\t\t{thread}\n\t\t\t\treplyToMessage={replyToMessage?.id === message.id}\n\t\t\t\tdisabled={!channel?.write_access || message?.temp_id}\n\t\t\t\tpending={!!message?.temp_id}\n\t\t\t\tshowUserProfile={messageIdx === 0 ||\n\t\t\t\t\tmessageList.at(messageIdx - 1)?.user_id !== message.user_id ||\n\t\t\t\t\tmessageList.at(messageIdx - 1)?.user?.id !== message.user?.id ||\n\t\t\t\t\tmessageList.at(messageIdx - 1)?.meta?.model_id !== message?.meta?.model_id ||\n\t\t\t\t\tmessage?.reply_to_message !== null}\n\t\t\t\tonDelete={() => {\n\t\t\t\t\tmessages = messages.filter((m) => m.id !== message.id);\n\n\t\t\t\t\tconst res = deleteMessage(localStorage.token, message.channel_id, message.id).catch(\n\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t\tonEdit={(content) => {\n\t\t\t\t\tmessages = messages.map((m) => {\n\t\t\t\t\t\tif (m.id === message.id) {\n\t\t\t\t\t\t\tm.content = content;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn m;\n\t\t\t\t\t});\n\n\t\t\t\t\tconst res = updateMessage(localStorage.token, message.channel_id, message.id, {\n\t\t\t\t\t\tcontent: content\n\t\t\t\t\t}).catch((error) => {\n\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t\tonReply={(message) => {\n\t\t\t\t\tonReply(message);\n\t\t\t\t}}\n\t\t\t\tonPin={async (message) => {\n\t\t\t\t\tmessages = messages.map((m) => {\n\t\t\t\t\t\tif (m.id === message.id) {\n\t\t\t\t\t\t\tm.is_pinned = !m.is_pinned;\n\t\t\t\t\t\t\tm.pinned_by = !m.is_pinned ? null : $user?.id;\n\t\t\t\t\t\t\tm.pinned_at = !m.is_pinned ? null : Date.now() * 1000000;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn m;\n\t\t\t\t\t});\n\n\t\t\t\t\tconst updatedMessage = await pinMessage(\n\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\tmessage.channel_id,\n\t\t\t\t\t\tmessage.id,\n\t\t\t\t\t\tmessage.is_pinned\n\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t\tonThread={(id) => {\n\t\t\t\t\tonThread(id);\n\t\t\t\t}}\n\t\t\t\tonReaction={(name) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(message?.reactions ?? [])\n\t\t\t\t\t\t\t.find((reaction) => reaction.name === name)\n\t\t\t\t\t\t\t?.users?.some((u) => u.id === $user?.id) ??\n\t\t\t\t\t\tfalse\n\t\t\t\t\t) {\n\t\t\t\t\t\tmessages = messages.map((m) => {\n\t\t\t\t\t\t\tif (m.id === message.id) {\n\t\t\t\t\t\t\t\tconst reaction = m.reactions.find((reaction) => reaction.name === name);\n\n\t\t\t\t\t\t\t\tif (reaction) {\n\t\t\t\t\t\t\t\t\treaction.users = reaction.users.filter((u) => u.id !== $user?.id);\n\t\t\t\t\t\t\t\t\treaction.count = reaction.users.length;\n\n\t\t\t\t\t\t\t\t\tif (reaction.count === 0) {\n\t\t\t\t\t\t\t\t\t\tm.reactions = m.reactions.filter((r) => r.name !== name);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn m;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst res = removeReaction(\n\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\tmessage.channel_id,\n\t\t\t\t\t\t\tmessage.id,\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmessages = messages.map((m) => {\n\t\t\t\t\t\t\tif (m.id === message.id) {\n\t\t\t\t\t\t\t\tif (m.reactions) {\n\t\t\t\t\t\t\t\t\tconst reaction = m.reactions.find((reaction) => reaction.name === name);\n\n\t\t\t\t\t\t\t\t\tif (reaction) {\n\t\t\t\t\t\t\t\t\t\treaction.users.push({ id: $user?.id, name: $user?.name });\n\t\t\t\t\t\t\t\t\t\treaction.count = reaction.users.length;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tm.reactions.push({\n\t\t\t\t\t\t\t\t\t\t\tname: name,\n\t\t\t\t\t\t\t\t\t\t\tusers: [{ id: $user?.id, name: $user?.name }],\n\t\t\t\t\t\t\t\t\t\t\tcount: 1\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn m;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst res = addReaction(localStorage.token, message.channel_id, message.id, name).catch(\n\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t/>\n\t\t{/each}\n\n\t\t<div class=\"pb-6\" />\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\texport let className = 'size-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tstroke-width={strokeWidth}\n\tviewBox=\"0 0 24 24\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\td=\"M5 20V19C5 15.134 8.13401 12 12 12V12C15.866 12 19 15.134 19 19V20\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path><path\n\t\td=\"M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t></path></svg\n>\n","<script>\n\timport { WEBUI_API_BASE_URL, WEBUI_BASE_URL } from '$lib/constants';\n\timport { WEBUI_NAME, config, user as _user, showSidebar } from '$lib/stores';\n\timport { goto } from '$app/navigation';\n\timport { onMount, getContext } from 'svelte';\n\n\timport dayjs from 'dayjs';\n\timport relativeTime from 'dayjs/plugin/relativeTime';\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\n\tdayjs.extend(relativeTime);\n\tdayjs.extend(localizedFormat);\n\n\timport { toast } from 'svelte-sonner';\n\timport { getChannelMembersById } from '$lib/apis/channels';\n\n\timport Pagination from '$lib/components/common/Pagination.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\n\timport Badge from '$lib/components/common/Badge.svelte';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport ProfilePreview from '../Messages/Message/ProfilePreview.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let channel = null;\n\n\texport let onAdd = null;\n\texport let onRemove = null;\n\n\texport let search = true;\n\texport let sort = true;\n\n\tlet page = 1;\n\n\tlet users = null;\n\tlet total = null;\n\n\tlet query = '';\n\tlet orderBy = 'name'; // default sort key\n\tlet direction = 'asc'; // default sort order\n\n\tconst setSortKey = (key) => {\n\t\tif (!sort) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (orderBy === key) {\n\t\t\tdirection = direction === 'asc' ? 'desc' : 'asc';\n\t\t} else {\n\t\t\torderBy = key;\n\t\t\tdirection = 'asc';\n\t\t}\n\t};\n\n\tconst getUserList = async () => {\n\t\ttry {\n\t\t\tconst res = await getChannelMembersById(\n\t\t\t\tlocalStorage.token,\n\t\t\t\tchannel.id,\n\t\t\t\tquery,\n\t\t\t\torderBy,\n\t\t\t\tdirection,\n\t\t\t\tpage\n\t\t\t).catch((error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tif (res) {\n\t\t\t\tusers = res.users;\n\t\t\t\ttotal = res.total;\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t}\n\t};\n\n\t$: if (\n\t\tchannel !== null &&\n\t\tpage !== null &&\n\t\tquery !== null &&\n\t\torderBy !== null &&\n\t\tdirection !== null\n\t) {\n\t\tgetUserList();\n\t}\n</script>\n\n<div class=\"flex flex-col justify-center\">\n\t{#if users === null || total === null}\n\t\t<div class=\"my-10\">\n\t\t\t<Spinner className=\"size-5\" />\n\t\t</div>\n\t{:else}\n\t\t<div class=\"flex items-center justify-between px-2 mb-1\">\n\t\t\t<div class=\"flex gap-1 items-center\">\n\t\t\t\t<span class=\"text-sm\">\n\t\t\t\t\t{$i18n.t('Members')}\n\t\t\t\t</span>\n\t\t\t\t<span class=\"text-sm text-gray-500\">{total}</span>\n\t\t\t</div>\n\n\t\t\t{#if onAdd}\n\t\t\t\t<div class=\"\">\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tclass=\" px-3 py-1.5 gap-1 rounded-xl bg-gray-100/50 dark:text-white dark:bg-gray-850/50 text-black transition font-medium text-xs flex items-center justify-center\"\n\t\t\t\t\t\ton:click={onAdd}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Plus className=\"size-3.5 \" />\n\t\t\t\t\t\t<span>{$i18n.t('Add Member')}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t\t<!-- <hr class=\"my-1 border-gray-100/5- dark:border-gray-850/50\" /> -->\n\n\t\t{#if search}\n\t\t\t<div class=\"flex gap-1 px-1 mb-1\">\n\t\t\t\t<div class=\" flex w-full space-x-2\">\n\t\t\t\t\t<div class=\"flex flex-1 items-center\">\n\t\t\t\t\t\t<div class=\" self-center ml-1 mr-3\">\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\td=\"M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z\"\n\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\" w-full text-sm pr-4 py-1 rounded-r-xl outline-hidden bg-transparent\"\n\t\t\t\t\t\t\tbind:value={query}\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Search')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t{#if users.length > 0}\n\t\t\t<div class=\"scrollbar-hidden relative whitespace-nowrap w-full max-w-full\">\n\t\t\t\t<div class=\" text-sm text-left text-gray-500 dark:text-gray-400 w-full max-w-full\">\n\t\t\t\t\t<!-- <div\n\t\t\t\t\t\tclass=\"text-xs text-gray-800 uppercase bg-transparent dark:text-gray-200 w-full mb-0.5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\" border-b-[1.5px] border-gray-50/50 dark:border-gray-800/10 flex items-center justify-between\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"px-2.5 py-2 cursor-pointer select-none\"\n\t\t\t\t\t\t\t\ton:click={() => setSortKey('name')}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"flex gap-1.5 items-center\">\n\t\t\t\t\t\t\t\t\t{$i18n.t('Name')}\n\n\t\t\t\t\t\t\t\t\t{#if orderBy === 'name'}\n\t\t\t\t\t\t\t\t\t\t<span class=\"font-normal\"\n\t\t\t\t\t\t\t\t\t\t\t>{#if direction === 'asc'}\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<span class=\"invisible\">\n\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"px-2.5 py-2 cursor-pointer select-none\"\n\t\t\t\t\t\t\t\ton:click={() => setSortKey('role')}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"flex gap-1.5 items-center\">\n\t\t\t\t\t\t\t\t\t{$i18n.t('Role')}\n\n\t\t\t\t\t\t\t\t\t{#if orderBy === 'role'}\n\t\t\t\t\t\t\t\t\t\t<span class=\"font-normal\"\n\t\t\t\t\t\t\t\t\t\t\t>{#if direction === 'asc'}\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<span class=\"invisible\">\n\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div> -->\n\t\t\t\t\t<div class=\"w-full\">\n\t\t\t\t\t\t{#each users as user, userIdx (user.id)}\n\t\t\t\t\t\t\t<div class=\" dark:border-gray-850 text-xs flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<div class=\"px-2 py-1.5 font-medium text-gray-900 dark:text-white flex-1\">\n\t\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t\t<ProfilePreview {user} side=\"right\" align=\"center\" sideOffset={6}>\n\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"rounded-2xl w-6 h-6 object-cover flex-shrink-0\"\n\t\t\t\t\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${user.id}/profile/image`}\n\t\t\t\t\t\t\t\t\t\t\t\talt=\"user\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</ProfilePreview>\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={user.email} placement=\"top-start\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"font-medium truncate\">{user.name}</div>\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t\t\t\t\t\t{#if user?.is_active}\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-1.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative inline-flex size-1.5 rounded-full bg-green-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"px-2 py-1 flex items-center gap-1 translate-y-0.5\">\n\t\t\t\t\t\t\t\t\t<div class=\" \">\n\t\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t\ttype={user.role === 'admin'\n\t\t\t\t\t\t\t\t\t\t\t\t? 'info'\n\t\t\t\t\t\t\t\t\t\t\t\t: user.role === 'user'\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'success'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'muted'}\n\t\t\t\t\t\t\t\t\t\t\tcontent={$i18n.t(user.role)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{#if onRemove}\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" rounded-full p-1 hover:bg-gray-100 dark:hover:bg-gray-850 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={user.id === $_user?.id}\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonRemove(user.id);\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<XMark />\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if total > 30}\n\t\t\t\t<Pagination bind:page count={total} perPage={30} />\n\t\t\t{/if}\n\t\t{:else}\n\t\t\t<div class=\"text-gray-500 text-xs text-center py-5 px-10\">\n\t\t\t\t{$i18n.t('No users were found.')}\n\t\t\t</div>\n\t\t{/if}\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext, onMount } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { addMembersById } from '$lib/apis/channels';\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport MemberSelector from '$lib/components/workspace/common/MemberSelector.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\n\texport let show = false;\n\texport let channel = null;\n\n\texport let onUpdate = () => {};\n\n\tlet groupIds = [];\n\tlet userIds = [];\n\n\tlet loading = false;\n\n\tconst submitHandler = async () => {\n\t\tconst res = await addMembersById(localStorage.token, channel.id, {\n\t\t\tuser_ids: userIds,\n\t\t\tgroup_ids: groupIds\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\ttoast.success($i18n.t('Members added successfully'));\n\t\t\tonUpdate();\n\t\t\tshow = false;\n\t\t} else {\n\t\t\ttoast.error($i18n.t('Failed to add members'));\n\t\t}\n\t};\n\n\tconst reset = () => {\n\t\tuserIds = [];\n\t\tgroupIds = [];\n\t\tloading = false;\n\t};\n\n\t$: if (!show) {\n\t\treset();\n\t}\n</script>\n\n{#if channel}\n\t<Modal size=\"sm\" bind:show>\n\t\t<div>\n\t\t\t<div class=\" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5\">\n\t\t\t\t<div class=\"self-center text-base\">\n\t\t\t\t\t<div class=\"flex items-center gap-0.5 shrink-0\">\n\t\t\t\t\t\t{$i18n.t('Add Members')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"self-center\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<XMark className={'size-5'} />\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex flex-col md:flex-row w-full px-3 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t\t<form\n\t\t\t\t\t\tclass=\"flex flex-col w-full\"\n\t\t\t\t\t\ton:submit={(e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex flex-col w-full h-full pb-2\">\n\t\t\t\t\t\t\t<MemberSelector bind:userIds bind:groupIds includeGroups={true} />\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex justify-end pt-3 text-sm font-medium gap-1.5\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-950 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center {loading\n\t\t\t\t\t\t\t\t\t? ' cursor-not-allowed'\n\t\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{$i18n.t('Add')}\n\n\t\t\t\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t\t\t\t<div class=\"ml-2 self-center\">\n\t\t\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</Modal>\n{/if}\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext, onMount } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { removeMembersById } from '$lib/apis/channels';\n\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Modal from '$lib/components/common/Modal.svelte';\n\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport Hashtag from '../icons/Hashtag.svelte';\n\timport Lock from '../icons/Lock.svelte';\n\timport UserList from './ChannelInfoModal/UserList.svelte';\n\timport AddMembersModal from './ChannelInfoModal/AddMembersModal.svelte';\n\n\texport let show = false;\n\texport let channel = null;\n\n\texport let onUpdate = () => {};\n\n\tlet showAddMembersModal = false;\n\tconst submitHandler = async () => {};\n\n\tconst removeMemberHandler = async (userId) => {\n\t\tconst res = await removeMembersById(localStorage.token, channel.id, {\n\t\t\tuser_ids: [userId]\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\ttoast.success($i18n.t('Member removed successfully'));\n\t\t\tonUpdate();\n\t\t} else {\n\t\t\ttoast.error($i18n.t('Failed to remove member'));\n\t\t}\n\t};\n\n\tconst init = () => {};\n\n\t$: if (show) {\n\t\tinit();\n\t}\n\n\tonMount(() => {\n\t\tinit();\n\t});\n</script>\n\n{#if channel}\n\t<AddMembersModal bind:show={showAddMembersModal} {channel} {onUpdate} />\n\t<Modal size=\"sm\" bind:show>\n\t\t<div>\n\t\t\t<div class=\" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5\">\n\t\t\t\t<div class=\"self-center text-base\">\n\t\t\t\t\t<div class=\"flex items-center gap-0.5 shrink-0\">\n\t\t\t\t\t\t{#if channel?.type === 'dm'}\n\t\t\t\t\t\t\t<div class=\" text-left self-center overflow-hidden w-full line-clamp-1 flex-1\">\n\t\t\t\t\t\t\t\t{$i18n.t('Direct Message')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<div class=\" size-4 justify-center flex items-center\">\n\t\t\t\t\t\t\t\t{#if channel?.type === 'group' ? !channel?.is_private : channel?.access_control === null}\n\t\t\t\t\t\t\t\t\t<Hashtag className=\"size-3.5\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<Lock className=\"size-5.5\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\" text-left self-center overflow-hidden w-full line-clamp-1 flex-1\">\n\t\t\t\t\t\t\t\t{channel.name}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"self-center\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<XMark className={'size-5'} />\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex flex-col md:flex-row w-full px-3 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t\t<form\n\t\t\t\t\t\tclass=\"flex flex-col w-full\"\n\t\t\t\t\t\ton:submit={(e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex flex-col w-full h-full pb-2\">\n\t\t\t\t\t\t\t<UserList\n\t\t\t\t\t\t\t\t{channel}\n\t\t\t\t\t\t\t\tonAdd={channel?.type === 'group' && channel?.is_manager\n\t\t\t\t\t\t\t\t\t? () => {\n\t\t\t\t\t\t\t\t\t\t\tshowAddMembersModal = true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: null}\n\t\t\t\t\t\t\t\tonRemove={channel?.type === 'group' && channel?.is_manager\n\t\t\t\t\t\t\t\t\t? (userId) => {\n\t\t\t\t\t\t\t\t\t\t\tremoveMemberHandler(userId);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: null}\n\t\t\t\t\t\t\t\tsearch={channel?.type !== 'dm'}\n\t\t\t\t\t\t\t\tsort={channel?.type !== 'dm'}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</Modal>\n{/if}\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext, onMount } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { getChannelPinnedMessages, pinMessage } from '$lib/apis/channels';\n\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Modal from '$lib/components/common/Modal.svelte';\n\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport Message from './Messages/Message.svelte';\n\timport Loader from '../common/Loader.svelte';\n\n\texport let show = false;\n\texport let channel = null;\n\texport let onPin = (messageId, pinned) => {};\n\n\tlet page = 1;\n\tlet pinnedMessages = null;\n\n\tlet allItemsLoaded = false;\n\tlet loading = false;\n\n\tconst getPinnedMessages = async () => {\n\t\tif (!channel) return;\n\t\tif (allItemsLoaded) return;\n\n\t\tloading = true;\n\t\ttry {\n\t\t\tconst res = await getChannelPinnedMessages(localStorage.token, channel.id, page).catch(\n\t\t\t\t(error) => {\n\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (res) {\n\t\t\t\tpinnedMessages = [...(pinnedMessages ?? []), ...res];\n\t\t\t}\n\n\t\t\tif (res.length === 0) {\n\t\t\t\tallItemsLoaded = true;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching pinned messages:', error);\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t};\n\n\tconst init = () => {\n\t\tpage = 1;\n\t\tpinnedMessages = null;\n\t\tallItemsLoaded = false;\n\n\t\tgetPinnedMessages();\n\t};\n\n\t$: if (show) {\n\t\tinit();\n\t}\n\n\tonMount(() => {\n\t\tinit();\n\t});\n</script>\n\n{#if channel}\n\t<Modal size=\"sm\" bind:show>\n\t\t<div>\n\t\t\t<div class=\" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5\">\n\t\t\t\t<div class=\"self-center text-base\">\n\t\t\t\t\t<div class=\"flex items-center gap-0.5 shrink-0\">\n\t\t\t\t\t\t{$i18n.t('Pinned Messages')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"self-center\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<XMark className={'size-5'} />\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex flex-col md:flex-row w-full px-4 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t\t<div class=\"flex flex-col w-full h-full pb-2 gap-1\">\n\t\t\t\t\t\t{#if pinnedMessages === null}\n\t\t\t\t\t\t\t<div class=\"my-10\">\n\t\t\t\t\t\t\t\t<Spinner className=\"size-5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"flex flex-col gap-2 max-h-[60vh] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-700 scrollbar-track-transparent py-2\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{#if pinnedMessages.length === 0}\n\t\t\t\t\t\t\t\t\t<div class=\" text-center text-xs text-gray-500 dark:text-gray-400 py-6\">\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('No pinned messages')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t{#each pinnedMessages as message, messageIdx (message.id)}\n\t\t\t\t\t\t\t\t\t\t<Message\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-xl px-2\"\n\t\t\t\t\t\t\t\t\t\t\t{message}\n\t\t\t\t\t\t\t\t\t\t\t{channel}\n\t\t\t\t\t\t\t\t\t\t\tonPin={async (message) => {\n\t\t\t\t\t\t\t\t\t\t\t\tpinnedMessages = pinnedMessages.filter((m) => m.id !== message.id);\n\t\t\t\t\t\t\t\t\t\t\t\tonPin(message.id, !message.is_pinned);\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst updatedMessage = await pinMessage(\n\t\t\t\t\t\t\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage.channel_id,\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage.id,\n\t\t\t\t\t\t\t\t\t\t\t\t\t!message.is_pinned\n\t\t\t\t\t\t\t\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\tinit();\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tonReaction={false}\n\t\t\t\t\t\t\t\t\t\t\tonThread={false}\n\t\t\t\t\t\t\t\t\t\t\tonReply={false}\n\t\t\t\t\t\t\t\t\t\t\tonEdit={false}\n\t\t\t\t\t\t\t\t\t\t\tonDelete={false}\n\t\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t\t{#if messageIdx === pinnedMessages.length - 1 && !allItemsLoaded}\n\t\t\t\t\t\t\t\t\t\t\t<Loader\n\t\t\t\t\t\t\t\t\t\t\t\ton:visible={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('visible');\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (!loading) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpage += 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetPinnedMessages();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" \">{$i18n.t('Loading...')}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Loader>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</Modal>\n{/if}\n","<script lang=\"ts\">\n\timport { getContext } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\n\timport { mobile, showArchivedChats, showSidebar, user } from '$lib/stores';\n\n\timport { slide } from 'svelte/transition';\n\timport { page } from '$app/stores';\n\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\n\n\timport UserMenu from '$lib/components/layout/Sidebar/UserMenu.svelte';\n\timport PencilSquare from '../icons/PencilSquare.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport Sidebar from '../icons/Sidebar.svelte';\n\timport Hashtag from '../icons/Hashtag.svelte';\n\timport Lock from '../icons/Lock.svelte';\n\timport UserAlt from '../icons/UserAlt.svelte';\n\timport ChannelInfoModal from './ChannelInfoModal.svelte';\n\timport Users from '../icons/Users.svelte';\n\timport Pin from '../icons/Pin.svelte';\n\timport PinnedMessagesModal from './PinnedMessagesModal.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\tlet showChannelPinnedMessagesModal = false;\n\tlet showChannelInfoModal = false;\n\n\texport let channel;\n\n\texport let onPin = (messageId, pinned) => {};\n\texport let onUpdate = () => {};\n</script>\n\n<PinnedMessagesModal bind:show={showChannelPinnedMessagesModal} {channel} {onPin} />\n<ChannelInfoModal bind:show={showChannelInfoModal} {channel} {onUpdate} />\n<nav class=\"sticky top-0 z-30 w-full px-1.5 py-1 -mb-8 flex items-center drag-region flex flex-col\">\n\t<div\n\t\tid=\"navbar-bg-gradient-to-b\"\n\t\tclass=\" bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]\"\n\t></div>\n\n\t<div class=\" flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent\">\n\t\t<div class=\"flex items-center w-full max-w-full\">\n\t\t\t{#if $mobile}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"{$showSidebar\n\t\t\t\t\t\t? 'md:hidden'\n\t\t\t\t\t\t: ''} mr-1.5 mt-0.5 self-start flex flex-none items-center text-gray-600 dark:text-gray-400\"\n\t\t\t\t>\n\t\t\t\t\t<Tooltip\n\t\t\t\t\t\tcontent={$showSidebar ? $i18n.t('Close Sidebar') : $i18n.t('Open Sidebar')}\n\t\t\t\t\t\tinteractive={true}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tid=\"sidebar-toggle-button\"\n\t\t\t\t\t\t\tclass=\" cursor-pointer flex rounded-lg hover:bg-gray-100 dark:hover:bg-gray-850 transition cursor-\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" self-center p-1.5\">\n\t\t\t\t\t\t\t\t<Sidebar />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div\n\t\t\t\tclass=\"flex-1 overflow-hidden max-w-full py-0.5 flex items-center\n\t\t\t{$showSidebar ? 'ml-1' : ''}\n\t\t\t\"\n\t\t\t>\n\t\t\t\t{#if channel}\n\t\t\t\t\t<div class=\"flex items-center gap-0.5 shrink-0\">\n\t\t\t\t\t\t{#if channel?.type === 'dm'}\n\t\t\t\t\t\t\t{#if channel?.users}\n\t\t\t\t\t\t\t\t{@const channelMembers = channel.users.filter((u) => u.id !== $user?.id)}\n\t\t\t\t\t\t\t\t<div class=\"flex mr-1.5 relative\">\n\t\t\t\t\t\t\t\t\t{#each channelMembers.slice(0, 2) as u, index}\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${u.id}/profile/image`}\n\t\t\t\t\t\t\t\t\t\t\talt={u.name}\n\t\t\t\t\t\t\t\t\t\t\tclass=\" size-6.5 rounded-full border-2 border-white dark:border-gray-900 {index ===\n\t\t\t\t\t\t\t\t\t\t\t1\n\t\t\t\t\t\t\t\t\t\t\t\t? '-ml-3'\n\t\t\t\t\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{/each}\n\n\t\t\t\t\t\t\t\t\t{#if channelMembers.length === 1}\n\t\t\t\t\t\t\t\t\t\t<div class=\"absolute bottom-0 right-0\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t{#if channelMembers[0]?.is_active}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"relative inline-flex size-2 rounded-full {channelMembers[0]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t?.is_active\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-green-500'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-gray-300 dark:bg-gray-700'} border-[1.5px] border-white dark:border-gray-900\"\n\t\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<Users className=\"size-4 ml-1 mr-0.5\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<div class=\" size-4.5 justify-center flex items-center\">\n\t\t\t\t\t\t\t\t{#if channel?.type === 'group' ? !channel?.is_private : channel?.access_control === null}\n\t\t\t\t\t\t\t\t\t<Hashtag className=\"size-3.5\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<Lock className=\"size-5\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<div class=\" text-left self-center overflow-hidden w-full line-clamp-1 flex-1\">\n\t\t\t\t\t\t\t{#if channel?.name}\n\t\t\t\t\t\t\t\t{channel.name}\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t{channel?.users\n\t\t\t\t\t\t\t\t\t?.filter((u) => u.id !== $user?.id)\n\t\t\t\t\t\t\t\t\t.map((u) => u.name)\n\t\t\t\t\t\t\t\t\t.join(', ')}\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<div class=\"self-start flex flex-none items-center text-gray-600 dark:text-gray-400 gap-1\">\n\t\t\t\t{#if channel}\n\t\t\t\t\t<Tooltip content={$i18n.t('Pinned Messages')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" flex cursor-pointer py-1.5 px-1.5 border dark:border-gray-850 border-gray-50 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\taria-label=\"Pinned Messages\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tshowChannelPinnedMessagesModal = true;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" flex items-center gap-0.5 m-auto self-center\">\n\t\t\t\t\t\t\t\t<Pin className=\" size-4\" strokeWidth=\"1.5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t{#if channel?.user_count !== undefined}\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Users')}>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\" flex cursor-pointer py-1 px-1.5 border dark:border-gray-850 border-gray-50 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\t\taria-label=\"User Count\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowChannelInfoModal = true;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" flex items-center gap-0.5 m-auto self-center\">\n\t\t\t\t\t\t\t\t\t<UserAlt className=\" size-4\" strokeWidth=\"1.5\" />\n\n\t\t\t\t\t\t\t\t\t<div class=\"text-sm\">\n\t\t\t\t\t\t\t\t\t\t{channel.user_count}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t{/if}\n\t\t\t\t{/if}\n\n\t\t\t\t{#if $user !== undefined}\n\t\t\t\t\t<UserMenu\n\t\t\t\t\t\tclassName=\"max-w-[240px]\"\n\t\t\t\t\t\trole={$user?.role}\n\t\t\t\t\t\thelp={true}\n\t\t\t\t\t\ton:show={(e) => {\n\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\n\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\taria-label=\"User Menu\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" self-center\">\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${$user?.id}/profile/image`}\n\t\t\t\t\t\t\t\t\tclass=\"size-6 object-cover rounded-full\"\n\t\t\t\t\t\t\t\t\talt=\"User profile\"\n\t\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</UserMenu>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</nav>\n","<script lang=\"ts\">\n\timport { goto } from '$app/navigation';\n\n\timport { socket, user } from '$lib/stores';\n\n\timport { getChannelThreadMessages, sendMessage } from '$lib/apis/channels';\n\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport MessageInput from './MessageInput.svelte';\n\timport Messages from './Messages.svelte';\n\timport { onDestroy, onMount, tick, getContext } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\timport Spinner from '../common/Spinner.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let threadId = null;\n\texport let channel = null;\n\n\texport let onClose = () => {};\n\n\tlet messages = null;\n\tlet top = false;\n\n\tlet messagesContainerElement = null;\n\tlet chatInputElement = null;\n\n\tlet replyToMessage = null;\n\n\tlet typingUsers = [];\n\tlet typingUsersTimeout = {};\n\n\t$: if (threadId) {\n\t\tinitHandler();\n\t}\n\n\tconst scrollToBottom = () => {\n\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\n\t};\n\n\tconst initHandler = async () => {\n\t\tmessages = null;\n\t\ttop = false;\n\n\t\ttypingUsers = [];\n\t\ttypingUsersTimeout = {};\n\n\t\tif (channel) {\n\t\t\tmessages = await getChannelThreadMessages(localStorage.token, channel.id, threadId);\n\n\t\t\tif (messages.length < 50) {\n\t\t\t\ttop = true;\n\t\t\t}\n\n\t\t\tawait tick();\n\t\t\tscrollToBottom();\n\t\t} else {\n\t\t\tgoto('/');\n\t\t}\n\t};\n\n\tconst channelEventHandler = async (event) => {\n\t\tconsole.debug(event);\n\t\tif (event.channel_id === channel.id) {\n\t\t\tconst type = event?.data?.type ?? null;\n\t\t\tconst data = event?.data?.data ?? null;\n\n\t\t\tif (type === 'message') {\n\t\t\t\tif ((data?.parent_id ?? null) === threadId) {\n\t\t\t\t\tif (messages) {\n\t\t\t\t\t\tmessages = [data, ...messages];\n\n\t\t\t\t\t\tif (typingUsers.find((user) => user.id === event.user.id)) {\n\t\t\t\t\t\t\ttypingUsers = typingUsers.filter((user) => user.id !== event.user.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (type === 'message:update') {\n\t\t\t\tif (messages) {\n\t\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\n\n\t\t\t\t\tif (idx !== -1) {\n\t\t\t\t\t\tmessages[idx] = data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (type === 'message:delete') {\n\t\t\t\tif (messages) {\n\t\t\t\t\tmessages = messages.filter((message) => message.id !== data.id);\n\t\t\t\t}\n\t\t\t} else if (type.includes('message:reaction')) {\n\t\t\t\tif (messages) {\n\t\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\n\t\t\t\t\tif (idx !== -1) {\n\t\t\t\t\t\tmessages[idx] = data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (type === 'typing' && event.message_id === threadId) {\n\t\t\t\tif (event.user.id === $user?.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttypingUsers = data.typing\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t...typingUsers,\n\t\t\t\t\t\t\t...(typingUsers.find((user) => user.id === event.user.id)\n\t\t\t\t\t\t\t\t? []\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tid: event.user.id,\n\t\t\t\t\t\t\t\t\t\t\tname: event.user.name\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t]\n\t\t\t\t\t: typingUsers.filter((user) => user.id !== event.user.id);\n\n\t\t\t\tif (typingUsersTimeout[event.user.id]) {\n\t\t\t\t\tclearTimeout(typingUsersTimeout[event.user.id]);\n\t\t\t\t}\n\n\t\t\t\ttypingUsersTimeout[event.user.id] = setTimeout(() => {\n\t\t\t\t\ttypingUsers = typingUsers.filter((user) => user.id !== event.user.id);\n\t\t\t\t}, 5000);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst submitHandler = async ({ content, data }) => {\n\t\tif (!content && (data?.files ?? []).length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst res = await sendMessage(localStorage.token, channel.id, {\n\t\t\tparent_id: threadId,\n\t\t\treply_to_id: replyToMessage?.id ?? null,\n\t\t\tcontent: content,\n\t\t\tdata: data\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\treplyToMessage = null;\n\t};\n\n\tconst onChange = async () => {\n\t\t$socket?.emit('events:channel', {\n\t\t\tchannel_id: channel.id,\n\t\t\tmessage_id: threadId,\n\t\t\tdata: {\n\t\t\t\ttype: 'typing',\n\t\t\t\tdata: {\n\t\t\t\t\ttyping: true\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\tonMount(() => {\n\t\t$socket?.on('events:channel', channelEventHandler);\n\t});\n\n\tonDestroy(() => {\n\t\t$socket?.off('events:channel', channelEventHandler);\n\t});\n</script>\n\n{#if channel}\n\t<div class=\"flex flex-col w-full h-full bg-gray-50 dark:bg-gray-850\">\n\t\t<div class=\"sticky top-0 flex items-center justify-between px-3.5 py-3\">\n\t\t\t<div class=\" font-medium text-lg\">{$i18n.t('Thread')}</div>\n\n\t\t\t<div>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 p-2\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tonClose();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<XMark />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\" max-h-full w-full overflow-y-auto\" bind:this={messagesContainerElement}>\n\t\t\t{#if messages !== null}\n\t\t\t\t<Messages\n\t\t\t\t\tid={threadId}\n\t\t\t\t\t{channel}\n\t\t\t\t\t{top}\n\t\t\t\t\t{messages}\n\t\t\t\t\t{replyToMessage}\n\t\t\t\t\tthread={true}\n\t\t\t\t\tonReply={async (message) => {\n\t\t\t\t\t\treplyToMessage = message;\n\n\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\tchatInputElement?.focus();\n\t\t\t\t\t}}\n\t\t\t\t\tonLoad={async () => {\n\t\t\t\t\t\tconst newMessages = await getChannelThreadMessages(\n\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\tchannel.id,\n\t\t\t\t\t\t\tthreadId,\n\t\t\t\t\t\t\tmessages.length\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tmessages = [...messages, ...newMessages];\n\n\t\t\t\t\t\tif (newMessages.length < 50) {\n\t\t\t\t\t\t\ttop = true;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t{:else}\n\t\t\t\t<div class=\"w-full flex justify-center pt-5 pb-10\">\n\t\t\t\t\t<Spinner />\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div class=\" pb-[1rem] px-2.5 w-full\">\n\t\t\t\t<MessageInput\n\t\t\t\t\tbind:replyToMessage\n\t\t\t\t\tbind:chatInputElement\n\t\t\t\t\tid={threadId}\n\t\t\t\t\t{channel}\n\t\t\t\t\tdisabled={!channel?.write_access}\n\t\t\t\t\tplaceholder={!channel?.write_access\n\t\t\t\t\t\t? $i18n.t('You do not have permission to send messages in this thread.')\n\t\t\t\t\t\t: $i18n.t('Reply to thread...')}\n\t\t\t\t\ttypingUsersClassName=\"from-gray-50 dark:from-gray-850\"\n\t\t\t\t\t{typingUsers}\n\t\t\t\t\tuserSuggestions={true}\n\t\t\t\t\tchannelSuggestions={true}\n\t\t\t\t\t{onChange}\n\t\t\t\t\tonSubmit={submitHandler}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { Pane, PaneGroup, PaneResizer } from 'paneforge';\n\n\timport { onDestroy, onMount, tick } from 'svelte';\n\timport { goto } from '$app/navigation';\n\timport { v4 as uuidv4 } from 'uuid';\n\n\timport {\n\t\tchatId,\n\t\tchannels,\n\t\tchannelId as _channelId,\n\t\tshowSidebar,\n\t\tsocket,\n\t\tuser\n\t} from '$lib/stores';\n\timport { getChannelById, getChannelMessages, sendMessage } from '$lib/apis/channels';\n\n\timport Messages from './Messages.svelte';\n\timport MessageInput from './MessageInput.svelte';\n\timport Navbar from './Navbar.svelte';\n\timport Drawer from '../common/Drawer.svelte';\n\timport EllipsisVertical from '../icons/EllipsisVertical.svelte';\n\timport Thread from './Thread.svelte';\n\timport i18n from '$lib/i18n';\n\timport Spinner from '../common/Spinner.svelte';\n\n\texport let id = '';\n\n\tlet currentId = null;\n\n\tlet scrollEnd = true;\n\tlet messagesContainerElement = null;\n\tlet chatInputElement = null;\n\n\tlet top = false;\n\n\tlet channel = null;\n\tlet messages = null;\n\n\tlet replyToMessage = null;\n\tlet threadId = null;\n\n\tlet typingUsers = [];\n\tlet typingUsersTimeout = {};\n\n\t$: if (id) {\n\t\tinitHandler();\n\t}\n\n\tconst scrollToBottom = () => {\n\t\tif (messagesContainerElement) {\n\t\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\n\t\t}\n\t};\n\n\tconst updateLastReadAt = async (channelId) => {\n\t\t$socket?.emit('events:channel', {\n\t\t\tchannel_id: channelId,\n\t\t\tmessage_id: null,\n\t\t\tdata: {\n\t\t\t\ttype: 'last_read_at'\n\t\t\t}\n\t\t});\n\n\t\tchannels.set(\n\t\t\t$channels.map((channel) => {\n\t\t\t\tif (channel.id === channelId) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...channel,\n\t\t\t\t\t\tunread_count: 0\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn channel;\n\t\t\t})\n\t\t);\n\t};\n\n\tconst initHandler = async () => {\n\t\tif (currentId) {\n\t\t\tupdateLastReadAt(currentId);\n\t\t}\n\n\t\tcurrentId = id;\n\t\tupdateLastReadAt(id);\n\t\t_channelId.set(id);\n\n\t\ttop = false;\n\t\tmessages = null;\n\t\tchannel = null;\n\t\tthreadId = null;\n\n\t\ttypingUsers = [];\n\t\ttypingUsersTimeout = {};\n\n\t\tchannel = await getChannelById(localStorage.token, id).catch((error) => {\n\t\t\treturn null;\n\t\t});\n\n\t\tif (channel) {\n\t\t\tmessages = await getChannelMessages(localStorage.token, id, 0);\n\n\t\t\tif (messages) {\n\t\t\t\tscrollToBottom();\n\n\t\t\t\tif (messages.length < 50) {\n\t\t\t\t\ttop = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tgoto('/');\n\t\t}\n\t};\n\n\tconst channelEventHandler = async (event) => {\n\t\tif (event.channel_id === id) {\n\t\t\tconst type = event?.data?.type ?? null;\n\t\t\tconst data = event?.data?.data ?? null;\n\n\t\t\tif (type === 'message') {\n\t\t\t\tif ((data?.parent_id ?? null) === null) {\n\t\t\t\t\tconst tempId = data?.temp_id ?? null;\n\t\t\t\t\tmessages = [\n\t\t\t\t\t\t{ ...data, temp_id: null },\n\t\t\t\t\t\t...messages.filter((m) => !tempId || m?.temp_id !== tempId)\n\t\t\t\t\t];\n\n\t\t\t\t\tif (typingUsers.find((user) => user.id === event.user.id)) {\n\t\t\t\t\t\ttypingUsers = typingUsers.filter((user) => user.id !== event.user.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tawait tick();\n\t\t\t\t\tif (scrollEnd) {\n\t\t\t\t\t\tscrollToBottom();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (type === 'message:update') {\n\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\n\n\t\t\t\tif (idx !== -1) {\n\t\t\t\t\tmessages[idx] = data;\n\t\t\t\t}\n\t\t\t} else if (type === 'message:delete') {\n\t\t\t\tmessages = messages.filter((message) => message.id !== data.id);\n\t\t\t} else if (type === 'message:reply') {\n\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\n\n\t\t\t\tif (idx !== -1) {\n\t\t\t\t\tmessages[idx] = data;\n\t\t\t\t}\n\t\t\t} else if (type.includes('message:reaction')) {\n\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\n\t\t\t\tif (idx !== -1) {\n\t\t\t\t\tmessages[idx] = data;\n\t\t\t\t}\n\t\t\t} else if (type === 'typing' && event.message_id === null) {\n\t\t\t\tif (event.user.id === $user?.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttypingUsers = data.typing\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t...typingUsers,\n\t\t\t\t\t\t\t...(typingUsers.find((user) => user.id === event.user.id)\n\t\t\t\t\t\t\t\t? []\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tid: event.user.id,\n\t\t\t\t\t\t\t\t\t\t\tname: event.user.name\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t]\n\t\t\t\t\t: typingUsers.filter((user) => user.id !== event.user.id);\n\n\t\t\t\tif (typingUsersTimeout[event.user.id]) {\n\t\t\t\t\tclearTimeout(typingUsersTimeout[event.user.id]);\n\t\t\t\t}\n\n\t\t\t\ttypingUsersTimeout[event.user.id] = setTimeout(() => {\n\t\t\t\t\ttypingUsers = typingUsers.filter((user) => user.id !== event.user.id);\n\t\t\t\t}, 5000);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst submitHandler = async ({ content, data }) => {\n\t\tif (!content && (data?.files ?? []).length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst tempId = uuidv4();\n\n\t\tconst message = {\n\t\t\ttemp_id: tempId,\n\t\t\tcontent: content,\n\t\t\tdata: data,\n\t\t\treply_to_id: replyToMessage?.id ?? null\n\t\t};\n\n\t\tconst ts = Date.now() * 1000000; // nanoseconds\n\t\tmessages = [\n\t\t\t{\n\t\t\t\t...message,\n\t\t\t\tid: tempId,\n\t\t\t\tuser_id: $user?.id,\n\t\t\t\tuser: $user,\n\t\t\t\treply_to_message: replyToMessage ?? null,\n\t\t\t\tcreated_at: ts,\n\t\t\t\tupdated_at: ts\n\t\t\t},\n\t\t\t...messages\n\t\t];\n\n\t\tconst res = await sendMessage(localStorage.token, id, message).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\n\t\t}\n\n\t\treplyToMessage = null;\n\t};\n\n\tconst onChange = async () => {\n\t\t$socket?.emit('events:channel', {\n\t\t\tchannel_id: id,\n\t\t\tmessage_id: null,\n\t\t\tdata: {\n\t\t\t\ttype: 'typing',\n\t\t\t\tdata: {\n\t\t\t\t\ttyping: true\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tupdateLastReadAt(id);\n\t};\n\n\tlet mediaQuery;\n\tlet largeScreen = false;\n\n\tonMount(() => {\n\t\tif ($chatId) {\n\t\t\tchatId.set('');\n\t\t}\n\n\t\t$socket?.on('events:channel', channelEventHandler);\n\n\t\tmediaQuery = window.matchMedia('(min-width: 1024px)');\n\n\t\tconst handleMediaQuery = async (e) => {\n\t\t\tif (e.matches) {\n\t\t\t\tlargeScreen = true;\n\t\t\t} else {\n\t\t\t\tlargeScreen = false;\n\t\t\t}\n\t\t};\n\n\t\tmediaQuery.addEventListener('change', handleMediaQuery);\n\t\thandleMediaQuery(mediaQuery);\n\t});\n\n\tonDestroy(() => {\n\t\t// last read at\n\t\tupdateLastReadAt(id);\n\t\t_channelId.set(null);\n\t\t$socket?.off('events:channel', channelEventHandler);\n\t});\n</script>\n\n<svelte:head>\n\t{#if channel?.type === 'dm'}\n\t\t<title\n\t\t\t>{channel?.name.trim() ||\n\t\t\t\tchannel?.users.reduce((a, e, i, arr) => {\n\t\t\t\t\tif (e.id === $user?.id) {\n\t\t\t\t\t\treturn a;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (a) {\n\t\t\t\t\t\treturn `${a}, ${e.name}`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn e.name;\n\t\t\t\t\t}\n\t\t\t\t}, '')} â€¢ Open WebUI</title\n\t\t>\n\t{:else}\n\t\t<title>#{channel?.name ?? 'Channel'} â€¢ Open WebUI</title>\n\t{/if}\n</svelte:head>\n\n<div\n\tclass=\"h-screen max-h-[100dvh] transition-width duration-200 ease-in-out {$showSidebar\n\t\t? 'md:max-w-[calc(100%-var(--sidebar-width))]'\n\t\t: ''} w-full max-w-full flex flex-col\"\n\tid=\"channel-container\"\n>\n\t<PaneGroup direction=\"horizontal\" class=\"w-full h-full\">\n\t\t<Pane defaultSize={50} minSize={50} class=\"h-full flex flex-col w-full relative\">\n\t\t\t<Navbar\n\t\t\t\t{channel}\n\t\t\t\tonPin={(messageId, pinned) => {\n\t\t\t\t\tmessages = messages.map((message) => {\n\t\t\t\t\t\tif (message.id === messageId) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...message,\n\t\t\t\t\t\t\t\tis_pinned: pinned\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn message;\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t\tonUpdate={async () => {\n\t\t\t\t\tchannel = await getChannelById(localStorage.token, id).catch((error) => {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t{#if channel && messages !== null}\n\t\t\t\t<div class=\"flex-1 overflow-y-auto\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\" pb-2.5 max-w-full z-10 scrollbar-hidden w-full h-full pt-6 flex-1 flex flex-col-reverse overflow-auto\"\n\t\t\t\t\t\tid=\"messages-container\"\n\t\t\t\t\t\tbind:this={messagesContainerElement}\n\t\t\t\t\t\ton:scroll={(e) => {\n\t\t\t\t\t\t\tscrollEnd = Math.abs(messagesContainerElement.scrollTop) <= 50;\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#key id}\n\t\t\t\t\t\t\t<Messages\n\t\t\t\t\t\t\t\t{channel}\n\t\t\t\t\t\t\t\t{top}\n\t\t\t\t\t\t\t\t{messages}\n\t\t\t\t\t\t\t\t{replyToMessage}\n\t\t\t\t\t\t\t\tonReply={async (message) => {\n\t\t\t\t\t\t\t\t\treplyToMessage = message;\n\t\t\t\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\t\t\t\tchatInputElement?.focus();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tonThread={(id) => {\n\t\t\t\t\t\t\t\t\tthreadId = id;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tonLoad={async () => {\n\t\t\t\t\t\t\t\t\tconst newMessages = await getChannelMessages(\n\t\t\t\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\tmessages.length\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\tmessages = [...messages, ...newMessages];\n\n\t\t\t\t\t\t\t\t\tif (newMessages.length < 50) {\n\t\t\t\t\t\t\t\t\t\ttop = true;\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/key}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\" pb-[1rem] px-2.5\">\n\t\t\t\t\t<MessageInput\n\t\t\t\t\t\tid=\"root\"\n\t\t\t\t\t\tbind:chatInputElement\n\t\t\t\t\t\tbind:replyToMessage\n\t\t\t\t\t\t{typingUsers}\n\t\t\t\t\t\t{channel}\n\t\t\t\t\t\tuserSuggestions={true}\n\t\t\t\t\t\tchannelSuggestions={true}\n\t\t\t\t\t\tdisabled={!channel?.write_access}\n\t\t\t\t\t\tplaceholder={!channel?.write_access\n\t\t\t\t\t\t\t? $i18n.t('You do not have permission to send messages in this channel.')\n\t\t\t\t\t\t\t: $i18n.t('Type here...')}\n\t\t\t\t\t\t{onChange}\n\t\t\t\t\t\tonSubmit={submitHandler}\n\t\t\t\t\t\t{scrollToBottom}\n\t\t\t\t\t\t{scrollEnd}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\" flex items-center justify-center h-full w-full\">\n\t\t\t\t\t<div class=\"m-auto\">\n\t\t\t\t\t\t<Spinner className=\"size-5\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</Pane>\n\n\t\t{#if !largeScreen}\n\t\t\t{#if threadId !== null}\n\t\t\t\t<Drawer\n\t\t\t\t\tshow={threadId !== null}\n\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\tthreadId = null;\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\" {threadId !== null ? ' h-screen  w-full' : 'px-6 py-4'} h-full\">\n\t\t\t\t\t\t<Thread\n\t\t\t\t\t\t\t{threadId}\n\t\t\t\t\t\t\t{channel}\n\t\t\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\t\t\tthreadId = null;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</Drawer>\n\t\t\t{/if}\n\t\t{:else if threadId !== null}\n\t\t\t<PaneResizer\n\t\t\t\tclass=\"relative flex items-center justify-center group border-l border-gray-50 dark:border-gray-850/30 hover:border-gray-200 dark:hover:border-gray-800  transition z-20\"\n\t\t\t\tid=\"controls-resizer\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclass=\" absolute -left-1.5 -right-1.5 -top-0 -bottom-0 z-20 cursor-col-resize bg-transparent\"\n\t\t\t\t/>\n\t\t\t</PaneResizer>\n\n\t\t\t<Pane defaultSize={50} minSize={30} class=\"h-full w-full\">\n\t\t\t\t<div class=\"h-full w-full shadow-xl\">\n\t\t\t\t\t<Thread\n\t\t\t\t\t\t{threadId}\n\t\t\t\t\t\t{channel}\n\t\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\t\tthreadId = null;\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</Pane>\n\t\t{/if}\n\t</PaneGroup>\n</div>\n","<script lang=\"ts\">\n\timport { page } from '$app/stores';\n\n\timport Channel from '$lib/components/channel/Channel.svelte';\n</script>\n\n<Channel id={$page.params.id} />\n"],"names":["className","strokeWidth","dayjs","relativeTime","isToday","isYesterday","localizedFormat","i18n","getContext","message","$.prop","$$props","channel","showUserProfile","thread","replyToMessage","disabled","pending","onDelete","onEdit","onReply","onPin","onThread","onReaction","showButtons","edit","editedContent","showDeleteConfirmDialog","loadMessageData","_a","res","getMessageData","_b","onMount","$i18n","$$value","$.set","name","$.event","button","$$render","consequent","button_1","consequent_1","$.untrack","button_2","button_3","consequent_3","button_4","consequent_4","button_5","consequent_5","$user","$.get","consequent_7","WEBUI_API_BASE_URL","_c","_d","button_6","messageElement","consequent_12","alternate_3","formatDate","consequent_17","file","fileUrl","$.derived_safe_equal","$settings","e","isCmdOrCtrlPressed","isEnterPressed","button_7","button_8","reaction","acc","u","idx","total","separator","button_9","consequent_26","button_10","consequent_22","alternate_10","_e","_f","_g","$.set_attribute","div_8","consequent_29","id","messages","top","onLoad","messagesLoading","loadMoreMessages","element","tick","messageList","index","$.set_class","img","alternate_1","alternate_2","$.each","node_8","messageIdx","m","deleteMessage","error","toast","content","updateMessage","pinMessage","r","removeReaction","addReaction","consequent_6","onAdd","onRemove","search","page","users","query","orderBy","direction","getUserList","getChannelMembersById","err","$$args","$.bind_value","input","consequent_2","div_10","user","$_user","alternate","show","onUpdate","groupIds","$.mutable_source","userIds","loading","submitHandler","addMembersById","reset","form","showAddMembersModal","removeMemberHandler","userId","removeMembersById","messageId","pinned","pinnedMessages","allItemsLoaded","getPinnedMessages","getChannelPinnedMessages","init","node_5","showChannelPinnedMessagesModal","showChannelInfoModal","$showSidebar","showSidebar","$mobile","channelMembers","consequent_9","$0","showArchivedChats","consequent_10","threadId","onClose","messagesContainerElement","chatInputElement","typingUsers","typingUsersTimeout","scrollToBottom","$.mutate","initHandler","getChannelThreadMessages","goto","channelEventHandler","event","type","data","sendMessage","onChange","$socket","onDestroy","newMessages","$.bind_this","div_4","currentId","scrollEnd","updateLastReadAt","channelId","channels","$channels","_channelId","getChannelById","getChannelMessages","tempId","uuidv4","ts","mediaQuery","largeScreen","$chatId","chatId","handleMediaQuery","a","i","arr","$$anchor","div_2","$.template_effect","div_6","$page"],"mappings":"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"}